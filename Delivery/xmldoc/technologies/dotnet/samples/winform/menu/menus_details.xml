<document title="Menu Details">
	<meta_data>
		<help>
			<toc>
				<envision_location>Samples\.NET Framework Samples\Windows Forms\Menus</envision_location>
				<envision_title>Using Menus</envision_title>
				<envision_location>Samples\Windows Forms\Menus</envision_location>
			</toc>
		</help>
	</meta_data>
	<paragraph>
		<paragraph>Windows Forms supports menus and context menus. Main menus are displayed on a menu bar that is located immediately below the title bar of a form. The menu bar contains top-level menu items that are used to group related submenu items. For example, by clicking a 
			<bold>File</bold> top-level menu item, you can display menu items that are related to file operations. Menu items typically appear as commands for your application (such as 
			<bold>New</bold> and 
			<bold>Open</bold>),but they can also appear as separator bars and submenu items. You  can display a check mark next to a menu item to display the state of a command or a the state of a feature in your application. In Windows Forms, main menus are represented by the 
			<bold>MainMenu</bold> control.
		</paragraph>
		<paragraph>Context menus can be displayed for a specific control or area of your form. They are typically accessed by clicking the right mouse button. In Windows Forms, context menus are represented by the 
			<bold>ContextMenu</bold> control.
		</paragraph>
		<paragraph>
			<bold>ContextMenu</bold> and 
			<bold>MainMenu</bold> derive from 
			<bold>Menu</bold>. They share many properties, methods, and events.
		</paragraph>
		<heading>
			<size>2</size>
			Adding a MainMenu to a Form
		</heading>
		<paragraph>The following code demonstrates how to add a 
			<bold>MainMenu</bold> to a form.
		</paragraph>
		<code_block>
	<feature_name>main_menu</feature_name><symbol>:</symbol> <class_name>WINFORMS_MAIN_MENU</class_name>
</code_block>
		<code_block>
	<keyword>create</keyword> <feature_name>main_menu</feature_name>.<feature_name></feature_name><feature_name>make</feature_name>
	<feature_name>set_menu</feature_name> <symbol>(</symbol><feature_name>main_menu</feature_name><symbol>)</symbol>
</code_block>
		<heading>
			<size>2</size>Adding a Context Menu to a Control
		</heading>
		<paragraph>The following code demonstrates how to 
			<span>create</span> a 
			<bold>ContextMenu</bold> and assign it to a control.
		</paragraph>
		<code_block>
	<local_variable>label_1</local_variable>: <class_name>WINFORMS_LABEL</class_name>
	<local_variable>label_1_context_menu</local_variable>: <class_name>WINFORMS_CONTEXT_MENU</class_name>
</code_block>
		<code_block>
	<keyword>create</keyword> <feature_name>label_1</feature_name>.<feature_name>make</feature_name>
	<keyword>create</keyword> <feature_name>label_1_context_menu</feature_name>.<feature_name>make</feature_name>
	<feature_name>label_1</feature_name>.<feature_name></feature_name><feature_name>set_context_menu</feature_name> <symbol>(</symbol><feature_name>label_1_context_menu</feature_name><symbol>)</symbol>
</code_block>
		<heading>
			<size>2</size>Adding Menu Items
		</heading>
		<paragraph>In the following example, a 
			<bold>File</bold> menu item is added to the 
			<bold>MainMenu</bold>. The 
			<bold>File</bold> menu item contains submenu items called 
			<bold>Open</bold> and 
			<bold>Exit</bold>.
		</paragraph>
		<code_block>
	<feature_name>mi_file</feature_name><symbol>:</symbol> <class_name>WINFORMS_MAIN_MENU</class_name>
</code_block>
		<code_block>
	<feature_name>mi_file</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>main_menu</feature_name>.<feature_name></feature_name> <feature_name>get_menu_items</feature_name>.<feature_name>add</feature_name> <symbol>(</symbol><symbol>(</symbol>"<string>&amp;File</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name> <symbol>)</symbol>
	<feature_name>dummy</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>mi_file</feature_name>.<feature_name></feature_name> <feature_name>get_menu_items</feature_name>.<feature_name>add_menu_item</feature_name> <symbol>(</symbol><keyword>create</keyword> <symbol>{</symbol><class_name>WINFORMS_MENU_ITEM</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make_from_text</feature_name> <symbol>(</symbol><symbol>(</symbol>"<string>&amp;Open...</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name> <symbol>)</symbol><symbol>)</symbol>
	<feature_name>dummy</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>mi_file</feature_name>.<feature_name></feature_name> <feature_name>get_menu_items</feature_name>.<feature_name>add</feature_name> <symbol>(</symbol><symbol>(</symbol>"<string>-</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name> <symbol>)</symbol> <comment>-- Gives us a separator</comment>
	<feature_name>dummy</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>mi_file</feature_name>.<feature_name></feature_name> <feature_name>get_menu_items</feature_name>.<feature_name>add_menu_item</feature_name> <symbol>(</symbol><keyword>create</keyword>  <symbol>{</symbol><class_name>WINFORMS_MENU_ITEM</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make_from_text</feature_name><symbol>(</symbol><symbol>(</symbol>"<string>E&amp;xit</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name> <symbol>)</symbol>
</code_block>
		<paragraph>
			<line_break/>
		</paragraph>
		<paragraph>The following code demonstrates how to handle the 
			<bold>Click</bold> event for both the 
			<bold>Open</bold> and 
			<bold>Exit</bold> menu items 
			<span>create</span>d in the previous code example.
		</paragraph>
		<code_block>
	<feature_name>mi_file</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>main_menu</feature_name>.<feature_name>get_menu_items</feature_name>.<feature_name>add</feature_name> <symbol>(</symbol><symbol>(</symbol>"<string>&amp;File</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name><symbol>)</symbol>
	<feature_name>dummy</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>mi_file</feature_name>.<feature_name>get_menu_items</feature_name>.<feature_name>add_menu_item</feature_name> <symbol>(</symbol><keyword>create</keyword> <symbol>{</symbol><class_name>WINFORMS_MENU_ITEM</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make_from_text_and_on_click_and_shortcut</feature_name>
		<symbol>(</symbol><symbol>(</symbol>"<string>&amp;Open...</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name>, <keyword>create</keyword> <symbol>{</symbol><class_name>EVENT_HANDLER</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make</feature_name> <symbol>(</symbol><keyword>Current</keyword>, <symbol>$</symbol><feature_name>FileOpen_Clicked</feature_name><symbol>)</symbol>, <keyword>feature</keyword> <symbol>{</symbol><class_name>WINFORMS_SHORTCUT</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>ctrl_O</feature_name><symbol>)</symbol><symbol>)</symbol>
	<feature_name>dummy</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>mi_file</feature_name>.<feature_name>get_menu_items</feature_name>.<feature_name>add</feature_name> <symbol>(</symbol><symbol>(</symbol>"<string>-</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name><symbol>)</symbol> <comment>-- Gives us a separator</comment>
	<feature_name>dummy</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>mi_file</feature_name>.<feature_name>get_menu_items</feature_name>.<feature_name>add_menu_item</feature_name> <symbol>(</symbol><keyword>create</keyword> <symbol>{</symbol><class_name>WINFORMS_MENU_ITEM</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make_from_text_and_on_click_and_shortcut</feature_name>
		<symbol>(</symbol><symbol>(</symbol>"<string>E&amp;xit</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name>, <keyword>create</keyword> <symbol>{</symbol><class_name>EVENT_HANDLER</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make</feature_name> <symbol>(</symbol><keyword>Current</keyword>, <symbol>$</symbol><feature_name>FileExit_Clicked</feature_name><symbol>)</symbol>, <keyword>feature</keyword> <symbol>{</symbol><class_name>WINFORMS_SHORTCUT</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>ctrl_X</feature_name><symbol>)</symbol><symbol>)</symbol>
</code_block>
		<paragraph>
			<line_break/>
		</paragraph>
		<paragraph>The following example demonstrates how to define shortcut keys for the menu items 
			<span>create</span>d in the previous example.
		</paragraph>
		<code_block>
	<feature_name>mi_file</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>main_menu</feature_name>.<feature_name>get_menu_items</feature_name>.<feature_name>add</feature_name> <symbol>(</symbol><symbol>(</symbol>"<string>&amp;File</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name><symbol>)</symbol>
	<feature_name>dummy</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>mi_file</feature_name>.<feature_name>get_menu_items</feature_name>.<feature_name>add_menu_item</feature_name> <symbol>(</symbol><keyword>create</keyword> <symbol>{</symbol><class_name>WINFORMS_MENU_ITEM</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make_from_text_and_on_click_and_shortcut</feature_name>
		<symbol>(</symbol><symbol>(</symbol>"<string>&amp;Open...</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name>, <keyword>create</keyword> <symbol>{</symbol><class_name>EVENT_HANDLER</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make</feature_name> <symbol>(</symbol><keyword>Current</keyword>, <symbol>$</symbol><feature_name>FileOpen_Clicked</feature_name><symbol>)</symbol>, <keyword>feature</keyword> <symbol>{</symbol><class_name>WINFORMS_SHORTCUT</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>ctrl_O</feature_name><symbol>)</symbol><symbol>)</symbol>
	<feature_name>dummy</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>mi_file</feature_name>.<feature_name>get_menu_items</feature_name>.<feature_name>add</feature_name> <symbol>(</symbol><symbol>(</symbol>"<string>-</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name><symbol>)</symbol> <comment>-- Gives us a separator</comment>
	<feature_name>dummy</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>mi_file</feature_name>.<feature_name>get_menu_items</feature_name>.<feature_name>add_menu_item</feature_name> <symbol>(</symbol><keyword>create</keyword> <symbol>{</symbol><class_name>WINFORMS_MENU_ITEM</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make_from_text_and_on_click_and_shortcut</feature_name>
		<symbol>(</symbol><symbol>(</symbol>"<string>E&amp;xit</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name>, <keyword>create</keyword> <symbol>{</symbol><class_name>EVENT_HANDLER</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make</feature_name> <symbol>(</symbol><keyword>Current</keyword>, <symbol>$</symbol><feature_name>FileExit_Clicked</feature_name><symbol>)</symbol>, <keyword>feature</keyword> <symbol>{</symbol><class_name>WINFORMS_SHORTCUT</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>ctrl_X</feature_name><symbol>)</symbol><symbol>)</symbol>
</code_block>
		<paragraph/>
		<heading>
			<size>2</size>Adding Submenus
		</heading>
		<paragraph>The following example demonstrates how to 
			<span>create</span> submenus.
		</paragraph>
		<code_block>
	<feature_name>mi_format</feature_name><symbol>:</symbol> <class_name>WINFORMS_MAIN_MENU</class_name>
</code_block>
		<code_block>
	<comment>-- Add Format Menu</comment>
	<feature_name>mi_format</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>main_menu</feature_name>.<feature_name>get_menu_items</feature_name>.<feature_name>add</feature_name> <symbol>(</symbol><symbol>(</symbol>"<string>F&amp;ormat</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name><symbol>)</symbol>

	<comment>-- Font Face sub-menu</comment>
	<keyword>create</keyword> <feature_name>mmi_sans_serif</feature_name>.<feature_name>make_from_text_and_on_click</feature_name> <symbol>(</symbol><symbol>(</symbol><symbol>(</symbol>""<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name><symbol>)</symbol><feature_name></feature_name>.<feature_name>concat_string_string</feature_name> <symbol>(</symbol><symbol>(</symbol>"<string>&amp;1.  </string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name>,
		<feature_name>sans_serif_font_family</feature_name>.<feature_name>get_name</feature_name><symbol>)</symbol>, <keyword>create</keyword> <symbol>{</symbol><class_name>EVENT_HANDLER</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make</feature_name> <symbol>(</symbol><keyword>Current</keyword>, <symbol>$</symbol><feature_name>FormatFont_Clicked</feature_name><symbol>)</symbol><symbol>)</symbol>
	<feature_name>mmi_sans_serif</feature_name>.<feature_name>set_checked</feature_name> <symbol>(</symbol><keyword>True</keyword><symbol>)</symbol>
	<feature_name>mmi_sans_serif</feature_name>.<feature_name>set_default_item</feature_name> <symbol>(</symbol><keyword>True</keyword><symbol>)</symbol>
	<keyword>create</keyword> <feature_name>mmi_serif</feature_name>.<feature_name>make_from_text_and_on_click</feature_name> <symbol>(</symbol><symbol>(</symbol><symbol>(</symbol>""<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name><symbol>)</symbol><feature_name></feature_name>.<feature_name>concat_string_string</feature_name><symbol>(</symbol><symbol>(</symbol>"<string>&amp;2.  </string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name>,
		<feature_name>serif_font_family</feature_name>.<feature_name>get_name</feature_name><symbol>)</symbol>, <keyword>create</keyword> <symbol>{</symbol><class_name>EVENT_HANDLER</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make</feature_name> <symbol>(</symbol><keyword>Current</keyword>, <symbol>$</symbol><feature_name>FormatFont_Clicked</feature_name><symbol>)</symbol><symbol>)</symbol>
	<keyword>create</keyword> <feature_name>mmi_mono_space</feature_name>.<feature_name>make_from_text_and_on_click</feature_name> <symbol>(</symbol><symbol>(</symbol><symbol>(</symbol>""<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name><symbol>)</symbol><feature_name></feature_name>.<feature_name>concat_string_string</feature_name><symbol>(</symbol><symbol>(</symbol>"<string>&amp;3.  </string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name>,
	<feature_name>mono_space_font_family</feature_name>.<feature_name>get_name</feature_name><symbol>)</symbol>, <keyword>create</keyword> <symbol>{</symbol><class_name>EVENT_HANDLER</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make</feature_name> <symbol>(</symbol><keyword>Current</keyword>, <symbol>$</symbol><feature_name>FormatFont_Clicked</feature_name><symbol>)</symbol><symbol>)</symbol>

	<keyword>create</keyword> <feature_name>l_array_menu_item</feature_name>.<feature_name>make</feature_name> <symbol>(</symbol>3<symbol>)</symbol>
	<feature_name>l_array_menu_item</feature_name>.<feature_name>put</feature_name> <symbol>(</symbol>0, <feature_name>mmi_sans_serif</feature_name><symbol>)</symbol>
	<feature_name>l_array_menu_item</feature_name>.<feature_name>put</feature_name> <symbol>(</symbol>1, <feature_name>mmi_serif</feature_name><symbol>)</symbol>
	<feature_name>l_array_menu_item</feature_name>.<feature_name>put</feature_name> <symbol>(</symbol>2, <feature_name>mmi_mono_space</feature_name><symbol>)</symbol>
	<feature_name>dummy</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>mi_format</feature_name>.<feature_name>get_menu_items</feature_name>.<feature_name>add_string_menu_item_array</feature_name> <symbol>(</symbol><symbol>(</symbol>"<string>Font &amp;Face</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name>, l_array_menu_item<symbol>)</symbol>
</code_block>
		<paragraph/>
		<heading>
			<size>2</size>Adding Default Menu Items
		</heading>
		<paragraph>The following example demonstrates how to specify a default menu item. </paragraph>
		<code_block>
	<feature_name>mmi_sans_serif</feature_name><symbol>:</symbol> <class_name>WINFORMS_MAIN_MENU</class_name>
</code_block>
		<code_block>
	<keyword>create</keyword> <feature_name>mmi_sans_serif</feature_name>.<feature_name>make_from_text_and_on_click</feature_name> <symbol>(</symbol><symbol>(</symbol><symbol>(</symbol>""<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name><symbol>)</symbol><feature_name></feature_name>.<feature_name>concat_string_string</feature_name> <symbol>(</symbol><symbol>(</symbol>"<string>&amp;1  </string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name>,
		 <feature_name>sans_serif_font_family</feature_name>.<feature_name>get_name</feature_name><symbol>)</symbol>, <keyword>create</keyword> <symbol>{</symbol><class_name>EVENT_HANDLER</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make</feature_name> <symbol>(</symbol><keyword>Current</keyword>, <symbol>$</symbol><feature_name>format_font_clicked</feature_name><symbol>)</symbol><symbol>)</symbol>
	<feature_name>mmi_sans_serif</feature_name>.<feature_name>set_checked</feature_name> <symbol>(</symbol><keyword>True</keyword><symbol>)</symbol>
</code_block>
		<paragraph/>
		<paragraph/>
		<heading>
			<size>2</size>Adding Check Marks to Menu Items
		</heading>
		<paragraph>The following example demonstrates how to display a check mark next to a menu item. The code also demonstrates how to track which item is checked. </paragraph>
		<code_block>
	<feature_name>mi_medium</feature_name><symbol>:</symbol> <class_name>WINFORMS_MAIN_MENU</class_name>
</code_block>
		<code_block>
	<keyword>create</keyword> <feature_name>mi_medium</feature_name>.<feature_name>make_from_text_and_on_click</feature_name> <symbol>(</symbol><symbol>(</symbol>"<string>&amp;Medium</string>"<symbol>)</symbol><feature_name></feature_name>.<feature_name>to_cil</feature_name>, <keyword>create</keyword> <symbol>{</symbol><class_name>EVENT_HANDLER</class_name><symbol>}</symbol><feature_name></feature_name>.<feature_name>make</feature_name> <symbol>(</symbol><keyword>Current</keyword>, <symbol>$</symbol><feature_name>format_size_clicked</feature_name><symbol>)</symbol><symbol>)</symbol>
	<feature_name>mi_medium</feature_name>.<feature_name>set_checked</feature_name> <symbol>(</symbol><keyword>True</keyword><symbol>)</symbol>
</code_block>
		<paragraph>
			<line_break/>
		</paragraph>
		<heading>
			<size>2</size>Cloning Menus
		</heading>
		<paragraph>In many cases, the context menu for a control is a subset of the main menu. You cannot add the same menu items to multiple menus, but you can clone a menu item or set of menu items. The following code demonstrates how to clone the 
			<bold>Format</bold> menu 
			<span>create</span>d previously and add it to the context menu of a 
			<bold>Label</bold>.
		</paragraph>
		<code_block>	<feature_name>mmy</feature_name> <symbol>:</symbol><symbol>=</symbol> <feature_name>label_1_context_menu</feature_name>.<feature_name>get_menu_items</feature_name>.<feature_name>add_menu_item</feature_name> <symbol>(</symbol><feature_name>mi_format</feature_name>.<feature_name>clone_menu</feature_name><symbol>)</symbol>
</code_block>
		<paragraph/>
	</paragraph></document>
