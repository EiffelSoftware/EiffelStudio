<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML XMLNS:MSHelp="http://msdn.microsoft.com/mshelp">
	<XML>
		<MSHelp:Keyword Index="K" Term="DLL" />
		<MSHelp:Keyword Index="K" Term="Shared Call" />
		<MSHelp:Keyword Index="K" Term="DESC" />
		<MSHelp:Attr Name="Product" Value="Eiffel"/>
		<MSHelp:Attr Name="Locale" Value="kbEnglish"/>
	</XML>
	<HEAD>
		<TITLE>DESC, Creating a Routine Object</TITLE>
		<LINK HREF="../../../../default.css" TYPE="text/css" REL="STYLESHEET">
	</HEAD>
	<BODY>
		<TABLE CLASS="HEADER">
			<TR>
				<TD CLASS="HEADER">Eiffel ENViSioN!</TD>
			</TR>
			<TR>
				<TD CLASS="SUBHEADER">DESC, Creating a Routine Object</TD>
			</TR>
		</TABLE>
		<TABLE CLASS="FRAME">
			<TR>
				<TD>
					<P>
						To create a DESC object representing a routine from a DLL, use a
						declaration such as:</p>
						
					<CODE>
						<SPAN CLASS="elocal">your_routine</SPAN><SPAN CLASS="esymbol">:</SPAN> <FONT CLASS="eclass">
						<A HREF="../../reference/desc/spec/win32/dll_32_routine_chart.html">
						DLL_32_ROUTINE</A></FONT>
					</CODE>
					
					<P>
						where <SPAN CLASS="elocal">your_routine</SPAN> should be replaced by whatever name you have chosen to
						denote the routine in your software, and execute a creation instruction of the form:</p>
						
					<CODE>
						<SPAN CLASS="ekeyword">create</SPAN> <SPAN CLASS="elocal">your_routine</SPAN>.<SPAN CLASS="elocal">make_by_name</SPAN> <SPAN CLASS="esymbol">(</SPAN><BR />
						&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="elocal">your_dll</SPAN><SPAN CLASS="esymbol">,</SPAN><BR />
						&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="estring">"your_routine_name"</SPAN><SPAN CLASS="esymbol">,</SPAN><BR />
						&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="esymbol">&lt;&lt;</SPAN><SPAN CLASS="elocal">argtyp1<SPAN CLASS="esymbol">,</SPAN> argtyp2<SPAN CLASS="esymbol">, ...</SPAN></SPAN><SPAN CLASS="esymbol">&gt;&gt;,</SPAN><BR />
						&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="elocal">res_type</SPAN><SPAN CLASS="esymbol">)</SPAN>
					</CODE>
					
					<P>
						or, if you prefer for faster access to identify the routine by an integer index rather
						than a name:</p>
						
					<CODE>
						<SPAN CLASS="ekeyword">create</SPAN>
						<SPAN CLASS="elocal">your_routine</SPAN>.<SPAN CLASS="elocal">make_by_index</SPAN>
						<SPAN CLASS="esymbol">(</SPAN><BR />
						&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="elocal">your_dll</SPAN><SPAN CLASS="esymbol">,</SPAN><BR />
						&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="elocal">your_routine_index</SPAN>,<SPAN CLASS="ecomment"> -- The only differing line</SPAN><BR />
						&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="esymbol">&lt;&lt;</SPAN><SPAN CLASS="elocal">argtyp1<SPAN CLASS="esymbol">,</SPAN> argtyp2<SPAN CLASS="esymbol">, ...</SPAN></SPAN><SPAN CLASS="esymbol">&gt;&gt;,</SPAN><BR />
						&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="elocal">res_type</SPAN><SPAN CLASS="esymbol">)</SPAN>
					</CODE>
						
					<P>where <SPAN CLASS="elocal">your_dll</SPAN> is the library object created <A HREF="library.html">
						previously</A>.</p>
						
					<P>
						After either call has been executed, the boolean value <SPAN CLASS="elocal">your_routine.meaningful</SPAN>
						will be true if and only if the creation has been successful, that is to say, the given
						name or index did correspond to a routine of the library, and it was possible to
						open it. If the value is false, you can have more details about the error by
						comparing the value of <SPAN CLASS="elocal">your_routine.error_code</SPAN>, an integer, to those
						of constants attributes defined in class
						<A HREF="../../reference/desc/general/shared_library_constants_chart.html">
						SHARED_LIBRARY_CONSTANTS</A>.</p>
				</TD>
			</TR>
		</TABLE>
		<TABLE CLASS="FOOTER">
			<TR>
				<TD>© 2003-2004 Eiffel Software. All rights reserved.</TD>
			</TR>
		</TABLE>
	</BODY>
</HTML>