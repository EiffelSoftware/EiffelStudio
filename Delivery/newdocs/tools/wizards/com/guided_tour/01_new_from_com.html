<!DOCTYPE HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<HTML>
	<HEAD>
		<TITLE>EiffelCOM Wizard Guided Tour Introduction</TITLE>
		<LINK REL=StyleSheet HREF="../../../../default.css">
		<META NAME = "MS-HKWD" CONTENT = "EiffelCOM">
		<META NAME = "MS-HKWD" CONTENT = "EiffelCOM Wizard">
		<META NAME = "MS-HKWD" CONTENT = "EiffelCOM Wizard, Guided Tour">
		<META NAME = "MS-HKWD" CONTENT = "EiffelCOM Wizard, Guided Tour, Creating a new COM component">
	</HEAD>

	<BODY>
		<h1 >
		Creating a new COM component</h1>

        The first tutorial describes creating a COM component 
		from a COM definition
		file that is either an IDL file or a Type Library. The 
		tutorial focuses on
		creating an in-process (DLL) component, called 
		<i>StringManipulator</i>. The
		component exposes one interface <i>IString</i> that 
		includes the functions <i>ReplaceSubstring</i>
		and <i>PruneAll</i> corresponding respectively to the 
		features <span class="efeature">replace_substring</span>
		and <span class="efeature">prune_all</span> of the 
		EiffelBase <span class="eclass">STRING</span> and the 
		property <i>String</i>
		that represents the manipulated string. The property 
		can be set or read. Other
		languages will be able to access these features.
		<h2>
		<A NAME="pgfId=375830">
		 </A>
		Step by step instructions</h2>
		<UL>
		<LI>
		<A NAME="pgfId=375641">
		 </A>
		Launch the EiffelCOM Wizard (from the Start menu, open 
		Programs then EiffelXX and click EiffelCOM Wizard)</LI>
		<LI>
		<A NAME="pgfId=375695">
		</A>Choose <i>Create a new project from a COM 
		definition</i>.</LI>
		<LI>
		<A NAME="pgfId=375699">
		</A>Click <i>Next</i></LI>
		<LI>
		<A NAME="pgfId=375701">
		</A>Choose <i>Server code for a new component</i></LI>
		<LI>
		<A NAME="pgfId=375703">
		</A>Click <i>Next</i></LI>
		<LI>
		<A NAME="pgfId=375704">
		</A>Click the top <i>Browse</i> button and open the 
		file <i>$ISE_EIFFEL\examples\com\wizard\string_manipulator\string_manipulator.idl</i>
		where <i>$ISE_EIFFEL</i> represents the path to your EIFFEL50 directory.</LI>
		<LI>
		<A NAME="pgfId=375705">
		</A>Click the bottom <i>Browse</i> button and select the directory where you
		want to create the project (later referenced as destination folder). Choose <i>$ISE_EIFFEL\examples\com\wizard\string_manipulator\generated</i>
		where <i>$ISE_EIFFEL</i> represents the path to your EIFFEL50 directory. If you
		work on a Windows9x machine, please choose a directory with a shorter path, for
		example c:\string_manipulator because Windows9x are unable to handle long path
		names.</LI>
		<LI>
		<A NAME="pgfId=375706">
		</A>Click <i>Next</i></LI>
		<LI>
		<A NAME="pgfId=375707">
		</A>Choose <i>Automation</i></LI>
		<LI>
		<A NAME="pgfId=375708">
		</A>Click <i>Next</i></LI>
		<LI>
		<A NAME="pgfId=375716">
		</A>Click <i>Finish</i></LI>
		<LI>
		<A NAME="pgfId=375717">
		</A>Wait until the wizard is done.</LI>
		</UL>
		<h2>
		<A NAME="pgfId=375741">
		 </A>
        First look at the generated code</h2>

		<p><a name="pgfId_375748"></a>At the end of the processing the
		wizard automatically launches EiffelBench with the generated project to help you
		navigate created Eiffel classes. You might want to look at the file <i>generated.txt</i>
		in the destination folder, which contains a list of files generated by the
		wizard. The file <i>string_manipulator.log</i> holds summary of the processing
		and error and warning messages.</p>


		<p>The deferred class 
		<SPAN CLASS="eclass">STRING_MANIPULATOR_COCLASS</span> 
		represents
		component functionality. It inherits from 
		<SPAN CLASS="eclass">ISTRING_INTERFACE</span> that
		corresponds to the <i>IString</i> interface. It has 
		one descendant 
		<SPAN CLASS="eclass">STRING_MANIPULATOR_COCLASS_IMP</span>
		that implements the deferred features. The default 
		implementation is empty.</p>
		<h2>
		<A NAME="pgfId=375810">
		 </A>
		implementing the component</h2>
		<A NAME="pgfId=375894"></A>
		 To do something more interesting than merely return an error to a client edit
		 the implementation of the <SPAN CLASS="eclass">STRING_MANIPULATOR_COCLASS_IMP</span> class. The
		 wizard would not overwrite this class in future executions. There is an
		 implementation of the class in <i>$ISE_EIFFEL\examples\com\wizard\string_manipulator\server</i>\.
		 Copy this file over to <i>$ISE_EIFFEL\examples\com\wizard\string_manipulator\generated\server\component</i>
		 and freeze the project. Voila!, you have your first EiffelCOM component up and
		 running.
		 <P>&nbsp;</P>
		<P class="tip">
		Tips:<br><br>
   
		To develop an EiffelCOM component you need to set the
		 registry entry MELT_PATH because the system is not launched from the directory
		 containing the byte code (by default EIFGEN\W_code). The EiffelCOM component
		 client launches the server from its current location and causes the server to
		 crash if the MELT_PATH key does not setup properly. To put this value in your
		 registry, create a key under HKEY_CURRENT_USER\SOFTWARE\ISE\Eiffel45 with the
		 same name as the name of your project (e.g. <i>string_manipulator</i>) and add
		 the string value named MELT_PATH containing the path to the byte code (.melted
		 file). You will find an example of such entry in the file <i>melted_path.reg</i>
		 in $ISE_EIFFEL\wizard\config. Edit this file as needed (replace <i>string_manipulator</i>
		 with the name of your system and change the path to point on the correct
		 location using `\\' as directory separator) and then double click on it to
		 enter the information into the registry.
        <br><br>
		<A NAME="pgfId=375977">
		</A>To test the component, you need to register it first. Register an in-process
		component via the <i>regsvr32</i> utility using the following syntax: <i>regsvr32
		system_name.dll</i> where <i>system_name</i> is the name of the dll (e.g.
		string_manipulator). Register an out-of-process component using the following
		syntax: <i>system_name.exe -Regserver</i> where <i>system_name</i> is the name
		of the component executable file.
        <br><br>
		<A NAME="pgfId=375983">
		</A>To complete this tutorial you need to register the component with the
		following command (run from a dos console): <i>regsvr32 string_manipulator.dll</i>
		and to enter the information in <i>$ISE_EIFFEL\wizard\config\melted_path.reg</i>.
		You have to change the content of this file if you have not installed Eiffel
		under C:\ and/or have used a different destination directory.
		</p>
        <p class="seealso">See Also: <a href="02_new_from_eiffel.html">Creating a new component from an
            Eiffel Project</a>, <a href="03_accessing.html">Accessing a COM component.</a></p>
		<P>&nbsp;</P>

	</BODY>
</HTML>
