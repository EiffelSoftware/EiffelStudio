<HTML>

<HEAD>
<META NAME="GENERATOR" CONTENT="Microsoft FrontPage 5.0">
<META NAME="ProgId" CONTENT="FrontPage.Editor.Document">
<LINK REL="StyleSheet" HREF="../../../default.css">
<META NAME="MS-HKWD" CONTENT="Example,calendar">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1252">
<TITLE>Calendar example</TITLE>
</HEAD>

<BODY>

<H1>Calendar example</H1>
<P>This example shows you how to use the ASP control Calendar. It displays the date selected in the
calendar.</P>
<PRE>&lt;%@ Page <B>Language=&quot;Eiffel&quot;</B> Description=&quot;Eiffel ASP.NET example&quot; %&gt;

&lt;scri</PRE>
<H1>Calendar configuration examples</H1>
<P>These examples show you how to configure the different parameters of a calendar control. To do so
you have to solutions.</P>
<P>The first solution consists to initialize the parameters of calendar at the same time it is
declared.</P>
<PRE>&lt;%@ Page <B>Language=&quot;Eiffel&quot;</B> Description=&quot;Eiffel ASP.NET example&quot; %&gt;

&lt;script runat=server&gt;
   <SPAN CLASS="eKeyword">feature</SPAN> <SPAN CLASS="eComment">-- Basic Operation</SPAN>
	<SPAN CLASS="eFeature">selected_date_changed</SPAN> (<SPAN CLASS="eLocal">source</SPAN>: <SPAN CLASS="eClass">SYSTEM_OBJECT</SPAN>; <SPAN CLASS="eLocal">e</SPAN>: <SPAN CLASS="eClass">EVENT_ARGS</SPAN>) is
		<SPAN CLASS="eComment">-- Method calles when date selected change.</SPAN>
	    <SPAN CLASS="eKeyword">do</SPAN>
	 	<SPAN CLASS="eFeature"><SPAN STYLE="background-position: 0 0">response</SPAN></SPAN>.<SPAN CLASS="eFeature"><SPAN STYLE="background-position: 0 0">write_string</SPAN></SPAN> (<SPAN CLASS="eLocal">cal</SPAN>.<SPAN CLASS="eFeature">selected_dates</SPAN>.<SPAN CLASS="eFeature"><SPAN STYLE="background-position: 0 0">item</SPAN> </SPAN>(<SPAN CLASS="eLocal">cal</SPAN>.<SPAN CLASS="eFeature">selected_dates</SPAN>.<SPAN CLASS="eFeature">count </SPAN>- 1).<SPAN CLASS="eFeature">to_short_date_string</SPAN>)
	    <SPAN CLASS="eKeyword">end</SPAN>
&lt;/script&gt;

&lt;html&gt;
    &lt;body&gt;
	&lt;form runat=server&gt;
	    &lt;asp:Calendar id=cal runat=server SelectionMode=DayWeekMonth
		OnSelectionChanged=selected_date_changed
&nbsp;
		BackColor=&quot;Beige&quot;
		ForeColor=&quot;Brown&quot;
		BorderWidth=&quot;3&quot;
		BorderStyle=&quot;Solid&quot;
		BorderColor=&quot;Black&quot;
		Height=&quot;450&quot;
		Width=&quot;450&quot;
		Font-Size=&quot;12pt&quot;
		Font-Name=&quot;Tahoma,Arial&quot;
		Font-Underline=&quot;false&quot;
		CellSpacing=2
		CellPadding=2
		ShowGridLines=true

		TitleStyle-BorderColor=&quot;darkolivegreen&quot;
		TitleStyle-BorderWidth=&quot;3&quot;
		TitleStyle-BackColor=&quot;olivedrab&quot;
		TitleStyle-Height=&quot;50px&quot;

		DayHeaderStyle-BorderColor=&quot;darkolivegreen&quot;
		DayHeaderStyle-BorderWidth=&quot;3&quot;
		DayHeaderStyle-BackColor=&quot;olivedrab&quot;
		DayHeaderStyle-ForeColor=&quot;black&quot;
		DayHeaderStyle-Height=&quot;20px&quot;

		DayStyle-Width=&quot;50px&quot;
		DayStyle-Height=&quot;50px&quot;

		TodayDayStyle-BorderWidth=&quot;3&quot;

		WeekEndDayStyle-BackColor=&quot;palegoldenrod&quot;
		WeekEndDayStyle-Width=&quot;50px&quot;
		WeekEndDayStyle-Height=&quot;50px&quot;

		SelectedDayStyle-BorderColor=&quot;firebrick&quot;
		SelectedDayStyle-BorderWidth=&quot;3&quot;

		OtherMonthDayStyle-Width=&quot;50px&quot;
		OtherMonthDayStyle-Height=&quot;50px&quot;
	    /&gt;
	&lt;/form&gt;
    &lt;/body&gt;
&lt;html&gt;</PRE>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>The second solution consists to initialize the parameters of calendar in a feature,
<SPAN CLASS="eFeature">on_load</SPAN> feature for instance.</P>
<PRE>&lt;%@ Page <B>Language=&quot;Eiffel&quot;</B> Description=&quot;Eiffel ASP.NET example&quot; %&gt;

&lt;script runat=server&gt;
	<SPAN CLASS="eKeyword">redefine</SPAN>
		<SPAN CLASS="eFeature">on_load</SPAN>
	<SPAN CLASS="eKeyword">end</SPAN>
&lt;/script&gt;

&lt;script runat=server&gt;
<SPAN CLASS="eKeyword">feature</SPAN> <SPAN CLASS="eComment">-- Redefinition</SPAN>
     <SPAN CLASS="eFeature">on_load</SPAN> (<SPAN CLASS="eLocal">e</SPAN>: <SPAN CLASS="eClass">EVENT_ARGS</SPAN>) is
	    <SPAN CLASS="eComment">-- redefinition of on_load feature</SPAN>
	<SPAN CLASS="eKeyword">do</SPAN>
	    <SPAN CLASS="eKeyword">Precursor </SPAN>{<SPAN CLASS="eClass">WEB_PAGE</SPAN>} (<SPAN CLASS="eLocal">e</SPAN>)

	    cal.set_back_color (feature {DRAWING_COLOR}.beige)
	    cal.set_fore_color (feature {DRAWING_COLOR}.brown)
	    cal.set_border_width (feature {WEB_UNIT}.parse_string_culture_info ((&quot;3px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))
	    cal.set_border_style (feature {WEB_BORDER_STYLE}.solid)
	    cal.set_border_color (feature {DRAWING_COLOR}.black)
	    cal.set_height (feature {WEB_UNIT}.parse_string_culture_info ((&quot;450px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))
	    cal.set_width (feature {WEB_UNIT}.parse_string_culture_info ((&quot;450px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))
	    cal.font.set_size (feature {WEB_FONT_UNIT}.parse_string_culture_info ((&quot;12pt&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))
	    cal.font.set_name ((&quot;Tahoma,Arial&quot;).to_cil)
	    cal.font.set_underline (False)
	    cal.set_cell_spacing (2)
	    cal.set_cell_padding (2)
	    cal.set_show_grid_lines (True)

	    cal.title_style.set_border_color (feature {DRAWING_COLOR}.dark_olive_green)
	    cal.title_style.set_border_width (feature {WEB_UNIT}.parse_string_culture_info ((&quot;3px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))
	    cal.title_style.set_back_color (feature {DRAWING_COLOR}.olive_drab)
	    cal.title_style.set_height (feature {WEB_UNIT}.parse_string_culture_info ((&quot;50px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))

	    cal.day_header_style.set_border_color (feature {DRAWING_COLOR}.dark_olive_green)
	    cal.day_header_style.set_border_width (feature {WEB_UNIT}.parse_string_culture_info ((&quot;3px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))
	    cal.day_header_style.set_back_color (feature {DRAWING_COLOR}.olive_drab)
	    cal.day_header_style.set_fore_color (feature {DRAWING_COLOR}.black)
	    cal.day_header_style.set_height (feature {WEB_UNIT}.parse_string_culture_info ((&quot;20px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))

	    cal.day_style.set_width (feature {WEB_UNIT}.parse_string_culture_info ((&quot;50px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))
	    cal.day_style.set_height (feature {WEB_UNIT}.parse_string_culture_info ((&quot;50px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))
	    cal.today_day_style.set_border_width (feature {WEB_UNIT}.parse_string_culture_info ((&quot;3px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))

	    cal.weekend_day_style.set_back_color (feature {DRAWING_COLOR}.pale_goldenrod)
	    cal.weekend_day_style.set_width (feature {WEB_UNIT}.parse_string_culture_info ((&quot;50px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))
	    cal.weekend_day_style.set_height (feature {WEB_UNIT}.parse_string_culture_info ((&quot;50px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))

	    cal.selected_day_style.set_border_color (feature {DRAWING_COLOR}.firebrick)
	    cal.selected_day_style.set_border_width (feature {WEB_UNIT}.parse_string_culture_info ((&quot;3px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))

	    cal.other_month_day_style.set_width (feature {WEB_UNIT}.parse_string_culture_info ((&quot;50px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))
	    cal.other_month_day_style.set_height (feature {WEB_UNIT}.parse_string_culture_info ((&quot;50px&quot;).to_cil, feature {CULTURE_INFO}.invariant_culture))
	<SPAN CLASS="eKeyword">end</SPAN>

<SPAN CLASS="eKeyword">feature</SPAN> <SPAN CLASS="eComment">-- Basic Operation</SPAN>
    <SPAN CLASS="eFeature">selected_date_changed</SPAN> (<SPAN CLASS="eLocal">source</SPAN>: <SPAN CLASS="eClass">SYSTEM_OBJECT</SPAN>; <SPAN CLASS="eLocal">e</SPAN>: <SPAN CLASS="eClass">EVENT_ARGS</SPAN>) is
	    <SPAN CLASS="eComment">-- Method calles when date selected change.</SPAN>
	<SPAN CLASS="eKeyword">do</SPAN>
	<SPAN CLASS="eFeature"><SPAN STYLE="background-position: 0 0">    response</SPAN></SPAN>.<SPAN CLASS="eFeature"><SPAN STYLE="background-position: 0 0">write_string</SPAN></SPAN> (<SPAN CLASS="eLocal">cal</SPAN>.<SPAN CLASS="eFeature">selected_dates</SPAN>.<SPAN CLASS="eFeature"><SPAN STYLE="background-position: 0 0">item</SPAN> </SPAN>(<SPAN CLASS="eLocal">cal</SPAN>.<SPAN CLASS="eFeature">selected_dates</SPAN>.<SPAN CLASS="eFeature">count </SPAN>- 1).<SPAN CLASS="eFeature">to_short_date_string</SPAN>)
	<SPAN CLASS="eKeyword">end</SPAN>
&lt;/script&gt;

&lt;html&gt;
    &lt;body&gt;
	&lt;form runat=server&gt;
	    &lt;asp:Calendar id=cal runat=server SelectionMode=DayWeekMonth
		OnSelectionChanged=selected_date_changed /&gt;
	&lt;/form&gt;
    &lt;/body&gt;
&lt;html&gt;</PRE>
<P>&nbsp;</P>
<P>Both codes have the same result. However, the second solution is a lot more quicker at the
execution.</P>
<P>&nbsp;</P>
<P>Here is the output:</P>
<P>&nbsp;</P>
<P ALIGN="center">
<IMG BORDER="0" SRC="../../../images/asp.net/calendar_config_example.png" WIDTH="514" HEIGHT="618"></P>
<P ALIGN="center"><A HREF="http://localhost/eiffel_samples/calendar_init_example.aspx">[run the example]</A></P>
<PRE>pt runat=server&gt;
   <SPAN CLASS="eKeyword">feature</SPAN> <SPAN CLASS="eComment">-- Basic Operation</SPAN>
	<SPAN CLASS="eFeature">selected_date_changed</SPAN> (<SPAN CLASS="eLocal">source</SPAN>: <SPAN CLASS="eClass">SYSTEM_OBJECT</SPAN>; <SPAN CLASS="eLocal">e</SPAN>: <SPAN CLASS="eClass">EVENT_ARGS</SPAN>) is
		<SPAN CLASS="eComment">-- Method calles when date selected change.</SPAN>
	    <SPAN CLASS="eKeyword">do</SPAN>
	 	<SPAN CLASS="eFeature"><SPAN STYLE="background-position: 0 0">response</SPAN></SPAN>.<SPAN CLASS="eFeature"><SPAN STYLE="background-position: 0 0">write_string</SPAN></SPAN> (<SPAN CLASS="eLocal">cal</SPAN>.<SPAN CLASS="eFeature">selected_dates</SPAN>.<SPAN CLASS="eFeature"><SPAN STYLE="background-position: 0 0">item</SPAN> </SPAN>(<SPAN CLASS="eLocal">cal</SPAN>.<SPAN CLASS="eFeature">selected_dates</SPAN>.<SPAN CLASS="eFeature">count </SPAN>- 1).<SPAN CLASS="eFeature">to_short_date_string</SPAN>)
	    <SPAN CLASS="eKeyword">end</SPAN>
&lt;/script&gt;

&lt;html&gt;
    &lt;body&gt;
	&lt;form runat=server&gt;
	    &lt;asp:Calendar id=cal runat=server SelectionMode=DayWeekMonth
		OnSelectionChanged=selected_date_changed /&gt;
	&lt;/form&gt;
    &lt;/body&gt;
&lt;html&gt;</PRE>
<P>&nbsp;</P>
<P>Here is the output:</P>
<P>&nbsp;</P>
<P ALIGN="center">
<IMG BORDER="0" SRC="../../../images/asp.net/calendar_example_output.png" WIDTH="550" HEIGHT="374"></P>
<P ALIGN="center"><A HREF="http://localhost/eiffel_samples/calendar_example.aspx">[run the example]</A></P>

</BODY>

</HTML>
