<document title="Coclass" output="studio">
	<meta_data/>
	<paragraph> We have seen that interfaces can be perceived as views of a component. This conceptual representation actually maps the implementation of an EiffelCOM component since the coclass inherits from the interfaces and implements their deferred features. Indeed, interfaces are deferred classes with all features accessible from outside deferred. The coclass is an Eiffel class that inherits from these interfaces and implements all the features. This design is not specific to Eiffel though and can be found in other languages as well. The coclass defines the behavior of the interface functions.
		<line_break/>
		<heading>
			<size>2</size>Class Object
		</heading>
		<link/> We have seen that interfaces are accessed through interface pointers. But how does a client get hold on one of these?
		<paragraph>The answer lies in the class object. The name of this module should really be coclass factory since its goal is to spawn instances of the coclass on request. Class objects are accessed by COM whenever a client request a new instance of the associated component. COM loads the class object and asks it to provide the interface pointer requested by the client. </paragraph>
		<paragraph>The way a class object is loaded in memory (this process is called activation) depends on the location of the component (See 
			<link>
				<url>05_component_location.xml</url>
				<label>Location</label>
			</link> for a description of the possible locations of a component). If the component is an in-process server then the class object is called directly through the functions exported from the DLL. If the component is an out-of-process server then it provides COM with a pointer to the class object. In both cases, once the component is loaded, COM has access to the class object and can call it would a client request a new instance of a component.
		</paragraph>
		<image>
			<legend>Component Creation</legend>
			<height>136</height>
			<width>475</width>
			<url>images/com-1.gif</url>
		</image>
		<paragraph>
			<link/> The code for the class object is generated by the EiffelCOM wizard so that Eiffel programmers will not have to worry about it.
		</paragraph>
		<seealso>
			<bold>See Also</bold>
			<line_break/>
			<link>
				<url>../../tools/wizards/com/index.xml</url>
				<label>EiffelCOM wizard</label>
			</link>
			<line_break/>
			<link>
				<url>../../libraries/com/index.xml</url>
				<label> EiffelCOM library</label>
			</link>
			<line_break/>
			<link>
				<url>01_introduction.xml</url>
				<label> Introduction</label>
			</link>
			<line_break/>
			<link>
				<url>02_generalities.xml</url>
				<label>Generalities</label>
			</link>
			<line_break/>
			<link>
				<url>03_interfaces.xml</url>
				<label> COM Interfaces</label>
			</link>
			<line_break/>
			<link>
				<url>05_component_location.xml</url>
				<label> Component Location</label>
			</link>
			<line_break/>
			<link>
				<url>06_access_type.xml</url>
				<label> Access Type</label>
			</link>
			<line_break/>
			<link>
				<url>07_deeper_into_com.xml</url>
				<label> Deeper into COM</label>
			</link>
		</seealso>
	</paragraph></document>
