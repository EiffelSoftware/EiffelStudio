<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML XMLNS:MSHelp="http://msdn.microsoft.com/mshelp">
	<XML>
		<MSHelp:Keyword Index="K" Term="MDI" />
		<MSHelp:Keyword Index="K" Term="Samples, MDI" />
		<MSHelp:Attr Name="Product" Value="Eiffel"/>
		<MSHelp:Attr Name="Locale" Value="kbEnglish"/>
	</XML>
	<HEAD>
		<TITLE>Using Multiple Document Interface Applications</TITLE>
		<LINK HREF="../../../../../default.css" TYPE="text/css" REL="STYLESHEET">
	</HEAD>
	<BODY LANGUAGE="vbscript" ONLOAD="onLoadHandler">
		<TABLE CLASS="HEADER" ID="Table1">
			<TR>
				<TD CLASS="HEADER">Eiffel ENViSioN!</TD>
				<TD></TD>
			</TR>
			<TR>
				<TD CLASS="SUBHEADER">Using Multiple Document Interface Applications</TD>
				<TD ALIGN=RIGHT>
					<A CLASS="bold" HREF="#NONEXISTANT" OnClick="LoadSample()">Load in Eiffel ENViSioN! </A>
				</TD>
			</TR>
		</TABLE>
		<TABLE CLASS="FRAME" ID="Table2">
			<TR>
				<TD>
					<SCRIPT LANGUAGE=VBScript SRC="sample.vbs"></SCRIPT>
					<SCRIPT LANGUAGE=VBScript>
						Sub onLoadHandler()
							'Initialize global variables
							SampleDir = "\winforms\mdi"
							SamplePrj = "mdi.eifp"
						End Sub							
					</SCRIPT>

					<p>Multiple Document Interface (MDI) applications have a single, primary window
					(the parent window) that contains a set of windows within its client region
					(child windows). Each child window is a form that is constrained to appear only
					within the parent. Children typically share the menu bar, tool bar, and other
					parts of the parent's interface. Secondary windows like dialog boxes are not
					constrained to the parent window's client region.</p>
					
					<h2>Creating an MDI Application</h2>
					
					<p>You can create an MDI application by following these steps:</p>
					
					<ol>
						<li>Create a <b>Form</b> (<b>MainForm</b>) that represents the MDI parent window
						and set its <b>IsMdiContainer</b> property to <b>true</b>. The following code
						demonstrates how to set this property:
						
						<CODE>
							<SPAN CLASS="efeature">set_is_mdi_container</SPAN>
							(<SPAN CLASS="ekeyword">True</SPAN>)
						</CODE></li>
						
						<li>
							Create child forms and set the <SPAN CLASS="efeature">mdi_parent</SPAN>
							property of each form to
							reference the parent form. The following code demonstrates setting the MDI
							parent for an instance of a child form:
							<CODE>
								<SPAN CLASS="elocal">doc</SPAN>.<SPAN CLASS="efeature">set_mdi_parent</SPAN>
								(<SPAN CLASS="ekeyword">Current</SPAN>)
							</CODE>
						</li>
					</ol>
					
					<p>If you have different types of data to display, you can have multiple types of
					child forms. To display a child form, create an instance of the child form and
					call its <SPAN CLASS="efeature">show</SPAN> method.</p>
					
					<h2>Standard MDI Menus</h2>
					
					<p>Typically, an MDI application has a <b>Windows</b> menu that allows the user to
					arrange the open child windows through tiling or cascading. The <b>Windows</b> menu
					also allows you to navigate to any of the open child windows. To create a <b>Windows</b>
					menu, add the menu items for tiling and cascading to a <b>Windows</b> menu in
					your parent form and set the <b>MdiList</b> property to <b>true</b> for the
					top-level <b>Windows</b> menu. The following code demonstrates how to create a <b>Windows</b>
					menu in an MDI application.</p>
					
					<CODE>
						<SPAN CLASS="elocal">mi_window</SPAN>: <SPAN CLASS="eclass">WINFORMS_MENU_ITEM</SPAN>
					</CODE>
					
					<CODE>
						<SPAN CLASS="elocal">mi_window </SPAN>:= <SPAN CLASS="efeature">main_menu</SPAN>.<SPAN CLASS="efeature">menu_items.add</SPAN> (<SPAN CLASS="estring">"&amp;Window"</SPAN>)<BR />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">mi_window</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add </SPAN>(<SPAN CLASS="estring">"&amp;Cascade"</SPAN>, <SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">window_cascade_clicked</SPAN>))<BR />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">mi_window</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add </SPAN>(<SPAN CLASS="estring">"Tile &amp;Horizontal"</SPAN>, <SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">window_tile_h_clicked</SPAN>))<BR />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">mi_window</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add </SPAN>(<SPAN CLASS="estring">"Tile &amp;Vertical"</SPAN>, <SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">window_tile_v_clicked</SPAN>))<BR />
						<SPAN CLASS="elocal">mi_window</SPAN>.<SPAN CLASS="efeature">set_mdi_list</SPAN> (<SPAN CLASS="ekeyword">True</SPAN>) <span class="eComment">-- Adds the MDI Window List to the bottom of the menu</SPAN>
					</CODE>

					<h2>Child Window Activation</h2>
					
					<p>If you want your parent form to be notified when a child window is activated by
					the user, you can register an event-handling method for the <SPAN CLASS="efeature">mdi_child_activate</SPAN>
					event. You can determine which child window is active by using the
					<SPAN CLASS="efeature">active_mdi_child</SPAN> property of the <SPAN CLASS="eclass">WINFORMS_FORM</b>
					class. For example, the following code updates a <SPAN CLASS="eclass">WINFORMS_STATUS_BAR</SPAN>
					control on the parent form with the name of the child window.</p>

					<CODE>
						....<BR />
						<SPAN CLASS="efeature">add_mdi_child_activate</SPAN> (<SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">mdi_child_activated</SPAN>))<BR />
						....<BR />
						<SPAN CLASS="efeature">mdi_child_activated</SPAN> (sender: <SPAN CLASS="eclass">SYSTEM_OBJECT</SPAN>; e: <SPAN CLASS="eclass">EVENT_ARGS</SPAN>) is<BR />
						do<BR />
						&nbsp;&nbsp;&nbsp;&nbsp; status_bar.<SPAN CLASS="efeature">set_text</SPAN> (active_mdi_child.<SPAN CLASS="efeature">get_text</SPAN>)<BR />
						end<BR />
						....
					</CODE>
				</TD>
			</TR>
		</TABLE>
		<TABLE CLASS="FOOTER" ID="Table3">
			<TR>
				<TD>© 2003-2004 Eiffel Software. All rights reserved.</TD>
			</TR>
		</TABLE>
	</BODY>
</HTML>