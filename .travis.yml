language: eiffel
before_script:
- export current_dir=$PWD ; echo current_dir=$current_dir ; cd ..
- export ISE_EIFFEL=$PWD/Eiffel_18.11;
- export ISE_PLATFORM=macosx-x86-64
- curl -sSL https://ftp.eiffel.com/pub/download/18.11/Eiffel_18.11_gpl_102592-macosx-x86-64.tar.bz2 | tar -x --bzip2 
- export PATH=$PATH:$ISE_EIFFEL/studio/spec/$ISE_PLATFORM/bin:$PATH:$ISE_EIFFEL/tools/spec/$ISE_PLATFORM/bin 
- echo `ec -version`
- curl --remote-name https://www.openssl.org/source/openssl-1.1.1a.tar.gz  
- tar -xzvf openssl-1.1.1a.tar.gz
- cd openssl-1.1.1a
- ./config --prefix=$PWD/openssl-1.1.1a
- make
- make install
- sudo ln -s $PWD/openssl-1.1.1a /usr/local/openssl
- echo 'export PATH=/usr/local/openssl/bin:$PATH' >> ~/.bash_profile
- echo 'export MANPATH=/usr/local/openssl/share/man:$MANPATH' >> ~/.bash_profile
- source ~/.bash_profile
- cd $current_dir
- export EIFFEL_SRC=$PWD/Src
- export EWEASEL=$PWD/eweasel
- export ISE_LIBRARY=$EIFFEL_SRC
- export XEBRA_LIBRARY=$EIFFEL_SRC/framework/web/xebra/eiffel_projects/library
- echo Check projects compilation status...
- echo `openssl version -a`
branches:
  only:
  - es_mac
git:
  depth: 1
env:
  matrix:
  #- COMPILEALL_DIR=Src/Eiffel
  #- COMPILEALL_DIR=Src/framework
  #- COMPILEALL_DIR=Src/tools
  #- COMPILEALL_DIR=Src/library
  - COMPILEALL_DIR=Src/unstable/library
  #- COMPILEALL_DIR=Src/contrib/library
script:
- compile_all -ecb -melt -list_failures -log_verbose -clean -options dotnet=false -l $COMPILEALL_DIR
group: stable
os: osx
sudo: required
