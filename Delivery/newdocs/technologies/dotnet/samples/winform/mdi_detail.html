<html>
	<head>
		<style> td.code { border-left:1px solid cccccc; border-bottom:0px none cccccc; border-top:0px none cccccc; border-right:0px none cccccc; background-color:ffffee; padding-left:10; padding-right:10; padding-top:0; padding-bottom:0 }
	td.tab { border-left:1px solid black; border-top:1px solid black; border-bottom:1px solid black; text-align:center; width:15%; padding:3; border-right:0px none black; background-color:eeeeee; cursor:hand; font-style:normal; font-variant:normal; font-weight:normal; font-size:8pt; font-family:verdana }
	td.backtab { border-left:1px solid black; border-top:1px solid black; border-bottom:1px solid black; text-align:center; width:15%; padding:3; border-right:0px none black; background-color:cccccc; cursor:hand; font-style:normal; font-variant:normal; font-weight:normal; font-size:8pt; font-family:verdana }
	td.space { border-left:1px solid black; border-top:1px solid cccccc; width:70%; padding:0; border-bottom:1px none cccccc; border-right:1px none cccccc; background-color:white; font-style:normal; font-variant:normal; font-weight:normal; font-size:8pt; font-family:verdana }
	</style>
		<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
		<meta name="ProgId" content="FrontPage.Editor.Document">
		<LINK REL="StyleSheet" HREF="../../../../default.css">
	</head>
	<body>
		<h1>Using Multiple Document Interface Applications</h1>
		<p>Multiple Document Interface (MDI) applications have a single, primary window 
			(the parent window) that contains a set of windows within its client region 
			(child windows). Each child window is a form that is constrained to appear only 
			within the parent. Children typically share the menu bar, tool bar, and other 
			parts of the parent's interface. Secondary windows like dialog boxes are not 
			constrained to the parent window's client region.</p>
		<h2>Creating an MDI Application</h2>
		<p>You can create an MDI application by following these steps:
		</p>
		<ol>
			<li>
				Create a <b>Form</b> (<b>MainForm</b>) that represents the MDI parent window 
				and set its <b>IsMdiContainer</b> property to <b>true</b>. The following code 
				demonstrates how to set this property.<pre><span class="eFeature">set_is_mdi_container</span> (<span class="eKeyword">True</span>)</pre>
			<li>
				Create child forms and set the <b>MdiParent</b> property of each form to 
				reference the parent form. The following code demonstrates setting the MDI 
				parent for an instance of a child form.
				<br>
				<pre>doc.<span class="eFeature">set_mdi_parent</span> (<span class="eKeyword">Current</span>)</pre>
			</li>
		</ol>
		<p>If you have different types of data to display, you can have multiple types of 
			child forms. To display a child form, create an instance of the child form and 
			call its <b>Show</b> method.
		</p>
		<p>&nbsp;</p>
		<h2>Standard MDI Menus</h2>
		<p>Typically, an MDI application has a <b>Windows</b> menu that allows the user to 
			arrange the open child windows through tiling or cascading. The <b>Windows</b> menu 
			also allows you to navigate to any of the open child windows. To create a <b>Windows</b>
			menu, add the menu items for tiling and cascading to a <b>Windows</b> menu in 
			your parent form and set the <b>MdiList</b> property to <b>true</b> for the 
			top-level <b>Windows</b> menu. The following code demonstrates how to create a <b>Windows</b>
			menu in an MDI application.</p>
		<pre><span class="eLocal">mi_window</span>: <span class="eClass">WINFORMS_MENU_ITEM</span></pre>
		<pre><span class="eLocal">mi_window </span>:= main_menu.<span class="eFeature">get_menu_items.add</span> ((<span class="eString">"&amp;Window"</span>).<span class="eFeature">to_cil</span>)
dummy := <span class="eLocal">mi_window</span>.<span class="eFeature">get_menu_items</span>.<span class="eFeature">add_string_event_handler </span>((<span class="eString">"&amp;Cascade"</span>).<span class="eFeature">to_cil</span>, create {<span class="eClass">EVENT_HANDLER</span>}.<span class="eFeature">make</span> (<span class="eKeyword">Current</span>, $window_cascade_clicked))
dummy := <span class="eLocal">mi_window</span>.<span class="eFeature">get_menu_items</span>.<span class="eFeature">add_string_event_handler </span>((<span class="eString">"Tile &amp;Horizontal"</span>).<span class="eFeature">to_cil</span>, create {<span class="eClass">EVENT_HANDLER</span>}.<span class="eFeature">make</span> (<span class="eKeyword">Current</span>, $window_tile_h_clicked))
dummy := <span class="eLocal">mi_window</span>.<span class="eFeature">get_menu_items</span>.<span class="eFeature">add_string_event_handler </span>((<span class="eString">"Tile &amp;Vertical"</span>).<span class="eFeature">to_cil</span>, create {<span class="eClass">EVENT_HANDLER</span>}.<span class="eFeature">make</span> (<span class="eKeyword">Current</span>, $window_tile_v_clicked))
<span class="eLocal">mi_window</span>.<span class="eFeature">set_mdi_list</span> (<span class="eKeyword">True</span>) <span class="eComment">-- Adds the MDI Window List to the bottom of the menu</span></pre>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<h2>Child Window Activation</h2>
		<p>If you want your parent form to be notified when a child window is activated by 
			the user, you can register an event-handling method for the <b>MdiChildActivate</b>
			event. You can determine which child window is active by using the <b>ActiveMdiChild</b>
			property of the <b>Form</b> class. For example, the following code updates a <b>StatusBar</b>
			control on the parent form with the name of the child window.</p>
		<pre>....
<br><span class="eFeature">add_mdi_child_activate</span> (<span class="eKeyword">create</span> {<span class="eClass">EVENT_HANDLER</span>}.<span class="eFeature">make</span> (<span class="eKeyword">Current</span>, $<span class="eFeature">mdi_child_activated</span>))
<br>....<br><span class="eFeature">mdi_child_activated</span> (sender: <span class="eClass">SYSTEM_OBJECT</span>; e: <span class="eClass">EVENT_ARGS</span>) is
<br>	do
<br>	&nbsp;&nbsp;&nbsp;&nbsp; status_bar.<span class="eFeature">set_text</span> (active_mdi_child.<span class="eFeature">get_text</span>)<br>	end<br>....</pre>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
	</body>
</html>
