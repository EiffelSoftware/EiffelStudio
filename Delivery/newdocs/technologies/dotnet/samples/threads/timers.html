<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML XMLNS:MSHelp="http://msdn.microsoft.com/mshelp"><HEAD>
		<TITLE>Threads Timers Sample</TITLE>
	<XML>
		<MSHelp:Keyword Index="K" Term="Threads Timers" />
		<MSHelp:Keyword Index="K" Term="Samples, Threads Timers" />
		<MSHelp:Attr Name="Product" Value="Eiffel"/>
		<MSHelp:Attr Name="Locale" Value="kbEnglish"/>
	</XML>
		<LINK HREF="../../../../default.css" TYPE="text/css" REL="STYLESHEET"></HEAD>
	<BODY LANGUAGE="vbscript" ONLOAD="onLoadHandler">
		<TABLE CLASS="HEADER">
			<TR>
				<TD CLASS="HEADER">Eiffel ENViSioN!</TD>
				<TD></TD>
			</TR>
			<TR>
				<TD CLASS="SUBHEADER">Threads Timers Sample</TD>
				<TD ALIGN=right>
					<A CLASS="bold" HREF="#NONEXISTANT" OnClick="LoadSample()">Load in Eiffel ENViSioN! </A>
				</TD>
			</TR>
		</TABLE>
		<TABLE CLASS="FRAME">
			<TR>
				<TD>
					<SCRIPT LANGUAGE=VBScript>
						' Samples scripts, used to launch samples from documentation
						' (C) 2003-2004 Eiffel Software, All Rights Reserved.

						Option Explicit

						Dim SamplesPath
						Dim SampleDir
						Dim SamplePrj

						Sub LoadSample()
							Dim WshShell
							Dim Path
							Dim Quote
							Dim Is2003
							
							If Not IsEmpty (SampleDir) And Not IsEmpty (SamplePrj) Then
								Set WshShell = CreateObject ("WScript.Shell")
								Is2003 = CanLaunch2003()
								If Is2003 Then
									Path = WshShell.RegRead ("HKLM\SOFTWARE\Microsoft\VisualStudio\7.1\Setup\Eiffel\ProductDir")
								Else
									Path = WshShell.RegRead ("HKLM\SOFTWARE\Microsoft\VisualStudio\7.0\Setup\Eiffel\ProductDir")
								End If
								If Not IsEmpty (Path) Then
									If Is2003 Then
										SamplesPath = Path + "Compiler\Examples\v1.1.4322" + SampleDir + "\" + SamplePrj
										Path = WshShell.RegRead ("HKLM\SOFTWARE\Microsoft\VisualStudio\7.1\InstallDir")
									Else
										SamplesPath = Path + "Compiler\Examples\v1.0.3705" + SampleDir + "\" + SamplePrj
										Path = WshShell.RegRead ("HKLM\SOFTWARE\Microsoft\VisualStudio\7.0\InstallDir")
									End If
									If Not IsEmpty (Path) Then
										Quote = Chr(34)
										Path = Quote + Path + "Devenv.exe" + Quote + " " + Quote + SamplesPath + Quote
										WshShell.Run Path, 1, False 
									End If
								End If
							End If

						End Sub

						Function CanLaunch2003()
							Dim WshShell
							Dim Installed
								
							Set WshShell = CreateObject ("WScript.Shell")
							Installed = WshShell.RegRead ("HKLM\SOFTWARE\ISE\Eiffel ENViSioN! 2.0\Setup")
							CanLaunch2003 = (Installed = "2003")
						End Function
					</SCRIPT>
					<SCRIPT LANGUAGE=VBScript>
						Sub onLoadHandler()
							'Initialize global variables
							SampleDir = "\threading\timers"
							SamplePrj = "timers.eifp"
						End Sub							
					</SCRIPT>

					<p>This sample consists of a command line application which uses
					the <SPAN CLASS="eclass">TIMER</SPAN> class to generate a periodic callback
					to a method. The sample creates a <SPAN CLASS="eclass">TIMER</SPAN> object
					and passes to it a delegate object. When the <SPAN CLASS="eclass">TIMER</SPAN> fires, the
					delegate is invoked, and a static method is called asynchronously by a worker
					thread in the thread pool.</p>

					<h2>Running</h2>
					
					<P>After you launch the sample, the following output appears:</P>
					
					<CODE>
						Checking for status updates every two seconds<BR >
						&lt;Hit Enter to terminate the sample&gt;<BR >
						Checking Status.<BR >
						Checking Status.<BR >
						Checking Status.<BR >
						Checking Status.<BR >
						Checking Status.<BR >
						...
					</CODE>
					
					<P>After displaying these messages, the application waits for the
					return key to be pressed to terminate.</P>
					
					<h2>Under the Hood</h2>
					
					<p>This application shows how to use the class
					<SPAN CLASS="eclass">TIMER</SPAN>. The timer is launched as follows:</p>
					
					<code>
						<SPAN CLASS="ekeyword">create</SPAN> 
						<SPAN CLASS="elocal">my_timer</SPAN>.<SPAN CLASS="efeature">make</SPAN>
						(<SPAN CLASS="ekeyword">create</SPAN>
						{<SPAN CLASS="eclass">TIMER_CALLBACK</SPAN>}.<SPAN CLASS="efeature">make</SPAN>
						(<SPAN CLASS="ekeyword">Current</SPAN>,
						$<SPAN CLASS="efeature">check_status</SPAN>),
						<SPAN CLASS="ekeyword">Void</SPAN>, 0, 2000))
					</code>
						
					<P>The feature <SPAN CLASS="efeature">check_status</SPAN> is then called every
					2 seconds (2000 milliseconds) and displays the message
					<SPAN CLASS="estring">"Checking Status."</SPAN></P>
					
					<p>This sample uses the following classes: </p>
					<ul>
					<li>
					<SPAN CLASS="eclass">
					TIMER</SPAN>
					<li>
					<SPAN CLASS="eclass">
					TIMER_CALLBACK</SPAN></li>
					</ul>

					<p class="note"><b>Note</b>:
					This sample is translated from the example located in the
					Samples\Technologies\Threading\Timers subdirectory of the .NET Framework SDK
					samples directory of Microsoft Visual Studio .NET.</p>
				</TD>
			</TR>
		</TABLE>
		<TABLE CLASS="FOOTER">
			<TR>
				<TD>© 2003-2004 Eiffel Software. All rights reserved.</TD>
			</TR>
		</TABLE>
	</BODY>
</HTML>
