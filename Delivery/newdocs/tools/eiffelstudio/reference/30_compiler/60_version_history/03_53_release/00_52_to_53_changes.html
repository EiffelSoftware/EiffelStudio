<!DOCTYPE HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<HTML>
<HEAD>
<TITLE>Major changes between ISE Eiffel 5.2 and ISE Eiffel 5.3:</TITLE>
<LINK REL=StyleSheet HREF="../../../../../../default.css">
</HEAD>



<BODY>



<H1>Changes between ISE Eiffel 5.2 and ISE Eiffel 5.3:</H1>



<p>&nbsp;</p>



        <H2>What's new</H2>
        
        <ul>
          <li>Finalized executable with option `exception trace' enabled will 
          now display the instruction number (usually equivalent to the line 
          number in the routine) being executed when a failure occurred. It was 
          already displaying this information in workbench/melted mode, we have 
          just extended this feature to finalize mode.</li>
          <li>Incremental compilation is now available for .NET code generation. 
          Meaning that if you modify one class, only this class is being 
          recompiled. It dramatically improves development time when targeting 
          .NET.</li>
          <li>In .NET code generation, assertions can be turned on or off on a 
          class per class basis without having to recompile those classes.</li>
          <li>Implemented 
          <a href="../../../../../../libraries/base/content/10_kernel/index.html#Recoverable_storable">recoverable storable</a> to enable the retrieval of 
          slightly different version of an object. It only applies for classic 
          Eiffel.</li>
</ul>
        
        <H2>Improvements</H2>
        
        
        <ul>
          <li>Enabled support for Borland C compiler in .NET.</li>
          <li>Removed too many warnings during C compilation on Tru64.</li>
          <li>Improved formatting of exception traces so that class names, 
          feature names, exception tags are not truncated. Display limit has 
          been pushed at about 256 characters.</li>
</ul>
        
        
        <h2>Changes</h2>
        
        
        <ul>
          <li>Made `\\' follow the balancing rules for various integer types.</li>
          <li>Precompiled libraries now precompiles all classes reachable from 
          clusters defined in project settings only if root class is ANY, 
          otherwise it will only precompile classes reachable from the root 
          class. In 5.1 and prior version it was precompiling all classes 
          reachable from clusters.</li>
</ul>
        
        
        <h2>Bug fixes</h2>
        
        
        <h3>Language issues</h3>
        
        
        <ul>
          <li>Fixed semantic of object creations to strictly follow definition 
          given in &quot;Eiffel: The Language&quot;. Namely, if you have x of 
          type <span class="eclass">X</span>:<br>
<pre><span class="ekeyword">create</span> x.<span class="efeature">make</span>	is equivalent to	x := <span class="ekeyword">create</span> {<span class="eclass">X</span>}.<span class="efeature">make</span></pre>          It implies 
          some bug fixes which might break existing code. For example:<pre>x: <span class="eclass">X</span> <span class="ekeyword">is</span>
	<span class="ekeyword">once</span>
			<span class="ecomment">-- If </span><span class="efeature">make</span><span class="ecomment"> calls back to x then it used to return</span>
			<span class="ecomment">-- a non-Void value for x, where it should have been Void.</span>
		<span class="ekeyword">create</span> Result.<span class="efeature">make</span>
	<span class="ekeyword">end</span>

x: <span class="eclass">X</span>
	<span class="ecomment">-- If </span><span class="efeature">make </span><span class="ecomment">accesses back the x attribute then it used to return</span>
	<span class="ecomment">-- new value of x rather than the old value.</span>
<span class="ekeyword">create</span> x.<span class="efeature">make</span></pre>
          Or in melted code only the following code now works 
          properly, i.e.  <span class="efeature">make</span> gets the old value of x, not the new one<br>
<pre><span class="ekeyword">create</span> x.<span class="efeature">make</span> (x)</pre>
          </li>
          <li>Fixed undetected <span class="eerror">VDRD(3)</span> errors: compiler was not strict enough and accepted 
          <span class="ekeyword">ensure</span> where only  
          <span class="ekeyword">ensure then</span> was valid.</li>
</ul>
        
        
        <h3>Store/Retrieve issues</h3>
        
        
        <ul>
          <li>Fixed issue in storable mechanism when retrieving expanded 
          objects.</li>
          <li>Fixed issue with independent_store where storing arrays of objects 
          whose count was greater than 65536 will cause a memory corruption.</li>
          <li>Added <span class="efeature">correct_mismatch</span> on <span class="eclass">HASH_TABLE</span> to enable retrieval of the 
          5.1 and older version of <span class="eclass">HASH_TABLE</span>.</li>
</ul>
        
        
        <h3>Runtime/code generation issues</h3>
        
        
        <ul>
          <li>Fixed incorrect C code generation in final mode when creating an 
          <span class="eclass">ARRAY</span> of expanded type.</li>
          <li>Fixed incorrect C code generation in final mode when creating a 
          complex object which contains expanded objects that have expanded 
          objects.</li>
          <li>Fixed random crash issue in finalized applications due to incorrect memory management when 
          you have code similar to:</li>
        <pre>	<span class="efeature">f</span> (g: <span class="eclass">STRING</span>): <span class="eclass">ANY</span> <span class="ekeyword">is</span>
		<span class="ekeyword">do</span>
			Result := <span class="ekeyword">create</span> {<span class="eclass">STRING</span>}.<span class="efeature">make_from_string</span> (g)
		<span class="ekeyword">end</span></pre>
          <li>Fixed issue with <span class="efeature">deep_equal</span> on <span class="eclass">ARRAY</span> of expanded types which was 
          returning <span class="ekeyword">False</span> where it should have returned <span class="ekeyword">True</span>.</li>
          <li>Fixed issue in melted code where computation such as <span class="eclass">INTEGER_X</span> // 
          <span class="eclass">INTEGER_Y</span> will either crash or give an incorrect computation where X 
          and Y represents integers that are either 8, 16, 32 or 64 bits long and X &lt; Y.</li>
          <li>Fixed incorrect C code generation of finalized code when your 
          project configuration includes a precompiled library and that you 
          cancel finalization process at degree -2, and then restart a 
          finalization.</li>
          <li>Fixed issue with incorrect C code generation of inspect 
          instruction based on character values above 128.</li>
          <li>Fixed compilation crash at degree 3 with following code:
          <pre>	<span class="ekeyword">local</span>
		i: <span class="eclass">INTEGER</span>
	<span class="ekeyword">do</span>
		i := &lt;&lt; 1 &gt;&gt; <span class="efeature">@</span> 2
	<span class="ekeyword">end</span></pre></li>
          <li>Fixed a crash in finalized mode with invariant checking enabled 
          with following code and when checking the invariant triggers a garbage 
          collection cycle:<br>
<pre>	<span class="efeature">value</span>: <span class="eclass">INTEGER</span>
	<span class="efeature">is_value_required</span>: <span class="eclass">BOOLEAN</span> <span class="ekeyword">is</span>
		<span class="ekeyword">do</span>
			Result := <span class="efeature">value</span> = 1
		<span class="ekeyword">end</span>
</pre></li>
          <li>Fixed crash of compiler at degree 4 while trying to compile this incorrect 
          class:<br>
<pre><span class="ekeyword">class</span> <span class="eclass">CRASH</span>

<span class="ekeyword">inherit</span>
	<span class="eclass">CHAIN</span>	<span class="ecomment">-- Missing generic parameter</span>

<span class="ekeyword">create</span>
	<span class="efeature">make</span>

<span class="ekeyword">feature</span> -- Initialization

	<span class="efeature">make</span> <span class="ekeyword">is</span>
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span>

	<span class="efeature">index</span>: <span class="eclass">INTEGER</span> <span class="ekeyword">is</span>
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span>

	<span class="efeature">duplicate</span> (n: <span class="eclass">INTEGER</span>): <span class="ekeyword">like Current is</span>
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span>

<span class="ekeyword">end</span></pre>
</li>
          <li>Fixed issue with pathological memory allocation scheme that could 
          trigger an `out of memory' exception where enough memory is still 
          available.</li>
          <li>Fixed incorrect allocation of expanded arrays where creation 
          routine of expanded class was not called on all items of the newly 
          created array.</li>
          <li>Fixed incorrect creation type of attribute where attribute's type 
          has some generic parameter. In some cases, instead of creating an 
          <span class="eclass">ARRAY [B2 [C]]</span> it would create an <span class="eclass">ARRAY [B2 [STRING]]</span>.</li>
</ul>
        
        
        <h3>.NET issues</h3>
        
        
        <ul>
          <li>Fixed issue in IL code generation where having a class that 
          inherits from a non-Eiffel .NET class. And the class has the following 
          features:<br>
          <pre>	<span class="efeature">a</span>: <span class="eclass">ARRAY</span> [<span class="ekeyword">like</span> <span class="efeature">f</span>]
          <span class="efeature">f</span>: <span class="eclass">STRING</span>  <span class="ekeyword">is</span>
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span></pre>
          Then you could neither load nor execute the generated code.</li>
          <li>Fixed incorrect C file naming when generating a .NET system that 
          uses a C++ external (it should be .cpp, not just .c).</li>
          <li>Fixed incorrect .NET code generation with following assignment 
          attempts whose source is expanded:
          <pre>	<span class="ekeyword">local</span>
		a: <span class="eclass">ANY</span>
		o: <span class="eclass">SYSTEM_OBJECT</span>
	<span class="ekeyword">do</span>
		a ?= 12
		o ?= 12
	<span class="ekeyword">end</span>          </pre></li>
          <li>Fixed incorrect code generation in .NET for assertions checking with following code where 
          precondition of <span class="efeature">test</span> will not be checked although it should:<br>
<pre>	<span class="efeature">make</span> <span class="ekeyword">is</span>
		<span class="ekeyword">do</span>
			<span class="efeature">test_which_fail_and_rescued</span>
			<span class="efeature">test</span>
		<span class="ekeyword">end</span>

	<span class="efeature">test</span> <span class="ekeyword">is</span>
		<span class="ekeyword">require</span>
			should_be_checked: False
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span>
	
	<span class="efeature">test_which_fail_and_rescued</span> <span class="ekeyword">is</span>
		<span class="ekeyword">local</span>
			retried: <span class="eclass">BOOLEAN</span>
		<span class="ekeyword">do</span>
			<span class="ekeyword">if not</span> retried <span class="ekeyword">then</span>
				<span class="efeature">failure</span>
			<span class="ekeyword">end</span>
		<span class="ekeyword">rescue</span>
			retried := true;
			retry
		<span class="ekeyword">end</span>

	<span class="efeature">failure</span> <span class="ekeyword">is</span>
		<span class="ekeyword">require</span>
			should_be_checked: False	
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span></pre></li>
          <li>Fixed .NET verification issue where sometimes you could get the 
          following message when checking an Eiffel assembly against peverify: 
          [IL]: Error: Unverifiable PE Header/native stub.</li>
          <li>Fixed incorrect code generation when creating and accessing a 
          <span class="eclass">NATIVE_ARRAY</span> of expanded type.</li>
          <li>Fixed incorrect metadata heap generation to use standard CLI 
          tables.</li>
</ul>
        
        
        </BODY>



</HTML>