indexing
	description: "Description of a DOS header for CLI"
	date: "$Date$"
	revision: "$Revision$"

class
	CLI_DOS_HEADER

inherit
	MEMORY
		redefine
			dispose
		end
		
feature -- Access
	
	size: INTEGER is 132
			-- Size of DOS Header structure in bytes.
		
	item: POINTER is
			-- Memory location containing DOS header.
		local
			l_header: like header
		do
			if internal_item = default_pointer then
				internal_item := internal_item.memory_alloc (size)
				l_header := header
				
				internal_item.memory_copy ($l_header, size)
			end
			Result := internal_item
		end
		
feature {NONE} -- Disposal

	internal_item: POINTER
			-- Store content of `header' in a C buffer.
			
	dispose is
			-- Free `internal_item' if allocated.
		do
			if internal_item /= default_pointer then
				internal_item.memory_free
			end
		end
		
feature {NONE} -- Implementation

	header: SPECIAL [INTEGER_8] is
			-- DOS Header content.
		local
			l_array: ARRAY [INTEGER_8]
		once
			l_array := <<
				0x4D, 0x5A, 0x90, 0x0, 0x3, 0x0, 0x0, 0x0,
				0x4, 0x0, 0x0, 0x0, 0xFF, 0xFF, 0x0, 0x0,
				0xB8, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
				0x40, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
				0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
				0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
				0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
				0x0, 0x0, 0x0, 0x0, 0x80, 0x0, 0x0, 0x0,
				0xE, 0x1F, 0xBA, 0xE, 0x0, 0xB4, 0x9, 0xCD,
				0x21, 0xB8, 0x1, 0x4C, 0xCD, 0x21, 0x54, 0x68,
				0x69, 0x73, 0x20, 0x70, 0x72, 0x6F, 0x67, 0x72,
				0x61, 0x6D, 0x20, 0x63, 0x61, 0x6E, 0x6E, 0x6F,
				0x74, 0x20, 0x62, 0x65, 0x20, 0x72, 0x75, 0x6E,
				0x20, 0x69, 0x6E, 0x20, 0x44, 0x4F, 0x53, 0x20,
				0x6D, 0x6F, 0x64, 0x65, 0x2E, 0xD, 0xD, 0xA,
				0x24, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
				0x50, 0x45, 0x0, 0x0
			>>
			Result := l_array.area
		end	

end -- class CLI_DOS_HEADER
