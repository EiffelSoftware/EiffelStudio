# wel_hook.dll - Makefile for Microsoft C

CC = cl.exe
CFLAGS = -nologo -D_WIN32_WINNT=0x200 -W1 -Ox -D_UNICODE -DUNICODE
LFLAGS = -DLL -SECTION:.shared,RWS \
		-EXPORT:MouseProc -EXPORT:hook_mouse -EXPORT:unhook_mouse -EXPORT:get_hook_window

.c.obj:
    $(CC) $(CFLAGS) -c $<

OBJS = wel_hook.obj
LIBS =  kernel32.lib user32.lib advapi32.lib

wel_hook.dll: $(OBJS)
	if exist $@ del $@
    link -NOLOGO $(LFLAGS) -OUT:$@ $(OBJS) $(LIBS)
    if not exist ..\spec\msc mkdir ..\spec\msc
	if not exist ..\spec\msc\$(ISE_PLATFORM) mkdir ..\spec\msc\$(ISE_PLATFORM)
	if not exist ..\spec\msc\$(ISE_PLATFORM)\dll mkdir ..\spec\msc\$(ISE_PLATFORM)\dll
	copy $@ ..\spec\msc\$(ISE_PLATFORM)\dll
	del $@
	del *.obj
	del wel_hook.lib
	del wel_hook.exp
