remtrace Check the status
iff not defined DOCUMENT_DIR then
	echo DOCUMENT_DIR is not defined. Cannot continue
	CANCEL
endiff
iff not isdir %DOCUMENT_DIR then
	echo %DOCUMENT_DIR is not a directory
	CANCEL
endiff
iff not isdir %INSTALL_DIR\docs then
	echo No destination directory for the documentation
	CANCEL
endiff

remtrace Compiling document.exe
cdd %EIFFEL_SRC
exprt -r %DEFAULT_CVS_TAG -d document Src/tools/document
cd %EIFFEL_SRC\document
clean_project
finalize Ace.ace
fff
cleanup_eiffel document.exe
iff not exist document.exe then
	remtrace Couldnt generate document.exe
	CANCEL
endiff
move document.exe %DOCUMENT_DIR

remtrace Retrieve the documentation
cdd %DOCUMENT_DIR
if isdir newdocs fullrd newdocs
if exist newdocs fullrf newdocs
exprt -r %DEFAULT_CVS_TAG -d newdocs Delivery/newdocs

remtrace Setup files
cd newdocs\technologies\dotnet\samples
sed -e "s/var eiffel_studio.*$/var eiffel_studio = true;/g" instal.js >> new_instal.js
move new_instal.js instal.js
cd %DOCUMENT_DIR\newdocs
copy default.css ..
fullrf internal\eiffel.hhc
copy internal\eiffel.hhp .
REM Just to make sure there is a stop words.stp file.
copy "internal\stop words.stp" .
copy "internal\stop_words.stp" .
copy stop_words.stp "stop words.stp"
copy ..\document.exe .
if exist general\guided_tour\studio\index-09A\goto.html fullrf general\guided_tour\studio\index-09A\goto.html
remtrace Call document.exe
document /g >>& %INSTALL_LOG
copy ..\default.css .
remtrace Compile the documentation (eiffel.chm)
hhc eiffel.hhp
iff not exist eiffel.chm then
	echo Could not generate the EiffelStudio help file
	CANCEL
endiff
move eiffel.chm %INSTALL_DIR\docs
	
remtrace Compile the Resource Bench help
cdd %DOCUMENT_DIR
if isdir rbdoc fullrd rbdoc
exprt -r %DEFAULT_CVS_TAG -d rbdoc Src/resource_bench/RB_documentation/docrb
cd rbdoc
copy ..\document.exe .
document /g
copy new_htmls\resource_bench.hhp .
hhc resource_bench.hhp
iff not exist resource_bench.chm then
	echo Could not generate the Resource Bench help file
	CANCEL
endiff
move resource_bench.chm %INSTALL_DIR\rb\bin


