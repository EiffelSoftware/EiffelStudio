<HTML>
	<HEAD>
		<TITLE>Compiling WEL for Unicode - Windows 95/98/Me</TITLE>
		<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	</HEAD>
	<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
	<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
	<LINK REL="STYLESHEET" HREF="default.css" CHARSET="ISO-8859-1" TYPE="text/css">
		<img src="power.gif" ALT="Eiffel Home Page" align="right" border="0" usemap="#eiffel" width="109" height="226"><map name="eiffel"><area shape="RECT" alt="Eiffel Home Page" coords="0,0,109,226" HREF="http://www.eiffel.com"><area shape="RECT" nohref coords="0,0,0,0"></map>
		<p class="book-title">
			<h1>Compiling WEL for Unicode - Windows 95/98/Me<br>
				Introduction</h1>
		<p class="nn-first">
			This documentation is provided for those wishing to compile their application 
			for Windows 95/98/Me with full Unicode support. Windows 95/98/Me uses code 
			pages (ANSI) while Windows NT/2000/XP uses Unicode. To provide Unicode support 
			for your Windows 95/98/Me Microsoft have developed a translation layer, the 
			Microsoft Layer for Unicode (MSLU), which provides a complete set of unicode 
			APIs.
			<h1>Compiling WEL for Unicode - Windows 95/98/Me<br>
				Introduction</h1>
		<p class="nn-first">
			The following step-by-step tutorial details how to get Unicode support for WEL 
			application using WIndows 95/98/Me.
			<ul>
				<h2 class="index">1 Download Microsoft Layer for Unicode</h2>
				<p class="nn-first">
					Download the Microsoft Layer for Unicode <a href="http://download.microsoft.com/download/platformsdk/Redist/1.0/W9XMe/EN-US/unicows.exe">
						here</a> This contains the unicows.dll. The other file needed to get MSLU 
					working, unicows.lib, can be found in the Microsoft Platform SDK.
					<h2 class="index">2 Compiling Your Application (Without MSLU)</h2>
				<p class="nn-first">
					Compile your application as normal.
					<h2 class="index">3 Add MSLU Support</h2>
				<p class="nn-first">
					Copy the unicows.dll and unicows.lib files into your project directory. Note 
					that the Microsoft Layer for Unicode does not automatically load from the 
					$(WINDOWS) or $(WINSYS) directories so do not put the files there.
					<h2 class="index">4 Change the Linker Options</h2>
				<p class="nn-first">
				Once MSLU support has been added you must modify the linker file generated by 
				Eiffel:
				<p class="nn-first"><img src="greenball.gif" alt="+" width="6" height="6"> Go to 
					your application's 'EIFGEN\W_code' directory and open the file called '<i>SystemName</i>.lnk, 
					where <i>'SystemName'</i>
				is the name of your system as specified in the .ace file, in your favourite 
				text editor.
				<p class="nn-first"><img src="greenball.gif" alt="+" width="6" height="6"> Add the 
					following at the <u>start</u>
				of the file:
				<p class="nn-first">
					/nodefaultlib:kernel32.lib /nodefaultlib:advapi32.lib /nodefaultlib:user32.lib
					<br>
					/nodefaultlib:gdi32.lib /nodefaultlib:shell32.lib /nodefaultlib:comdlg32.lib
					<br>
					/nodefaultlib:version.lib /nodefaultlib:mpr.lib /nodefaultlib:winmm.lib
					<br>
					/nodefaultlib:winspool.lib /nodefaultlib:vfw32.lib /nodefaultlib:secur32.lib
					<br>
				/nodefaultlib:oleacc.lib /nodefaultlib:oledlg.lib
				<p class="nn-first"><img src="greenball.gif" alt="+" width="6" height="6">
				Then add:
				<p class="nn-first">
				unicows.lib
				<p class="nn-first"><img src="greenball.gif" alt="+" width="6" height="6">
				Now, replace the line that looks like this:
				<p class="nn-first">
					USER32.lib WSOCK32.lib ADVAPI32.lib GDI32.lib SHELL32.lib
					<br>
					COMDLG32.lib UUID.lib OLE32.lib OLEAUT32.lib COMCTL32.lib
					<br>
				MPR.LIB IMM32.LIB
				<p class="nn-first"><img src="greenball.gif" alt="+" width="6" height="6">
				With this:
				<p class="nn-first">
					KERNEL32.lib ADVAPI32.lib USER32.lib GDI32.lib SHELL32.lib
					<br>
					COMDLG32.lib VERSION.lib MPR.LIB WINMM.lib WINSPOOL.lib
					<br>
					VFW32.lib OLEACC.lib OLEDLG.lib WSOCK32.lib UUID.lib OLE32.lib
					<br>
				OLEAUT32.lib COMCTL32.lib
				<p class="nn-first">
					A sample linker file can be seen <a href="./mslu.html">here</a> with each 
					step mark for your conveniance.
					<h2 class="index">5 Relink (With MSLU Support)</h2>
				<p class="nn-first">
					Now you must relink your application so that it knows to use the libraries you 
					just changed in the linker file. To do this run 'link <i>SystemName</i>.lnk', 
					where <i>'SystemName'</i> is the name of your system as specified in the .ace 
					file, from your 'EIFGEN\W_code' directory. Note that if you recompile the 
					application C code a new linker file will be generated and the modified version 
					will be overwritten.</p>
			</ul></HTML>
