<HTML>
	<HEAD>
		
<META NAME="generator" CONTENT="ISE EiffelStudio version 5.1.7">
		
<TITLE>ECOM_STGC Flat contracts</TITLE>
		
<LINK REL="stylesheet" HREF="/default.css" TYPE="text/css">

	</HEAD>

	<BODY>
<PRE><SPAN CLASS="ekeyword">indexing</SPAN>
	<SPAN CLASS="eitag">description</SPAN><SPAN CLASS="esymbol">:</SPAN> <SPAN CLASS="estring">"SToraGe Commit mode flags"</SPAN>
	<SPAN CLASS="eitag">status</SPAN><SPAN CLASS="esymbol">:</SPAN> <SPAN CLASS="estring">"See notice at end of class"</SPAN>
	<SPAN CLASS="eitag">date</SPAN><SPAN CLASS="esymbol">:</SPAN> <SPAN CLASS="estring">"$Date$"</SPAN>
	<SPAN CLASS="eitag">revision</SPAN><SPAN CLASS="esymbol">:</SPAN> <SPAN CLASS="estring">"$Revision$"</SPAN>

<SPAN CLASS="ekeyword">class</SPAN> <SPAN CLASS="ekeyword">interface</SPAN>
	<A CLASS="eclass" HREF="../../../com/reference/constants/ecom_stgc.html">ECOM_STGC</A>

<SPAN CLASS="ekeyword">feature</SPAN> <SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> Access</SPAN>

	<A NAME="f_is_valid_stgc"><A CLASS="efeature" HREF="../../../com/reference/constants/ecom_stgc.html#f_is_valid_stgc">is_valid_stgc</A> <SPAN CLASS="esymbol">(</SPAN><SPAN CLASS="elocal">stgc</SPAN><SPAN CLASS="esymbol">:</SPAN> <A CLASS="eclass" HREF="../../../base/reference/kernel/integer.html">INTEGER</A><SPAN CLASS="esymbol">)</SPAN><SPAN CLASS="esymbol">:</SPAN> <A CLASS="eclass" HREF="../../../base/reference/kernel/boolean.html">BOOLEAN</A>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> Is </SPAN><SPAN CLASS="equoted">stgc</SPAN><SPAN CLASS="ecomment"> a valid storage commit mode flag?</SPAN>
</A>
	<A NAME="f_stgc_dangerouslycommitmerelytodiskcache"><A CLASS="efeature" HREF="../../../com/reference/constants/ecom_stgc.html#f_stgc_dangerouslycommitmerelytodiskcache">stgc_dangerouslycommitmerelytodiskcache</A><SPAN CLASS="esymbol">:</SPAN> <A CLASS="eclass" HREF="../../../base/reference/kernel/integer.html">INTEGER</A>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> EOLE_STGC_DANGEROUSLYCOMMITMERELYTODISKCACHE commits the changes,</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> but does not save them to the disk cache.</SPAN>
</A>
	<A NAME="f_stgc_default"><A CLASS="efeature" HREF="../../../com/reference/constants/ecom_stgc.html#f_stgc_default">stgc_default</A><SPAN CLASS="esymbol">:</SPAN> <A CLASS="eclass" HREF="../../../base/reference/kernel/integer.html">INTEGER</A>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> OLE 2 default commit mode</SPAN>
</A>
	<A NAME="f_stgc_onlyifcurrent"><A CLASS="efeature" HREF="../../../com/reference/constants/ecom_stgc.html#f_stgc_onlyifcurrent">stgc_onlyifcurrent</A><SPAN CLASS="esymbol">:</SPAN> <A CLASS="eclass" HREF="../../../base/reference/kernel/integer.html">INTEGER</A>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> EOLE_STGC_ONLYIFCURRENT prevents multiple users of an IStorage</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> from overwriting the other's changes. EOLE_STGC_ONLYIFCURRENT</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> commits changes only if no one else has made changes since the</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> last time this user opened the IStorage or committed. If other</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> changes have been made, EOLE_STG_E_NOTCURRENT is returned.</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> If the caller chooses to overwrite the changes, IStorage.Commit</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> can be called with commit mode set to EOLE_STGC_DEFAULT.</SPAN>
</A>
	<A NAME="f_stgc_overwrite"><A CLASS="efeature" HREF="../../../com/reference/constants/ecom_stgc.html#f_stgc_overwrite">stgc_overwrite</A><SPAN CLASS="esymbol">:</SPAN> <A CLASS="eclass" HREF="../../../base/reference/kernel/integer.html">INTEGER</A>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> EOLE_STGC_OVERWRITE allows new data to overwrite the old data,</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> reducing space requirements. EOLE_STGC_OVERWRITE is not recommended</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> for usual operation, but it could be useful in the following</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> situations:</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> &nbsp;&nbsp;&nbsp;1. A commit was tried and EOLE_STG_E_MEDIUMFULL was returned.</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> &nbsp;&nbsp;&nbsp;2. The user has somehow specified a willingness to risk</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overwriting the old data.</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> &nbsp;&nbsp;&nbsp;3. A low-memory save sequence is being used to end up with a</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smaller file.</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> The commit operation obtains all the disk space it needs before</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> attempting to store the new data, whether or not EOLE_STGC_OVERWRITE</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> is specified. If space requirements prohibit the save, the old</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> data will be intact, including all uncommitted changes. However,</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> if the commit fails due to reasons other than lack of disk space</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> and EOLE_STGC_OVERWRITE was specified, it is possible that neither</SPAN>
			<SPAN CLASS="ecomment">--</SPAN><SPAN CLASS="ecomment"> the old nor the new version of the data will be intact.</SPAN>
</A>	
<SPAN CLASS="ekeyword">invariant</SPAN>

		<SPAN CLASS="ecomment">--</SPAN> <SPAN CLASS="ecomment">from </SPAN><A CLASS="eclass" HREF="../../../base/reference/kernel/any.html">ANY</A>
	<SPAN CLASS="etag">reflexive_equality</SPAN><SPAN CLASS="esymbol">:</SPAN> <A CLASS="efeature" HREF="../../../base/reference/kernel/any.html#f_standard_is_equal">standard_is_equal</A> <SPAN CLASS="esymbol">(</SPAN><SPAN CLASS="ereserved">Current</SPAN><SPAN CLASS="esymbol">)</SPAN>
	<SPAN CLASS="etag">reflexive_conformance</SPAN><SPAN CLASS="esymbol">:</SPAN> <A CLASS="efeature" HREF="../../../base/reference/kernel/any.html#f_conforms_to">conforms_to</A> <SPAN CLASS="esymbol">(</SPAN><SPAN CLASS="ereserved">Current</SPAN><SPAN CLASS="esymbol">)</SPAN>

<SPAN CLASS="ekeyword">end</SPAN> -- <SPAN CLASS="ecomment">class </SPAN>ECOM_STGC</PRE>

</BODY>

</HTML>

