<!DOCTYPE HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<HTML>
	<HEAD>
		<TITLE>Accessing a COM component</TITLE>
		<LINK REL=StyleSheet HREF="../../../../default.css">
		<META NAME = "MS-HKWD" CONTENT = "EiffelCOM">
		<META NAME = "MS-HKWD" CONTENT = "EiffelCOM Wizard">
		<META NAME = "MS-HKWD" CONTENT = "EiffelCOM Wizard, Guided Tour">
		<META NAME = "MS-HKWD" CONTENT = "EiffelCOM Wizard, Guided Tour, Accessing a COM component">
	</HEAD>

	<BODY>
<DIV>
<h1>Accessing a COM component</h1>
<A NAME="pgfId=375755">
</A>The third tutorial describes how to access a COM component and build
reusable library.
<h2>
<A NAME="pgfId=375836">
 </A>
 Step by step instructions</h2>
<ol>
  <li>
<A NAME="pgfId=375756">
 </A>
Launch the wizard</li>
  <li>
<A NAME="pgfId=375760">
 </A>
Choose <i> Create a new project from a COM definition</i> and click <i> Next</i></li>
  <li>
<A NAME="pgfId=375764">
 </A>
Click <i> Next</i> again</li>
  <li>
<A NAME="pgfId=375768">
 </A>
Click the top <i> Browse</i> button and open the file <i> $ISE_EIFFEL\examples\com\wizard\string_manipulator\string_manipulator.idl
</i> where <i> $ISE_EIFFEL</i> represents the path to your EIFFEL50 directory. You could also choose to open the type library (.tlb) that was generated by the wizard when
<a HREF="01_new_from_com.html" CLASS="XRef">Creating a new COM component.</a>
 in the destination folder of that first project.</li>
  <li>
<A NAME="pgfId=375783">
 </A>
Click the bottom <i> Browse</i> button and select the directory where you want to create the project (later referenced as destination folder). Choose
<i> $ISE_EIFFEL\examples\com\wizard\string_manipulator\client\generated</i> where <i> $ISE_EIFFEL</i> represents the path to your EIFFEL50 directory.</li>
  <li>
<A NAME="pgfId=375791">
 </A>
Click <i> Next</i></li>
  <li>
<A NAME="pgfId=375800">
 </A>
Click <i> Finish</i></li>
  <li>
<A NAME="pgfId=375795">
 </A>
Wait until the wizard is done.</li>
</ol>
<DIV>
<h2>
<A NAME="pgfId=375840">
 </A>
 First look at the generated code</h2>
  <a name="pgfId_375844"></a>At the and of the generation the
  wizard precompiles the generated code and open EiffelStudio on the
  precompilation project. Note: a precompilation project is read-only, you need
  to start another EiffelStudio to reuse the generated classes. The interesting
  classes are all related to the coclass proxy <span class="eclass">STRING_MANIPULATOR_PROXY</span>. The
  proxy is the Eiffel class that gives access to the component. Each feature on
  the proxy calls the corresponding interface function on the component. You can
  use the EiffelStudio opened by the wizard to browse through the generated
  classes and study the class hierarchy.
  <p>&nbsp;
</DIV>
<DIV>
<h2>
<A NAME="pgfId=375854">
 </A>
 Implementing a client</h2>
<A NAME="pgfId=375858"></A>
 To implement a client of the StringManipulator component open a new
 EiffelStudio. Create the project in <i>$ISE_EIFFEL\examples\com\wizard\string_manipulator\client</i>
 using the ace file found in that directory. Freeze and run the project. You are
 now accessing the previously built component and calling functions on its
 interfaces!. The class <span class="eclass">MY_STRING_MANIPULATOR</span> inherits from the
 generated<span class="eclass"> STRING_MANIPULATOR_PROXY</span> and redefines the feature <i>replace_substring_user_precondition</i>.
 The generated interfaces include contracts for each exposed function. You can
 redefine the <i>user_precondition</i> features to implement your own
 preconditions.
</DIV>
<DIV>
<h2>
<A NAME="pgfId=375995">
 </A>
Contracts</h2>
<A NAME="pgfId=375999">
 </A>
Contracts can be broken directly on the proxy in which case you will get a standard contract violation or in the server. If contracts are broken on the server then the exception will be forwarded by the EiffelCOM runtime to the client. The feature replace_substring_user_precondition in <span CLASS="eclass">
MY_STRING_MANIPULATOR </span>
includes the following commented line:
<p class="code">
<span CLASS="ecomment">
-- Result := True</span>
</p>
<A NAME="pgfId=376009">
 </A>
Un-comment this line by removing the preceding `<span CLASS="ecomment">
--</span>
' and comment out the rest of the feature. Now the contract of the <span CLASS="efeature">
<a href="../../../../libraries/base/reference/kernel/string.html#f_replace_substring">
replace_substring</a></span>
 feature is wrong and erroneous calls can be made. Quick melt the changes and run the client. Enter some invalid numbers in the fields used to call this feature. After you click Replace you will see an error message box warning you that a precondition was violated on the server side. This is how you can use contracts `over the wire'. The preconditions was violated in the server, this exception was caught by the EiffelCOM runtime and sent back to the client.
</DIV>

        <p class="seealso">See Also: <a href="01_new_from_com.html">Creating a new COM component</a>, 
        <a href="02_new_from_eiffel.html">Creating a new component from an
            Eiffel Project</a>.</p>
		<P>&nbsp;</P>

	</BODY>
</HTML>
