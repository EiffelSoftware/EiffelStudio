<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Xebra Tutorial </title>
<style type="text/css">
<!--
body,td,th {
	font-family: Geneva, Arial, Helvetica, sans-serif;
	font-size: 16px;
	color: #333333;
}
h1 {
	color: #000099;
}
h2 {
	color: #003399;
}
h3 {
	color: #0033FF;
}
.code {
	font-family: "Courier New", Courier, monospace;
	font-size: 17px;
	font-style: normal;
	font-weight: bold;
	color: #11AADD;
}
.path {
	font-family: "Courier New", Courier, monospace;
	font-size: 16px;
	font-style: normal;
	font-weight: italique;
	color: #3333FF;
}
.style1 {font-size: 16px; font-style: normal; color: #3333FF; font-family: "Courier New", Courier, monospace;}
-->
</style>
</head>

<body>
<h1>Xebra Tutorial</h1>
<h3>Notes</h3>
<p>Use Xebra revision 78995 for this tutorial.</p>
<p>This tutorial was tested with EiffelStudio 6.4.7.8600 (<span class="path">$ISE_EIFFEL</span>) and eiffel_src (<span class="path">$EIFFEL_SRC</span>) revision 78995.</p>
<p>The env vars <span class="path">$EIFFEL_SRC</span>, <span class="path">$ISE_EIFFEL</span>, <span class="path">$ISE_PLATFORM</span> and <span class="path">$ISE_LIBRARY</span> are expected to be set.</p>
<h2>Windows</h2>
<h3>Checkout Xebra</h3>
<ul><li>Define <span class="path">$XEBRA_DEV</span> and checkout xebra from <a href="https://svn.origo.ethz.ch/eiffelstudio/trunk/Src/framework/web/xebra/" class="path">https://svn.origo.ethz.ch/eiffelstudio/trunk/Src/framework/web/xebra/</a> to <span class="path">$XEBRA_DEV</span></li>
</ul>
<h3>Setup Apache</h3>
<ul>
  <li>Download apache httpd-2.2.11 windows binary  from <a href="http://httpd.apache.org/download.cgi">http://httpd.apache.org/download.cgi</a><br />
    <br />
  </li>
  <li>Install (Choose Custom Installation and install Build Headers and Libraries as well)<br />
    <br />
  </li>
  <li>Copy <a href="https://svn.origo.ethz.ch/eiffelstudio/trunk/Src/framework/web/xebra/c_projects/apache_mod_xebra_win/Debug/mod_xebra.so">mod_xebra.so</a> to your <span class="path">Apache2.2\modules</span> folder.<br />
    <br />
  </li>
  <li>Add the following lines to <span class="path">Apache2.2\conf\httpd.conf</span>:<br />
    <span class="code">LoadModule xebra_module modules/mod_xebra.so</span><br />
    <span class="code">AddHandler mod_xebra .xeb<br />
    XebraServer_port &quot;55000&quot;<br />
    XebraServer_host &quot;localhost&quot;</span><br />
  <span class="code">LogLevel debug</span></li>
</ul>
<ul>
  <li>(If apache is installed as a service, stop the service<br />
    Start apache: open a console, browse to  <span class="path">Apache2.2\bin</span> and run<br />
    <span class="code">httpd</span><br />
      <br />
      </li>
<li>Browse to <a href="http://localhost/test.xeb">http://localhost/test.xeb</a>.You should see the Fail Whale and a message saying &quot;Cannot connect to XebraServer. See apache error log.&quot;<br />
      <br />
      </li>
  <li>In order to be able to browse to the xebrawebapp or the demoapplication later you need to create the directory <span class="path">Apache2.2\htdocs\xebrawebapp</span> and <span class="path">Apache2.2\htdocs\demoapplication </span>respectively<span class="path">.</span>For the demoapp to display correctly copy the folder<span class="path"> xebra\websites\demoapplication\html\images</span> to  <span class="path">Apache2.2\htdocs\demoapplication\images</span>. Copy also the file <span class="path">xebra\websites\demoapplication\html\style.css </span>to <span class="path">Apache2.2\htdocs\demoapplication\</span>.</li>
</ul>
<h3>Compile the Xebra Translator</h3>
<ul>
  <li>Launch estudio  and open the project <span class="path">$XEBRA_DEV/eiffel_projects/xebra_translator/xebra_translator-voidunsafe.ecf</span><br />
      <br />
  </li>
  <li>Compile</li>
</ul>
<h3>Run the Xebra Server</h3>
<ul>
  <li>Open the file <span class="path">$XEBRA_DEV/eiffel_projects/xebra_server/config.ini </span>and adapt <span class="path">translator</span>, <span class="path">compiler</span>, and <span class="path">webapps_root</span> to your configuration.<br />
      <br />
  </li>
  <li>Launch estudio  and open the project <span class="path">$XEBRA_DEV/eiffel_projects/xebra_server/xebra_server-voidunsafe.ecf<br />
    <br />
  </span></li>
  <li>Go to the Exceptions Handling dialog and disable DEVELOPER_EXCEPTION.<br />
      <br />
  </li>
  <li>Open the Execution Parameters dialog and set <span class="path">config.ini -d 10</span> as argument.<br />
    <br />
  </li>
  <li>Compile and run<br />
      <br />
  </li>
  <li>Browse  to <a href="http://localhost/test.xeb">http://localhost/xebrawebapp/hello.xeb</a>. The server now translates, generates, compiles and finally runns the xebrawebpp application. </li>
</ul>
<h2>&nbsp;</h2>
<h2>Ubuntu 9.04</h2>
<h3>Checkout Xebra</h3>
<ul>
  <li>Define <span class="path">$XEBRA_DEV</span> and checkout xebra from <a href="https://svn.origo.ethz.ch/eiffelstudio/trunk/Src/framework/web/xebra/" class="path">https://svn.origo.ethz.ch/eiffelstudio/trunk/Src/framework/web/xebra/</a> to <span class="path">$XEBRA_DEV</span></li>
</ul>

<h3>Setup Apache </h3>
<p><strong>Note</strong>: Mod_xebra does currently not run with the apache distribution that comes with ubuntu. </p>

<ul>
  <li>  Download apache unix source httpd-2.2.11 from <span class="path"><a href="http://httpd.apache.org/download.cgi">http://httpd.apache.org/download.cgi</a></span><a href="http://httpd.apache.org/download.cgi"><br />
    <br />
  </a>
  <li> Extract <br />
    <br />
  </li>
  <li>    Define <span class="path">$APACHE2 </span>where you want to install apache to, e.g. to <span class="path">/home/apache2</span><br />
    Run the following commands:<br />
    <span class="code">CFLAGS=&quot;-ggdb&quot; ./configure --prefix=/home/apache2</span><br />
    <span class="code"><strong>make</strong><br />
  <strong>make install</strong></span><br />
  (see <a href="http://httpd.apache.org/docs/2.2/install.html">here</a> for more info about installation)
  <br />
  <br />
  </li>
  <li> Compile the module by running<br />
    <span class="code"><strong>cd $XEBRA_DEV/c_projects/mod_xebra</strong><br />
    <strong>$APACHE2/bin/apxs -c -Wc,-ggdb -I$ISE_EIFFEL/studio/spec/$ISE_PLATFORM/include mod_xebra.c mod_xebra.h</strong></span><br />
    <br />
  </li>
  <li> Install the module to apache by running<br />
    <span class="code">sudo <strong>$APACHE2/bin/</strong>apxs -i mod_xebra.la</span><br />
    <br />
  </li>
  <li> Add the following lines to <span class="path">$APACHE2/conf/httpd.conf</span>:<br />
    <span class="code">LoadModule xebra_module modules/mod_xebra.so</span><br />
    <span class="code">AddHandler mod_xebra .xeb<br />
    XebraServer_port &quot;55000&quot;<br />
  XebraServer_host &quot;localhost&quot;</span><br />
  <span class="code">LogLevel debug</span><br />
  <br />
  </li>
  <li> Restart apache (if necessary, you need to stop and start instead of restart)<br />
  <span class="code">sudo <strong>$APACHE2/bin/</strong>apachectl restart</span><br />
  (Make sure no other apache is running, e.g. run<br />
   <span class="code">sudo apache2ctl stop</span><br />
   )<br />
    <br />
  </li>
  <li>Browse to <a href="http://localhost/test.xeb">http://localhost/test.xeb</a>.You should see the Fail Whale and a message saying &quot;Cannot connect to XebraServer. See apache error log.&quot;<br />
      <br />
  </li>
  <li>In order to be able to browse to the xebrawebapp or the demoapplication later you need to create the directory  <span class="path">$APACHE2/htdocs/xebrawebapp</span> and <span class="path">$APACHE2/htdocs/demoapplication </span>respectively<span class="path">.</span>For the demoapp to display correctly copy the folder <span class="style1">$XEBRA_DEV/websites/demoapplic</span><span class="path">ation/html/images</span> to <span class="path">$APACHE2/</span><span class="path">htdocs/demoapplication/images</span>. Copy also the file <span class="style1">$XEBRA_DEV/websites/demoapplication/html/</span><span class="path">style.css </span>to <span class="path">$APACHE2/htdocs/demoapplication/</span>.<br />
    <span class="code">mkdir $APACHE2/htdocs/xebrawebapp<br />
    mkdir $APACHE2/htdocs/demoapplication</span><br />  
  <span class="code">cp -R $XEBRA_DEV/websites/demoapplication/html/images  $APACHE2/htdocs/demoapplication<br />
  cp $XEBRA_DEV/websites/demoapplication/html/style.css $APACHE2/htdocs/demoapplication</span><br />
    <br />
    <br />
  </li>
  <li> Hint: keep an eye on the apache error log<br />
    <span class="code">tail -f <strong>$APACHE2</strong>/logs/error_log</span></li>
</ul>
<h3>Compile the Xebra Translator</h3>
<ul>
  <li>Launch estudio  and open the project <span class="path">$XEBRA_DEV/eiffel_projects/xebra_translator/xebra_translator-voidunsafe.ecf</span><br />
      <br />
  </li>
  <li>Compile</li>
</ul>
<h3>Run the Xebra Server</h3>
<ul><li>Open the file <span class="path">$XEBRA_DEV/eiffel_projects/xebra_server/config.ini </span>and adapt <span class="path">translator</span>, <span class="path">compiler</span>, and <span class="path">webapps_root</span> to your configuration.<br />
    <br />
    </li>
  <li>Open estudio in a terminal and open the project <span class="path">$XEBRA_DEV/eiffel_projects/xebra_server/xebra_server-voidunsafe.ecf<br />
    <br />
  </span></li>
  <li>Go to the Exceptions Handling dialog and disable DEVELOPER_EXCEPTION.<br />
      <br />
  </li>
  <li>Open the Execution Parameters dialog and set <span class="path">config.ini -d 10</span> as argument.<br />
    <br />
  </li>
  <li>Compile and Run<br />
    <br />
  </li>
  <li>Browse  to <a href="http://localhost/test.xeb">http://localhost/xebrawebapp/hello.xeb</a>. The server now translates, generates, compiles and finally runns the application. </li>
</ul>
<h2>&nbsp;</h2>
</body>
</html>
