<document title="Raw metrics and selection criteria" output="studio">
	<meta_data>
		<help>
			<meta>
				<meta_content>Metric,raw metrics</meta_content>
				<name>MS-HKWD</name>
			</meta>
			<meta>
				<meta_content>Metric,selection criteria</meta_content>
				<name>MS-HKWD</name>
			</meta>
		</help>
	</meta_data>
	<paragraph>
		<paragraph>Elementary metrics measure patterns whose occurrences (in a product or process) can be counted. We need to decompose this notion further to avoid an explosion of the number of elementary metrics. For example the features of a class can be classified along several lines:</paragraph>
		<list ordered="false">
			<item>
				<paragraph>Some are attributes (object fields), others are routines(algorithms).</paragraph>
			</item>
			<item>
				<paragraph>Some are inherited from a parent, others immediate (defined in the class).</paragraph>
			</item>
			<item>
				<paragraph>Some are exported, others secret</paragraph>
			</item>
		</list>
		<paragraph>and so on. Many combinations of these properties may be worth counting on their own: you may ask for the number of secret attributes, of exported inherited features and so on. But if we define all of these metrics independently, we will soon have too many elementary metrics, while still failing to satisfy user needs if we have omitted a particular combination.</paragraph>
		<paragraph>To avoid this we must identify a subset of elementary metrics as 
			<bold>raw metrics</bold>: metrics whose results are counted directly. "Number of features in a class" is a raw metric. From a raw metric, we may then derive other elementary metrics by applying 
			<bold>selection criteria</bold> such as "Is this feature an attribute?" or "Is this feature exported?" Here are the definitions:
		</paragraph>
		<note>
			<bold>Raw metric, selection criterion, derived metric:</bold>
			<line_break/>An elementary metric is either 
			<bold>raw</bold> or 
			<bold>derived</bold>. A 
			<bold>selection criterion</bold> for a raw metric is a property, with a fixed set of possible values (two or more), characterizing the patterns or events being counted by the metric.
			<line_break/> A 
			<bold>derived metric</bold> is an elementary metric defined from a raw metric by counting only the patterns satisfying a certain combination of its selection criteria.
		</note>
		<paragraph>The metric menu of the metric tool classifies raw and derivedmetric:</paragraph>
		<paragraph>
			<image>
				<url>/images/eiffelstudio/metrics_png/raw_derived.png</url>
				<border>0</border>
			</image>
		</paragraph>
		<paragraph>A set of raw metrics and selection criteria is provided by default by the metric tool, see 
			<link>
				<url>60_predefined_raw_metrics_selection_criteria.xml</url>
				<label>predefined raw metrics and selection criteria</label>
			</link>
		</paragraph>
		<paragraph>To define a derived metric, we start from a raw metric, for example "number of features", and combine some of the associated selection criteria. The combination may be:</paragraph>
		<list ordered="false">
			<item>
				<paragraph>An "or": for example, count all the features that are attributes or exported (or both).</paragraph>
			</item>
			<item>
				<paragraph>An "and": count all the features that are both attributes and exported.</paragraph>
			</item>
		</list>
		<paragraph>Our metric framework does not provide more general Boolean combinations, although they would be easy to add if necessary. Here is the interface provided to 
			<link>
				<url>/tools/eiffelstudio/how_to_s/70_analyzing_a_project/20_handling_new_metrics/10_defining_new_metrics/10_defining_derived_metrics.xml</url>
				<label>define derived</label>
			</link> metrics:
		</paragraph>
		<paragraph>
			<image>
				<url>/images/eiffelstudio/metrics_png/derived.png</url>
				<border>0</border>
			</image>
		</paragraph>
		<paragraph>A selection criterion may have more than two possible values. Most, as in these examples, have just two: a feature is either an attribute or a routine; it is either exported or secret.</paragraph>
		<paragraph>The definition states that every derived metric is derived from a certain raw metric. This provides only two levels of elementary metrics, raw and derived; you may not, from an existing derived metric, derive new ones, since you may only associate selection criteria with raw metrics.</paragraph>
		<paragraph>As a general guideline, we will try to keep the selection criteria for a given raw metric independent. For example, to distinguish the classes that inherit a given class we will use the following selection criteria:</paragraph>
		<list ordered="false">
			<item>
				<paragraph>Heirs: count the number of direct heirs of a class.</paragraph>
			</item>
			<item>
				<paragraph>Indirect_heirs: count the number of indirect heirs.</paragraph>
			</item>
			<item>
				<paragraph>Self: count only the class itself.</paragraph>
			</item>
		</list>
		<paragraph>Other interesting notions are "proper descendant", covering direct and indirect heirs, and "descendant", covering proper descendants and descendants. We do not introduce these as separate criteria, since this would result in a non-independent set of criteria: every proper descendant is a descendant, every heir(direct or indirect) is a proper descendant.</paragraph>
		<paragraph>Instead we limit ourselves to the three criteria listed above. If you need a finer decomposition, it is easy, with the techniques discussed below, to define Proper_descendants and Descendants as composite metrics expressed in terms of the elementary metricsHeirs, Indirect_heirs and Self.</paragraph>This criterion independence principle is not absolute, however, and in some cases we may find it clearer to define a new criterion even though its value is entirely determined by certain values of another. For example one criterion on features determines whether it is an attribute or a routine, another whether it is deferred or effective. An attribute is always effective, so the two criteria are not independent. Even though we could remove the dependency by using a single criterion with three values (attribute, effective routine, deferred routine), it is more convenient to keep two criteria. Of course the underlying counting mechanisms must make sure never to count an element twice even in an "or" query, as when a user asks for the number of features that are attributes or effective.
		<paragraph>A metric is either elementary or composite. An elementary metric is either a raw metric, such as "number of features", or a derived metric obtained from slicing a raw metric by selection criteria. Composite metrics are obtained from existing metrics (elementary, or previously defined composite metrics) by applying some mathematical formula. The three kinds of composite metrics shown on the figure will be explained shortly.</paragraph>
		<paragraph> </paragraph>
		<seealso>
			<bold>See Also</bold>
			<line_break/>
			<link>
				<url>40_elementary_composite_metrics.html#Elementary metric</url>
				<label>Elementary metrics</label>
			</link>
			<line_break/>
			<link>
				<url>/tools/eiffelstudio/how_to_s/70_analyzing_a_project/20_handling_new_metrics/10_defining_new_metrics/10_defining_derived_metrics.xml</url>
				<label>Defining derived metrics</label>
			</link>
		</seealso>
	</paragraph></document>