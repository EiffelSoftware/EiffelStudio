/*
 * Jmakefile for daemon (server)
 */

/* We need to have the shared archive, which is in TOP/shared. We have a
 * dependency which ensures it is up-to-date anyway.
 */

;# Files used to build the daemon
SRC = child.c listen.c main.c proto.c

;# Derived object file names
OBJ = \
|expand f!$(SRC)!
	!f:\.c=.o \
-expand \\

;# Where shared archive is located (path and name)
LIBDIR = ../shared
LIBNAME = libipc.a
LIBARCH = $(LIBDIR)/$(LIBNAME)
LIBRUN = ../../run-time
LIBIDR = ../../idrs
LIBIDRNAME = libidr.a
LIBIDRARCH = $(LIBIDR)/$(LIBIDRNAME)

/* The following are understood by jmake to alter built-in commands */
DPFLAGS = -I$(TOP) -I$(LIBDIR) -I$(LIBRUN) -I$(LIBIDR)
CFLAGS = $(DPFLAGS)
LDFLAGS = $(LIBARCH) $(LIBIDRARCH)

RemoteTargetDependency(ebench,$(LIBDIR),$(LIBNAME))
RemoteTargetDependency(ebench,$(LIBIDR),$(LIBIDRNAME))

DependTarget()
NormalProgramTarget(ebench,$(SRC),$(OBJ))
