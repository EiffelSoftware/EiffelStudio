<?xml version="1.0" encoding="us-ascii"?>
<document output="studio" title="Major changes between ISE Eiffel 5.5 and ISE Eiffel 5.6">
	<meta_data></meta_data>
	<paragraph>
		<heading>
			<size>2</size>What's new
		</heading>
		<list ordered="false">
			<item>Implemented once manifest strings. They can be used at the same places where normal manifest strings can be used, e.g.:
				<code_block><local_variable>s</local_variable> <symbol>:=</symbol> <keyword>once</keyword> <string>"abc"</string>
<feature_name>io</feature_name>.<feature_name>put_string</feature_name> (<keyword>once</keyword> <string>"Hello World!"</string>)</code_block>
				Once manifest strings are not created every time they are accessed. Instead one instance is created at the first access and then it is reused for subsequent accesses. In multithreaded application one instance is created for one thread.</item>
			<item>Supported aligned and non-aligned verbatim strings. Aligned verbatim strings use characters <code><character>[</character></code> and <code><character>]</character></code> in opening and closing sequence respectively, non-aligned verbatim strings use <code><character>{</character></code> and <code><character>}</character></code>.</item>
			<item>Added support for manifest type expression "{<class_name>MY_TYPE</class_name>}" which gives an instance of <feature_name>TYPE</feature_name> [<feature_name>MY_TYPE</feature_name>].</item>
			<item>New syntax for manifest constants, now they can be preceeded by a manifest type expression. For example <number>1</number> is of type <class_name>INTEGER</class_name>, whereas {<class_name>INTEGER_8</class_name>} 1 is of type <class_name>INTEGER_8</class_name>.</item>
			<item>Added type adaptation expression "{<class_name>MY_TYPE</class_name>} <feature_name>expr</feature_name>" which is of type <class_name>MY_TYPE</class_name>. This new type of expression is valid if and only if <feature_name>expr</feature_name> is compatible with <class_name>MY_TYPE</class_name> (i.e. conforms or converts to <class_name>MY_TYPE</class_name>.</item>
			<item>Support for <class_name>NATURAL_XX</class_name> types which are unsigned integers.</item>
		</list>
		<heading><size>2</size>Improvements</heading>
		<list ordered="false">
			<item>Optimized .NET code generated for <keyword>inspect</keyword> instruction.</item>
		</list>
		<heading>
			<size>2</size>Changes
		</heading>
		<list ordered="false">
			<item>Void does not conform to expanded types. As a consequence, assignments of Void to expanded entities will be rejected rather than throwing an exception at run-time. And comparison of expanded entities to Void will cause a <compiler_error>VWEQ</compiler_error> validity error.</item>
			<item>Changed default behavior of once routines in .NET  mode from once-per-process to once-per-thread to match behavior in classic mode.</item>
			<item>Provided project options (<code>old_verbatim_strings</code> and <code>old_verbatim_strings_warning</code>) to support semantics of verbatim strings as in previous versions when they were not left-aligned.</item>
			<item>Changed processing of hexadecimal integer literals to be consistent for different integer types. For example, <number>0xFF</number> gives <number>255</number> when assigned to a variable of type <class_name>INTEGER</class_name> rather than <number>-1</number> as before.</item>
			<item>Due to the new {} syntax, a few older syntax constructs have been removed:
				<list ordered="false">
					<item>"{<class_name>X</class_name>} <keyword>Precursor</keyword> (..)" is rejected and should be replaced by "<keyword>Precursor</keyword> {<class_name>X</class_name>} (...)".</item>
					<item>"<keyword>agent</keyword> <feature_name>f</feature_name> (?, {<class_name>A</class_name>})" is now rejected, as it would conflict with a manifest type expression, instead you should write "<keyword>agent</keyword> <feature_name>f </feature_name>(?, {<class_name>A</class_name>} ?)".</item>
				</list>
			</item>
			<item>In .NET, all usage of <class_name>INTEGER_8</class_name> from .NET libraries have been changed to <class_name>NATURAL_8</class_name>.</item>
		</list>
		<heading>
			<size>2</size>Bug fixes
		</heading>
		<heading>
			<size>3</size>Language issues
		</heading>
		<list ordered="false">
			<item>Used <character>'%N'</character> as an end of line in verbatim strings regardless of the end of line sequence in source code.</item>
			<item>Fixed incorrect handling of negative hexadecimal integer literals when sign before the literal was not taken into account. For example, <number>-0x1</number> could be interpreted as <number>1</number>.</item>
			<item>Implemented checks for input ranges of integer constants and fixed issue with inability to assign minimum integer values to variables of  the corresponding integer types.
				<table>
					<legend>Allowed integer values</legend>
					<row>
						<cell>Type</cell>
						<cell>Integer interval</cell>
						<cell>Unsigned hexadecimal representation</cell>
					</row>
					<row>
						<cell><class_name>INTEGER_8</class_name></cell>
						<cell><code><number>-128</number> <symbol>..</symbol> <number>127</number></code></cell>
						<cell><code><number>0x0</number> <symbol>..</symbol> <number>0xFF</number></code></cell>
					</row>
					<row>
						<cell><class_name>INTEGER_16</class_name></cell>
						<cell><code><number>-32768</number> <symbol>..</symbol> <number>32767</number></code></cell>
						<cell><code><number>0x0</number> <symbol>..</symbol> <number>0xFFFF</number></code></cell>
					</row>
					<row>
						<cell><class_name>INTEGER_32</class_name></cell>
						<cell><code><number>-2147483648</number> <symbol>..</symbol> <number>2147483647</number></code></cell>
						<cell><code><number>0x0</number> <symbol>..</symbol> <number>0xFFFFFFFF</number></code></cell>
					</row>
					<row>
						<cell><class_name>INTEGER_64</class_name></cell>
						<cell><code><number>-9223372036854775808</number> <symbol>..</symbol> <number>9223372036854775807</number></code></cell>
						<cell><code><number>0x0</number> <symbol>..</symbol> <number>0xFFFFFFFFFFFFFFFF</number></code></cell>
					</row>
				</table>
			</item>
			<item>Excluded nonsignificant leading zeroes from determination of allowed integer constant type, so that <code><number>00000000000000123</number></code> is now a valid <class_name>INTEGER_8</class_name> value.</item>
		</list>
		<heading>
			<size>3</size>Compiler issues
		</heading>
		<list ordered="false">
			<item>Fixed crash of the compiler at the very end of a finalization of a system which has an assignment of a manifest type into a variable of type <class_name>ARRAY</class_name> [<keyword>like</keyword> <feature_name>anchor</feature_name>] where<feature_name>anchor</feature_name> is a feature being redefined with a different type in a descendant class.</item>
			<item>Fixed an issue where compiler would report more than once the same error in an incremental recompilation.</item>
			<item>Fixed issue where changing a normal routine to an external and having a compile error, and then reverting back to a normal routine while fixing the error would cause the compiler to crash.</item>
			<item>Fixed some cases where project could be corrupted after a recompilation.</item>
			<item>Now compiler reports VTCT errors at the end of degree 5, rather than during degree 5, so that you can collect all the VTCT errors at once.</item>
			<item>Thanks to the improvement in VTCT errors reporting, now compiler will not generate an incorrect VTCT errors during an incremental recompilation for a class which has actually been removed from the system.</item>
		</list>
		<heading>
			<size>3</size>Runtime/code generation issues
		</heading>
		<list ordered="false">
			<item>Fixed bug in <feature_name>deep_twin</feature_name> from <class_name>ANY</class_name> in .NET which would cause a call on Void target when applied on object of type <class_name>STRING</class_name> and possibly other types.</item>
			<item>Corrected C code on Windows for constants of type <class_name>INTEGER_64</class_name>. Before constants of this type between <number>-2147483648</number> and <number>-1</number> could be processed as positive 64-bit values.</item>
			<item>Fixed incorrect C and IL code generation for <class_name>INTEGER_8</class_name> and <class_name>INTEGER_16</class_name> arithmetic and shift operations that might produce incorrect result when combined in two or more operations in a row. For example,
				<code_block><local_variable>i</local_variable> <symbol>:=</symbol> <symbol>(</symbol><local_variable>i</local_variable> <symbol>+</symbol> <local_variable>i</local_variable><symbol>)</symbol> <symbol>|&gt;&gt;</symbol> <number>1</number></code_block>
				assigned <number>-128</number> to <local_variable>i</local_variable> of type <class_name>INTEGER_8</class_name> if the initial value of <local_variable>i</local_variable> was <number>-128</number>. Now this instruction assigns <number>0</number>.</item>
		</list>
		<heading>
			<size>3</size>.NET issues
		</heading>
		<list ordered="false">
			<item>Corrected processing of literal floating point fields from external assemblies (such as <cluster_name>System</cluster_name><code><symbol>.</symbol></code><class_name>Math</class_name><code><symbol>.</symbol></code><feature_name>PI</feature_name>) to obtain proper values.</item>
			<item>Fixed a bug where the value -1 was actuall 255 on .NET.</item>
			<item>Fixed issue where declaring a <class_name>NATIVE_ARRAY</class_name> of a .NET expanded type would be rejected by the compiler.</item>
			<item>Fixed issue where assigning a .NET expanded type to an entity of type <class_name>ANY</class_name> would be rejected by the compiler.</item>
			<item>Fixed a crash in the compiler when generating the code for a class which inherits from a .NET class and from an Eiffel class which has some anchored types.</item>
			<item>Fixed a bug where calls to <feature_name>standard_is_equal</feature_name> from <class_name>ANY</class_name> on objects whose type is generic would yield <keyword>False</keyword> where it should have been <keyword>True</keyword> in classic Eiffel.</item>
		</list>
		<heading>
			<size>3</size>Store/Retrieve issues
		</heading>
		<list ordered="false">
			<item>Fixed an issue where the GC would be disabled after a failure in a retrieval operation.</item>
		</list>
	</paragraph>
</document>
