test_name 	 expanded-type-intrinsic-feature
test_description Intrinsic features generated by compiler should work for expanded type too.

copy_sub 	 Ace $TEST Ace

-- Test with explicit VALUE_TYPE parent (.NET only)
if DOTNET define EXPANDED_CLASS "expanded"
if DOTNET define EXPANDED_TYPE  ""
if DOTNET define VALUE_TYPE     "VALUE_TYPE"
if DOTNET copy_sub 	test.e  $CLUSTER test.e
if DOTNET copy_sub 	point.e $CLUSTER point.e

if DOTNET compile_melted
if DOTNET compile_result 	validity_error POINT VIFI(1); POINT VIFI(3)
if DOTNET abort_compile
-- if DOTNET compile_result 	validity_warning TEST Obsolete; TEST Obsolete; TEST Obsolete
-- if DOTNET execute_work	NONE exec_output_vt
-- if DOTNET execute_result	ok
-- if DOTNET compare		exec_output_vt output

-- Test without explicit VALUE_TYPE parent
define EXPANDED_CLASS "expanded"
define EXPANDED_TYPE  ""
define VALUE_TYPE     ""
copy_sub 	 test.e  $CLUSTER test.e
copy_sub 	 point.e $CLUSTER point.e

compile_melted
compile_result 	 validity_warning TEST Obsolete; TEST Obsolete; TEST Obsolete
execute_work	 NONE exec_output_nv
execute_result	 ok
compare		 exec_output_nv output_c

-- Test with expanded class type rather than with expanded class
define EXPANDED_CLASS ""
define EXPANDED_TYPE  "expanded"
define VALUE_TYPE     ""
copy_sub 	 test.e  $CLUSTER test.e
copy_sub 	 point.e $CLUSTER point.e

compile_melted
compile_result 	 validity_warning TEST Obsolete; TEST Obsolete; TEST Obsolete
execute_work	 NONE exec_output_ct
execute_result	 ok
compare		 exec_output_ct output_t

test_end
