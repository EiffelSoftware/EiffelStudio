/*
 * Jmakefile for app (application)
 */

/* We need to have the shared archive, which is in the shared/ dir. We have a
 * dependency which ensures it is up-to-date anyway.
 */

;# Files used to build the application
LIB = app_listen.c app_proto.c app_server.c

;# Derived object file names
OBJ = \
|expand f!$(LIB)!
	!f:\.c=.o \
-expand \\

;# Derived library object file names
LOBJ = \
|expand f!$(LIB)!
	!f:\.c=.o \
-expand \\

;# Where shared archive is located (path and name)
LIBDIR = ../shared
LIBRUN = ../../run-time
LIBIDR = ../../idrs
LIBIDRNAME = libidr.a
LIBNAME = libipc.a
LIBWKBENCH = libwkbench.a
LIBARCH = $(LIBDIR)/$(LIBNAME)
LIBIDRARCH = $(LIBIDR)/$(LIBIDRNAME)

/* The following are understood by jmake to alter built-in commands */
DPFLAGS = -I$(TOP) -I$(LIBDIR) -I$(LIBRUN) -I$(LIBIDR)
CFLAGS = $(DPFLAGS) -DWORKBENCH
;#LDFLAGS = $(LIBARCH)
LDFLAGS = $(LIBDIR)/$(LIBNAME)

DependTarget()
AllTarget($(OBJ))
++SOURCES $(LIB)

NormalLibraryObjectRule()
RemoteTargetDependency(network.o,$(LIBDIR),$(LIBNAME))
RemoteTargetDependency(network.o,$(LIBIDR),$(LIBIDRNAME))
PrelinkedRelocatableTarget(network,$(LOBJ),$(LIBARCH) $(LIBIDRARCH))

