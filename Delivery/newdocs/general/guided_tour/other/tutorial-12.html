<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="tour.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE> 11  AGENTS</TITLE>
</HEAD>
<!--------------------------------------------------->
<SCRIPT LANGUAGE="Javascript">
	// Default values
	var oNewWindow = 0;

	function ImageClick( oImage )
	{
		if( oNewWindow == 0 || oNewWindow.closed )
		{
			oNewWindow = window.open (oImage.src,"", "status=no, toolbar=no, menubar=no, location=no, resizable=yes");
		}
		else
		{
			oNewWindow.location = oImage.src;
		}
	}
</SCRIPT>
<!--------------------------------------------------->
<body bgcolor="#faf0e6">
<DIV>
<p class="top" align="center"><a href="http://www.eiffel.com">Eiffel Home Page (Web)</a> -- <a href="../index.html">Getting started with Eiffel (local)</a>

<img src="power.gif" ALT="Eiffel Home Page" align="right" border="0"  usemap="#eiffel"><map name="eiffel"><area shape="RECT" alt="Eiffel Home Page" coords="0,0,109,226" HREF="http://www.eiffel.com"><area shape="default" nohref></map>

<p class="top" ALIGN="left"><IMG SRC="normaldoc.gif" ALT="Previous, Up, Next" BORDER="0" WIDTH="300" HEIGHT="40" USEMAP="#navigation"><map name="navigation"><AREA SHAPE="RECT" alt="Previous section" COORDS="0,0,95,40" HREF="tutorial-11.html"><AREA SHAPE="RECT" alt="Up" COORDS="96,0,199,40" HREF="tutorial.html"><AREA SHAPE="RECT" alt="Next section" COORDS="200,0,300,40" HREF="tutorial-13.html"><area shape="default" nohref></MAP>
</DIV>
<H1 CLASS="aa-sec2">
<A NAME="pgfId-555122"></A>11  AGENTS</H1>
<P CLASS="nn-first">
<A NAME="pgfId-555123"></A>Our last mechanism, agents, adds one final level of expressive power to the framework describe so far. Agents apply object-oriented concepts to the modeling of <SPAN CLASS="ff-italics">
operations</SPAN>
.
<DIV>
<H2 CLASS="aa-sec3">
<A NAME="pgfId-555124"></A>Objects for operations</H2>
<P CLASS="nn-first">
<A NAME="pgfId-555125"></A>Operations are not objects; in fact, object technology starts from the decision to separate these two aspects, and to choose object types, rather than the operations, as the basis for modular organization of a system, attaching each operation to the resulting modules -- the classes.
<P CLASS="nn-normal">
<A NAME="pgfId-555126"></A>In a number of applications, however, we may need objects that <SPAN CLASS="ff-italics">
represent</SPAN>
 operations, so that we can include them in object structures that some other piece of the software will later traverse to uncover the operations and, usually, execute them. Such &quot;operation wrapper&quot; objects, called agents, are useful in a number of application areas such as:
<UL>
<p class="nn-first"><img src="greenball.gif" alt="+">
<A NAME="pgfId-555127"></A>GUI (Graphical User Interface) programming, where we may associate an agent with a certain event of the interface, such as a mouse click at a certain place on the screen, to prescribe that if the event occurs -- a user clicks there -- it must cause execution of the agent's associated operation.
<p class="nn-first"><img src="greenball.gif" alt="+">
<A NAME="pgfId-555128"></A>Iteration on data structures, where we may define a general-purpose routine that can apply an arbitrary operation to all the elements of a structure such as a list; to specify a particular operation to iterate, we will pass to the iteration mechanism an agent representing that operation.
<p class="nn-first"><img src="greenball.gif" alt="+">
<A NAME="pgfId-555129"></A>Numerical computation, where we may define a routine that computes the integral of any applicable function on any applicable interval; to represent that function and pass its representation to the integration routine, we will use an agent.
</UL>
<P CLASS="nn-first">
<A NAME="pgfId-555130"></A>Operations in Eiffel are expressed as routines, and indeed every agent will have an associated routine. Remember, however, that the fundamental distinction between objects and operations remains: an agent is an object, and it is not a routine; it <SPAN CLASS="ff-italics">
represents</SPAN>
 a routine. As further evidence that this is a proper data abstraction, note that the procedure <SPAN CLASS="ee-text">
call</SPAN>
, available on all agents to call the associated routine, is only one of the features of agents. Other features may denote properties such as the class to which the routine belongs, its precondition and postcondition, the result of the last call for a function, the number of arguments.
</DIV>
<DIV>
<H2 CLASS="aa-sec3">
<A NAME="pgfId-555131"></A>Building an agent</H2>
<P CLASS="nn-first">
<A NAME="pgfId-555135"></A>In the simplest form, also one of the most common, you obtain an agent just by writing
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555134"></A><SPAN CLASS="ee-keyword">
agent </SPAN>
<SPAN CLASS="ee-text">
r</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555136"></A>where <SPAN CLASS="ee-text">
r</SPAN>
 is the name of a routine of the enclosing class. This is an expression, which you may assign to a writable entity, or pass as argument to a routine. Here for example is how you will specify event handling in the style of the EiffelVision 2 GUI library:
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555139"></A>your_icon<SPAN CLASS="ee-keyword">
.</SPAN>
 click_actions<SPAN CLASS="ee-keyword">
.</SPAN>
extend <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
agent</SPAN>
 your_routine<SPAN CLASS="ee-comment">
)</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555412"></A>This adds to the end of my_icon<SPAN CLASS="ee-keyword">
.</SPAN>
 click_actions -- the list of agents associated with the &quot;click&quot; event for <SPAN CLASS="ee-text">
my_icon</SPAN>
, denoting an icon in the application's user interface -- an agent representing <SPAN CLASS="ee-text">
your_routine</SPAN>
. Then when a user clicks on the associated icon at execution, the EiffelVision 2 mechanisms will call the procedure <SPAN CLASS="ee-text">
call</SPAN>
 on every agent of the list, which for this agent will execute <SPAN CLASS="ee-text">
your_routine</SPAN>
. This is a simple way to associate elements of your application, more precisely its &quot;business model&quot; (the processing that you have defined, directly connected to the application's business domain), with elements of its GUI.
<P CLASS="nn-normal">
<A NAME="pgfId-555414"></A>Similarly although in a completely different area, you may request the integration of a function <SPAN CLASS="ee-text">
your_function </SPAN>
over the interval <SPAN CLASS="ee-comment">
0 </SPAN>
<SPAN CLASS="ee-dot">
..</SPAN>
<SPAN CLASS="ee-comment">
1</SPAN>
through a call such as
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555417"></A>your_integrator<SPAN CLASS="ee-keyword">
.</SPAN>
integral <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
agent</SPAN>
 your_function<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-text">
0</SPAN>
<SPAN CLASS="ee-comment">
,</SPAN>
<SPAN CLASS="ee-text">
 1</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555148"></A>In the third example area cited above, you may call an iterator of EiffelBase through
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555147"></A>your_list<SPAN CLASS="ee-keyword">
.</SPAN>
do_all <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
agent</SPAN>
 your_proc<SPAN CLASS="ee-comment">
)</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555149"></A>with <SPAN CLASS="ee-text">
your_list</SPAN>
 of a type such as <SPAN CLASS="ee-text">
LIST </SPAN>
<SPAN CLASS="ee-comment">
[</SPAN>
<SPAN CLASS="ee-text">
YOUR_TYPE</SPAN>
<SPAN CLASS="ee-comment">
]</SPAN>
. This will apply <SPAN CLASS="ee-text">
your_proc</SPAN>
 to every element of the list in turn.
<P CLASS="nn-normal">
<A NAME="pgfId-555150"></A>The agent mechanism is type-checked like the rest of Eiffel; so the last example is valid if and only if <SPAN CLASS="ee-text">
your_proc</SPAN>
 is a procedure with one argument of type <SPAN CLASS="ee-text">
YOUR_TYPE</SPAN>
.
</DIV>
<DIV>
<H2 CLASS="aa-sec3">
<A NAME="pgfId-555151"></A>Operations on agents</H2>
<P CLASS="nn-first">
<A NAME="pgfId-555152"></A>An agent <SPAN CLASS="ee-keyword">
agent </SPAN>
<SPAN CLASS="ee-text">
r </SPAN>
built from a procedure <SPAN CLASS="ee-text">
r </SPAN>
is of type <SPAN CLASS="ee-text">
PROCEDURE </SPAN>
<SPAN CLASS="ee-comment">
[</SPAN>
<SPAN CLASS="ee-text">
T, ARGS</SPAN>
<SPAN CLASS="ee-comment">
]</SPAN>
 where<SPAN CLASS="ee-text">
T</SPAN>
 represents the class to which <SPAN CLASS="ee-text">
r</SPAN>
 belongs and <SPAN CLASS="ee-text">
ARGS</SPAN>
 the type of its arguments. If <SPAN CLASS="ee-text">
r </SPAN>
is a function of result type <SPAN CLASS="ee-text">
RES</SPAN>
, the type is <SPAN CLASS="ee-text">
FUNCTION </SPAN>
<SPAN CLASS="ee-comment">
[</SPAN>
<SPAN CLASS="ee-text">
T, ARGS</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-text">
RES</SPAN>
<SPAN CLASS="ee-comment">
]</SPAN>
. Classes <SPAN CLASS="ee-text">
PROCEDURE</SPAN>
 and <SPAN CLASS="ee-text">
FUNCTION</SPAN>
 are from the Kernel Library of EiffelBase, both inheriting from <SPAN CLASS="ee-text">
ROUTINE </SPAN>
<SPAN CLASS="ee-comment">
[</SPAN>
<SPAN CLASS="ee-text">
T, ARGS</SPAN>
<SPAN CLASS="ee-comment">
]</SPAN>
.
<P CLASS="nn-normal">
<A NAME="pgfId-555153"></A>Among the features of <SPAN CLASS="ee-text">
ROUTINE</SPAN>
 and its descendants the most important are <SPAN CLASS="ee-text">
call</SPAN>
, already noted, which calls the associated routine, and <SPAN CLASS="ee-text">
item</SPAN>
, appearing only in <SPAN CLASS="ee-text">
FUNCTION</SPAN>
 and yielding the result of the associated function, which it obtains by calling <SPAN CLASS="ee-text">
call</SPAN>
.
<P CLASS="nn-normal">
<A NAME="pgfId-555426"></A>As an example of using these mechanisms, here is how the function <SPAN CLASS="ee-text">
integral</SPAN>
 could look like in our <SPAN CLASS="ee-text">
INTEGRATOR </SPAN>
example class. The details of the integration algorithm (straightforward, and making no claims to numerical sophistication) do not matter, but you see, in the highlighted line, the place were we evaluate the mathematical function associated with <SPAN CLASS="ee-text">
f</SPAN>
, by calling <SPAN CLASS="ee-text">
item</SPAN>
 on <SPAN CLASS="ee-text">
f</SPAN>
:
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555429"></A>integral
<P CLASS="ee-text">
<A NAME="pgfId-555430"></A>&nbsp;&nbsp;&nbsp;&nbsp;( f: FUNCTION [ANY, TUPLE [REAL], REAL];
<P CLASS="ee-text">
<A NAME="pgfId-555431"></A>&nbsp;&nbsp;&nbsp;&nbsp;low, high: REAL): REAL <SPAN CLASS="ee-keyword">
is</SPAN>

<P CLASS="ee-comment">
<A NAME="pgfId-555432"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Integral of <SPAN CLASS="ee-text">
f</SPAN>
 over the interval [<SPAN CLASS="ee-text">
low</SPAN>
, <SPAN CLASS="ee-text">
high</SPAN>
]
<P CLASS="ee-text">
<A NAME="pgfId-555433"></A>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="ee-keyword">
require</SPAN>

<P CLASS="ee-text">
<A NAME="pgfId-555434"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;meaningful_interval: low &lt;= high
<P CLASS="ee-text">
<A NAME="pgfId-555435"></A>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="ee-keyword">
local</SPAN>

<P CLASS="ee-text">
<A NAME="pgfId-555436"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x: REAL
<P CLASS="ee-text">
<A NAME="pgfId-555437"></A>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="ee-keyword">
do</SPAN>

<P CLASS="ee-text">
<A NAME="pgfId-555438"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="ee-keyword">
from</SPAN>

<P CLASS="ee-text">
<A NAME="pgfId-555439"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x := low
<P CLASS="ee-text">
<A NAME="pgfId-555440"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="ee-keyword">
invariant</SPAN>

<P CLASS="ee-text">
<A NAME="pgfId-555441"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x &gt;= low ; x &lt;= high + step
<P CLASS="ee-text">
<A NAME="pgfId-555442"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <SPAN CLASS="ee-text">
Result</SPAN>
 approximates the integral over
<P CLASS="ee-text">
<A NAME="pgfId-555443"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- the interval [<SPAN CLASS="ee-text">
low</SPAN>
, <SPAN CLASS="ee-text">
low</SPAN>
<SPAN CLASS="ee-dot">
.</SPAN>
<SPAN CLASS="ee-text">
max</SPAN>
 (<SPAN CLASS="ee-text">
x</SPAN>
 - <SPAN CLASS="ee-text">
step</SPAN>
)]
<P CLASS="ee-text">
<A NAME="pgfId-555444"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="ee-keyword">
until</SPAN>
 x &gt; high <SPAN CLASS="ee-keyword">
loop</SPAN>

<P CLASS="ee-text">
<A NAME="pgfId-555452"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result := Result + step  &#8727; <MAP NAME="tutorial-15">
</MAP>
<p>
<ul>
<IMG SRC="tutorial-15.png" USEMAP="#tutorial-15" ALIGN="BASELINE">
</ul>
<p>
 
<P CLASS="ee-text">
<A NAME="pgfId-555453"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x := x + step
<P CLASS="ee-text">
<A NAME="pgfId-555454"></A><SPAN CLASS="ee-keyword">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</SPAN>

<P CLASS="ee-text">
<A NAME="pgfId-555455"></A><SPAN CLASS="ee-keyword">
&nbsp;&nbsp;&nbsp;&nbsp;end</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555457"></A>Function <SPAN CLASS="ee-text">
integral</SPAN>
 takes three arguments: the agent <SPAN CLASS="ee-text">
f </SPAN>
representing the function to be integrated, and the two interval bounds. When we need to evaluate that function for the value <SPAN CLASS="ee-text">
x</SPAN>
, in the line
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555467"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result := Result + step  &#8727; <MAP NAME="tutorial-16">
</MAP>
<p>
<ul>
<IMG SRC="tutorial-16.png" USEMAP="#tutorial-16" ALIGN="BASELINE">
</ul>
<p>
 
</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555196"></A>we don't directly pass <SPAN CLASS="ee-text">
x </SPAN>
to <SPAN CLASS="ee-text">
item</SPAN>
; instead, we pass a one-element tuple <SPAN CLASS="ee-comment">
[</SPAN>
<SPAN CLASS="ee-text">
x</SPAN>
<SPAN CLASS="ee-comment">
]</SPAN>
, using the syntax for manifest tuples introduced in <A HREF="tutorial-11.html#36752" CLASS="XRef"><SPAN CLASS="ww-crossref">
&quot;Tuple types&quot;,  page 90</SPAN>
</A>. You will always use tuples for the argument to <SPAN CLASS="ee-text">
call</SPAN>
 and <SPAN CLASS="ee-text">
item</SPAN>
, because these features must be applicable to <SPAN CLASS="ff-italics">
any</SPAN>
 routine, and so cannot rely on a fixed number of arguments. Instead they take a single tuple intended to contain all the arguments. This property is reflected in the type of the second actual generic parameter to <SPAN CLASS="ee-text">
f</SPAN>
, corresponding to <SPAN CLASS="ee-text">
ARGS</SPAN>
 (the formal generic parameter of <SPAN CLASS="ee-text">
FUNCTION</SPAN>
): here it's TUPLE [REAL] to require an argument such as <SPAN CLASS="ee-comment">
[</SPAN>
<SPAN CLASS="ee-text">
x</SPAN>
<SPAN CLASS="ee-comment">
]</SPAN>
, where <SPAN CLASS="ee-text">
x</SPAN>
 is of type <SPAN CLASS="ee-text">
REAL</SPAN>
.
<P CLASS="nn-normal">
<A NAME="pgfId-555485"></A>Similarly, consider the agent that the call seen above:
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555484"></A>your_icon<SPAN CLASS="ee-keyword">
.</SPAN>
 click_actions<SPAN CLASS="ee-keyword">
.</SPAN>
extend <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
agent</SPAN>
 your_routine<SPAN CLASS="ee-comment">
)</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555486"></A>added to an EiffelVision list. When the EiffelVision mechanism detects a mouse click event, it will apply to each element <SPAN CLASS="ee-text">
item </SPAN>
of the list of agents, your_icon<SPAN CLASS="ee-keyword">
.</SPAN>
 click_actions, an instruction such as
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555489"></A>item<SPAN CLASS="ee-dot">
.</SPAN>
<SPAN CLASS="ee-text">
call </SPAN>
<SPAN CLASS="ee-comment">
([</SPAN>
<SPAN CLASS="ee-text">
x, y</SPAN>
<SPAN CLASS="ee-comment">
])</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555208"></A>where <SPAN CLASS="ee-text">
x</SPAN>
 and <SPAN CLASS="ee-text">
y</SPAN>
 are the coordinates of the mouse clicking position. If <SPAN CLASS="ee-text">
item</SPAN>
 denotes the list element <SPAN CLASS="ee-keyword">
agent</SPAN>
 your_routine, inserted by the above call to <SPAN CLASS="ee-text">
extend</SPAN>
, the effect will be the same as that of calling
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555211"></A>your_routine <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-text">
x, y</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555212"></A>assuming that <SPAN CLASS="ee-text">
your_routine</SPAN>
 indeed takes arguments of the appropriate type, here <SPAN CLASS="ee-text">
INTEGER</SPAN>
 representing a coordinate in pixels. (Otherwise type checking would have rejected the call to <SPAN CLASS="ee-text">
extend</SPAN>
.)
</DIV>
<DIV>
<H2 CLASS="aa-sec3">
<A NAME="pgfId-555213"></A>Open and closed arguments</H2>
<P CLASS="nn-first">
<A NAME="pgfId-555214"></A>In the examples so far, execution of the agent's associated routine, through <SPAN CLASS="ee-text">
item</SPAN>
 or <SPAN CLASS="ee-text">
call</SPAN>
, passed exactly the arguments that a direct call to the routine would expect. You can have more flexibility. In particular, you may build an agent from a routine with more arguments than expected in the final call, and you may set the values of some arguments at the time you define the agent.
<P CLASS="nn-normal">
<A NAME="pgfId-555215"></A>Assume for example that a cartographical application lets a user record the location of a city by clicking on the corresponding position on the map. The application may do this through a procedure
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555218"></A>record_city <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-text">
cn</SPAN>
<SPAN CLASS="ee-comment">
:</SPAN>
<SPAN CLASS="ee-text">
 STRING</SPAN>
<SPAN CLASS="ee-comment">
;</SPAN>
<SPAN CLASS="ee-text">
 x, y</SPAN>
<SPAN CLASS="ee-comment">
:</SPAN>
<SPAN CLASS="ee-text">
 INTEGER; pop</SPAN>
<SPAN CLASS="ee-comment">
:</SPAN>
<SPAN CLASS="ee-text">
 INTEGER</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>

<P CLASS="ee-comment">
<A NAME="pgfId-555219"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Record that the city of name <SPAN CLASS="ee-text">
name</SPAN>
 is at coordinates
<P CLASS="ee-comment">
<A NAME="pgfId-555220"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <SPAN CLASS="ee-text">
x</SPAN>
 and <SPAN CLASS="ee-text">
y</SPAN>
 with population <SPAN CLASS="ee-text">
pop</SPAN>
.<SPAN CLASS="ee-text">
</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555224"></A>Then you can associate it with the GUI through a call such as
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555223"></A>map<SPAN CLASS="ee-keyword">
.</SPAN>
 click_actions<SPAN CLASS="ee-keyword">
.</SPAN>
extend <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
agent</SPAN>
 record_city<SPAN CLASS="ee-comment">
 (</SPAN>
<SPAN CLASS="ee-text">
name</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-text">
population</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-comment">
))</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555225"></A>assuming that the information on the <SPAN CLASS="ee-text">
name</SPAN>
 and the <SPAN CLASS="ee-text">
population</SPAN>
 has already been determined. What the agent denotes is the same as <SPAN CLASS="ee-keyword">
agent </SPAN>
<SPAN CLASS="ee-text">
your_routine </SPAN>
as given before, where <SPAN CLASS="ee-text">
your_routine </SPAN>
would be a fictitious two-argument routine obtained from record_city -- a four-argument routine -- by setting the first two arguments once and for all to the values given, <SPAN CLASS="ee-text">
name</SPAN>
 and <SPAN CLASS="ee-text">
population</SPAN>
.
<P CLASS="nn-normal">
<A NAME="pgfId-555226"></A>In the agent <SPAN CLASS="ee-keyword">
agent</SPAN>
 record_city<SPAN CLASS="ee-comment">
 (</SPAN>
<SPAN CLASS="ee-text">
name</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-text">
population</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>
, we say that these first two arguments, with their set values, are <SPAN CLASS="ff-bold">
closed</SPAN>
; the last two are <SPAN CLASS="ff-bold">
open</SPAN>
. The question mark syntax introduced by this example may only appear in agent expressions; it denotes open arguments. This means, by the way, that you may view the basic form used in the preceding examples, <SPAN CLASS="ee-keyword">
agent</SPAN>
 your_routine, as an abbreviation -- assuming your_routine has two arguments -- for <SPAN CLASS="ee-keyword">
agent</SPAN>
 your_routine <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>
. It is indeed permitted, to define an agent with all arguments open, to omit the argument list altogether; no ambiguity may result.
<P CLASS="nn-normal">
<A NAME="pgfId-555227"></A>For type checking, <SPAN CLASS="ee-keyword">
agent</SPAN>
 record_city<SPAN CLASS="ee-comment">
 (</SPAN>
<SPAN CLASS="ee-text">
name</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-text">
population</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>
 and <SPAN CLASS="ee-keyword">
agent</SPAN>
 your_routine are acceptable in exactly the same situations, since both represent routines with two arguments. The type of both is 
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555230"></A><SPAN CLASS="ee-text">
PROCEDURE </SPAN>
<SPAN CLASS="ee-comment">
[</SPAN>
<SPAN CLASS="ee-text">
ANY, TUPLE </SPAN>
<SPAN CLASS="ee-comment">
[</SPAN>
<SPAN CLASS="ee-text">
INTEGER, INTEGER</SPAN>
<SPAN CLASS="ee-comment">
]]</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555231"></A>where the tuple type specifies the open operands.
<P CLASS="nn-normal">
<A NAME="pgfId-555232"></A>A completely closed agent, such as <SPAN CLASS="ee-keyword">
agent</SPAN>
 your_routine <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-text">
25</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-text">
32</SPAN>
<SPAN CLASS="ee-comment">
) </SPAN>
or <SPAN CLASS="ee-keyword">
agent</SPAN>
 record_city<SPAN CLASS="ee-comment">
 (</SPAN>
<SPAN CLASS="ee-text">
name</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-text">
population</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-text">
25</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-text">
32</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>
, has the type <SPAN CLASS="ee-text">
TUPLE</SPAN>
, with no parameters; you will call it with <SPAN CLASS="ee-text">
call</SPAN>
<SPAN CLASS="ee-comment">
 ([  ])</SPAN>
, using an empty tuple as argument.
<P CLASS="nn-normal">
<A NAME="pgfId-555233"></A>The freedom to start from a routine with an arbitrary number of arguments, and choose which ones you want to close and which ones to leave open, provides a good part of the attraction of the agent mechanism. It means in particular that in GUI applications you can limit to the strict minimum the &quot;glue&quot; code (sometimes called the <SPAN CLASS="ff-italics">
controller</SPAN>
 in the so-called MVC, Model-View Controller, scheme of GUI design) between the user interface and &quot;business model&quot; parts of a system. A routine such as <SPAN CLASS="ee-text">
record_city</SPAN>
 is a typical example of an element of the business model, uninfluenced -- as it should be -- by considerations of user interface design. Yet by passing it in the form of an agent with partially open and partially closed arguments, you may be able to use it <SPAN CLASS="ff-italics">
directly</SPAN>
 in the GUI, as shown above, without any &quot;controller&quot; code.
<P CLASS="nn-normal">
<A NAME="pgfId-555234"></A>As another example of the mechanism's versatility, we saw above an integral function that could integrate a function of one variable over an interval, as in
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555237"></A>your_integrator<SPAN CLASS="ee-keyword">
.</SPAN>
integral <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
agent</SPAN>
 your_function<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-text">
0</SPAN>
<SPAN CLASS="ee-comment">
,</SPAN>
<SPAN CLASS="ee-text">
 1</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555238"></A>Now assume that <SPAN CLASS="ee-text">
function3</SPAN>
 takes three arguments. To integrate <SPAN CLASS="ee-text">
function3</SPAN>
 with two arguments fixed, you don't need a new <SPAN CLASS="ee-text">
integral </SPAN>
function; just use the same <SPAN CLASS="ee-text">
integral</SPAN>
 as before, judiciously selecting what to close and what to leave open:
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555241"></A>your_integrator<SPAN CLASS="ee-keyword">
.</SPAN>
integral <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
agent</SPAN>
 function3 <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-text">
3.5</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-comment">
, </SPAN>
<SPAN CLASS="ee-text">
6.0</SPAN>
<SPAN CLASS="ee-comment">
), </SPAN>
<SPAN CLASS="ee-text">
0</SPAN>
<SPAN CLASS="ee-comment">
,</SPAN>
<SPAN CLASS="ee-text">
 1</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>

</TD>
</TR>
</table></ul><p>
</DIV>
<DIV>
<H2 CLASS="aa-sec3">
<A NAME="pgfId-555242"></A>Open targets</H2>
<P CLASS="nn-first">
<A NAME="pgfId-555243"></A>All the agent examples seen so far were based on routines of the enclosing class. This is not required. Feature calls, as you remember, were either unqualified, as in <SPAN CLASS="ee-text">
f </SPAN>
<SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-text">
x, y</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>
, or qualified, as in <SPAN CLASS="ee-text">
a</SPAN>
<SPAN CLASS="ee-dot">
.</SPAN>
<SPAN CLASS="ee-text">
g </SPAN>
<SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-text">
x, y</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>
. Agents, too, have a qualified variant as in
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555246"></A><SPAN CLASS="ee-keyword">
agent </SPAN>
<SPAN CLASS="ee-text">
a</SPAN>
<SPAN CLASS="ee-dot">
.</SPAN>
<SPAN CLASS="ee-text">
g</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555247"></A>which is closed on its target <SPAN CLASS="ee-text">
a</SPAN>
 and open on the arguments. Variants such as <SPAN CLASS="ee-keyword">
agent </SPAN>
<SPAN CLASS="ee-text">
a</SPAN>
<SPAN CLASS="ee-dot">
.</SPAN>
<SPAN CLASS="ee-text">
g </SPAN>
<SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-text">
x, y</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>
, all closed, and <SPAN CLASS="ee-keyword">
agent </SPAN>
<SPAN CLASS="ee-text">
a</SPAN>
<SPAN CLASS="ee-dot">
.</SPAN>
<SPAN CLASS="ee-text">
g </SPAN>
<SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-text">
, y</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>
, open on one argument, are all valid.
<P CLASS="nn-normal">
<A NAME="pgfId-555248"></A>You may also want to make the <SPAN CLASS="ff-italics">
target</SPAN>
 open. The question mark syntax could not work here, since it wouldn't tell us the class to which feature <SPAN CLASS="ee-text">
g</SPAN>
 belongs, known in the preceding examples from the type of <SPAN CLASS="ee-text">
a</SPAN>
. As in creation expressions, we must list the type explicitly; the convention is the same: write the types in braces, as in
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555251"></A><SPAN CLASS="ee-keyword">
agent </SPAN>
<SPAN CLASS="ee-comment">
{</SPAN>
<SPAN CLASS="ee-text">
SOME_TYPE</SPAN>
<SPAN CLASS="ee-comment">
}</SPAN>
<SPAN CLASS="ee-dot">
.</SPAN>
<SPAN CLASS="ee-text">
g</SPAN>

<P CLASS="ee-text">
<A NAME="pgfId-555252"></A><SPAN CLASS="ee-keyword">
agent </SPAN>
<SPAN CLASS="ee-comment">
{</SPAN>
<SPAN CLASS="ee-text">
SOME_TYPE</SPAN>
<SPAN CLASS="ee-comment">
}</SPAN>
<SPAN CLASS="ee-dot">
.</SPAN>
<SPAN CLASS="ee-text">
g </SPAN>
<SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-text">
, </SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>

<P CLASS="ee-text">
<A NAME="pgfId-555253"></A><SPAN CLASS="ee-keyword">
agent </SPAN>
<SPAN CLASS="ee-comment">
{</SPAN>
<SPAN CLASS="ee-text">
SOME_TYPE</SPAN>
<SPAN CLASS="ee-comment">
}</SPAN>
<SPAN CLASS="ee-dot">
.</SPAN>
<SPAN CLASS="ee-text">
g </SPAN>
<SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
?</SPAN>
<SPAN CLASS="ee-text">
, y</SPAN>
<SPAN CLASS="ee-comment">
)</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555254"></A>The first two of these examples are open on the target and both operands; they mean the same. The third is closed on one argument, open on the other and on the target.
<P CLASS="nn-normal">
<A NAME="pgfId-555255"></A>These possibilities give even more flexibility to the mechanism because they mean that an operation that needs agents with certain arguments open doesn't care whether they come from an argument or an operand of the original routine. This is particularly useful for iterators and means that if you have two lists
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555258"></A><SPAN CLASS="ee-text">
your_account_list</SPAN>
<SPAN CLASS="ee-comment">
:</SPAN>
<SPAN CLASS="ee-text">
 LIST </SPAN>
<SPAN CLASS="ee-comment">
[</SPAN>
<SPAN CLASS="ee-text">
ACCOUNT</SPAN>
<SPAN CLASS="ee-comment">
]</SPAN>

<P CLASS="ee-text">
<A NAME="pgfId-555259"></A><SPAN CLASS="ee-text">
your_integer_list</SPAN>
<SPAN CLASS="ee-comment">
:</SPAN>
<SPAN CLASS="ee-text">
 LIST </SPAN>
<SPAN CLASS="ee-comment">
[</SPAN>
<SPAN CLASS="ee-text">
INTEGER</SPAN>
<SPAN CLASS="ee-comment">
]</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555264"></A>you may write both
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555262"></A><SPAN CLASS="ee-text">
your_</SPAN>
acccount_list<SPAN CLASS="ee-keyword">
.</SPAN>
do_all <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
agent</SPAN>
 deposit_one_grand<SPAN CLASS="ee-comment">
)</SPAN>

<P CLASS="ee-text">
<A NAME="pgfId-555263"></A><SPAN CLASS="ee-text">
your_</SPAN>
integer_list<SPAN CLASS="ee-keyword">
.</SPAN>
do_all   <SPAN CLASS="ee-comment">
(</SPAN>
<SPAN CLASS="ee-keyword">
agent</SPAN>
 add_to_n<SPAN CLASS="ee-comment">
)</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555265"></A>even though the two procedures used in the agents have quite different forms. We are assuming here that the first one, in class <SPAN CLASS="ee-text">
ACCOUNT</SPAN>
, is something like
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555268"></A>deposit_one_grand<SPAN CLASS="ee-comment">
 </SPAN>
<SPAN CLASS="ee-keyword">
is</SPAN>

<P CLASS="ee-comment">
<A NAME="pgfId-555269"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Add one thousand dollars to balance of account.
<P CLASS="ee-comment">
<A NAME="pgfId-555270"></A>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="ee-keyword">
do</SPAN>
<SPAN CLASS="ee-text">
 balance </SPAN>
<SPAN CLASS="ee-comment">
:= </SPAN>
<SPAN CLASS="ee-text">
balance </SPAN>
<SPAN CLASS="ee-comment">
+ </SPAN>
<SPAN CLASS="ee-text">
1000 </SPAN>
<SPAN CLASS="ee-keyword">
end</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555271"></A>so that it doesn't take an argument: it is normally called on its target, as in <SPAN CLASS="ee-text">
my_account</SPAN>
<SPAN CLASS="ee-dot">
.</SPAN>
deposit_one_grand. In contrast, the other routine has an argument:
<p><ul><table width="79%">
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="ee-text">
<A NAME="pgfId-555274"></A>add_to_n <SPAN CLASS="ee-comment">
(</SPAN>
x: INTEGER<SPAN CLASS="ee-comment">
)</SPAN>
 <SPAN CLASS="ee-keyword">
is</SPAN>

<P CLASS="ee-comment">
<A NAME="pgfId-555275"></A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Add <SPAN CLASS="ee-text">
x</SPAN>
 to the value of <SPAN CLASS="ee-text">
total</SPAN>
.
<P CLASS="ee-comment">
<A NAME="pgfId-555276"></A>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN CLASS="ee-keyword">
do</SPAN>
<SPAN CLASS="ee-text">
 total </SPAN>
<SPAN CLASS="ee-comment">
:= </SPAN>
<SPAN CLASS="ee-text">
total </SPAN>
<SPAN CLASS="ee-comment">
+ </SPAN>
<SPAN CLASS="ee-text">
x </SPAN>
<SPAN CLASS="ee-keyword">
end</SPAN>

</TD>
</TR>
</table></ul><p>
<P CLASS="nn-first">
<A NAME="pgfId-555277"></A>where <SPAN CLASS="ee-text">
total </SPAN>
is an integer attribute of the enclosing class. Without the versatility of playing with open and closed arguments for both the original arguments and target, you would have to write separate iteration mechanisms for these two cases. Here you can use a single iteration routine of <SPAN CLASS="ee-text">
LIST</SPAN>
 and similar classes of EiffelBase, <SPAN CLASS="ee-text">
do_all</SPAN>
, for both purposes:
<UL>
<p class="nn-first"><img src="greenball.gif" alt="+">
<A NAME="pgfId-555278"></A>Depositing money on every account in a list of accounts.
<p class="nn-first"><img src="greenball.gif" alt="+">
<A NAME="pgfId-555279"></A>Adding all the integers in a list of integers.
</UL>
<P CLASS="nn-first">
<A NAME="pgfId-555120"></A>Agents provide a welcome complement to the other mechanisms of Eiffel. They do not conflict with them but, when appropriate -- as in the examples sketched in this section -- provide clear and expressive programming schemes, superior to the alternatives.
</DIV>
<p class="bottom" ALIGN="left"><IMG SRC="normaldoc.gif" ALT="Previous, Up, Next" BORDER="0" WIDTH="300" HEIGHT="40" USEMAP="#navigation"><map name="navigation"><AREA SHAPE="RECT" alt="Previous section" COORDS="0,0,95,40" HREF="tutorial-11.html"><AREA SHAPE="RECT" alt="Up" COORDS="96,0,199,40" HREF="tutorial.html"><AREA SHAPE="RECT" alt="Next section" COORDS="200,0,300,40" HREF="tutorial-13.html"><area shape="default" nohref></MAP>

<p class="bottom" align="center"><a href="http://www.eiffel.com">Eiffel Home Page (Web)</a> -- <a href="../index.html">Getting started with Eiffel (local)</a>

<p class="copyright" align="center">Copyright Interactive Software Engineering, 2001
</BODY>
</HTML>
