<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML XMLNS:MSHelp="http://msdn.microsoft.com/mshelp">
	<XML>
		<MSHelp:Keyword Index="K" Term="Menus" />
		<MSHelp:Keyword Index="K" Term="Samples, Menus" />
		<MSHelp:Attr Name="Product" Value="Eiffel"/>
		<MSHelp:Attr Name="Locale" Value="kbEnglish"/>
	</XML>
	<HEAD>
		<TITLE>Menus Sample</TITLE>
		<LINK HREF="../../../../../default.css" TYPE="text/css" REL="STYLESHEET">
	</HEAD>
	<BODY LANGUAGE="vbscript" ONLOAD="onLoadHandler">
		<TABLE CLASS="HEADER">
			<TR>
				<TD CLASS="HEADER">Eiffel ENViSioN!</TD>
				<TD></TD>
			</TR>
			<TR>
				<TD CLASS="SUBHEADER">Menus Sample</TD>
				<TD ALIGN=RIGHT>
					<A CLASS="bold" HREF="#NONEXISTANT" OnClick="LoadSample()">Load in Eiffel ENViSioN! </A>
				</TD>
			</TR>
		</TABLE>
		<TABLE CLASS="FRAME">
			<TR>
				<TD>
					<SCRIPT LANGUAGE=VBScript>
						' Samples scripts, used to launch samples from documentation
						' (C) 2003-2004 Eiffel Software, All Rights Reserved.

						Option Explicit

						Dim SamplesPath
						Dim SampleDir
						Dim SamplePrj

						Sub LoadSample()
							Dim WshShell
							Dim Path
							Dim Quote
							Dim Is2003
							
							If Not IsEmpty (SampleDir) And Not IsEmpty (SamplePrj) Then
								Set WshShell = CreateObject ("WScript.Shell")
								Is2003 = CanLaunch2003()
								If Is2003 Then
									Path = WshShell.RegRead ("HKLM\SOFTWARE\Microsoft\VisualStudio\7.1\Setup\Eiffel\ProductDir")
								Else
									Path = WshShell.RegRead ("HKLM\SOFTWARE\Microsoft\VisualStudio\7.0\Setup\Eiffel\ProductDir")
								End If
								If Not IsEmpty (Path) Then
									If Is2003 Then
										SamplesPath = Path + "Compiler\Examples\v1.1.4322" + SampleDir + "\" + SamplePrj
										Path = WshShell.RegRead ("HKLM\SOFTWARE\Microsoft\VisualStudio\7.1\InstallDir")
									Else
										SamplesPath = Path + "Compiler\Examples\v1.0.3705" + SampleDir + "\" + SamplePrj
										Path = WshShell.RegRead ("HKLM\SOFTWARE\Microsoft\VisualStudio\7.0\InstallDir")
									End If
									If Not IsEmpty (Path) Then
										Quote = Chr(34)
										Path = Quote + Path + "Devenv.exe" + Quote + " " + Quote + SamplesPath + Quote
										WshShell.Run Path, 1, False 
									End If
								End If
							End If

						End Sub

						Function CanLaunch2003()
							Dim WshShell
							Dim Installed
								
							Set WshShell = CreateObject ("WScript.Shell")
							Installed = WshShell.RegRead ("HKLM\SOFTWARE\ISE\Eiffel ENViSioN! 2.0\Setup")
							CanLaunch2003 = (Installed = "2003")
						End Function
					</SCRIPT>
					<SCRIPT LANGUAGE=VBScript>
						Sub onLoadHandler()
							'Initialize global variables
							SampleDir = "\winforms\menu"
							SamplePrj = "menu.eifp"
						End Sub							
					</SCRIPT>

					<p>Windows Forms supports menus and context menus. Main menus are displayed on a
					menu bar that is located immediately below the title bar of a form. The menu
					bar contains top-level menu items that are used to group related submenu items.
					For example, by clicking a <b>File</b> top-level menu item, you can display
					menu items that are related to file operations. Menu items typically appear as
					commands for your application (such as <b>New</b> and <b>Open</b>), but they
					can also appear as separator bars and submenu items. You can display a check
					mark next to a menu item to display the state of a command or a the state of a
					feature in your application. In Windows Forms, main menus are represented by
					the <SPAN CLASS="eclass">WINFORMS_MAIN_MENU</SPAN> control.</p>
					
					<p>Context menus can be displayed for a specific control or area of your form. They
					are typically accessed by clicking the right mouse button. In Windows Forms,
					context menus are represented by the <SPAN CLASS="eclass">WINFORMS_CONTEXT_MENU</SPAN>
					control.</p>
					
					<p><SPAN CLASS="eclass">WNFORMS_MAIN_MENU</SPAN> and
					<SPAN CLASS="eclass">WNFORMS_CONTEXT_MENU</SPAN> both derive from
					<SPAN CLASS="eclass">WNFORMS_MENU</SPAN>. They share many properties, methods, and events.</p>
					
					<h2>Adding a main menu to a Form</h2>
					
					<p>The following code demonstrates how to add a main menu to a form.</p>
					
					<CODE>
						<SPAN CLASS="efeature">main_menu</SPAN>: <SPAN CLASS="eclass">WINFORMS_MAIN_MENU</SPAN>
					</CODE>
					
					<CODE>
						<SPAN CLASS="ekeyword">create</SPAN><BR />
						<SPAN CLASS="efeature">main_menu</SPAN>.<SPAN CLASS="efeature">make</SPAN><BR />
						<SPAN CLASS="efeature">set_menu</SPAN>
						(<SPAN CLASS="efeature">main_menu</SPAN>)
					</CODE>

					<h2>Adding a Context Menu to a Control</h2>
					
					<p>The following code demonstrates how to create a context menu
					 and assign it to a control.</p>
					 
					<CODE>
						<SPAN CLASS="elocal">label_1</SPAN>: <SPAN CLASS="eclass">WINFORMS_LABEL</SPAN><BR />
						<SPAN CLASS="elocal">label_1_context_menu</SPAN>: <SPAN CLASS="eclass">WINFORMS_CONTEXT_MENU</SPAN>
					</CODE>
					
					<CODE>
						<SPAN CLASS="ekeyword">create</SPAN> <SPAN CLASS="elocal">label_1</SPAN>.<SPAN CLASS="efeature">make</SPAN><BR />
						<SPAN CLASS="ekeyword">create</SPAN> <SPAN CLASS="elocal">label_1_context_menu</SPAN>.<SPAN CLASS="efeature">make</SPAN><BR />
						<SPAN CLASS="elocal">label_1</SPAN>.<SPAN CLASS="efeature">set_context_menu</SPAN>
						(<SPAN CLASS="elocal">label_1_context_menu</SPAN>)
					</CODE>

					<h2>Adding Menu Items</h2>

					<p>In the following example, a <b>File</b> menu item is added to the main menu.
					The <b>File</b> menu item contains submenu items called <b>Open</b> and <b>Exit</b>.</p>
					
					<CODE>
						<SPAN CLASS="elocal">mi_file</SPAN>: <SPAN CLASS="eclass">WINFORMS_MAIN_MENU</SPAN>
					</CODE>
					
					<CODE>
						<SPAN CLASS="elocal">mi_file</SPAN> := <SPAN CLASS="efeature">main_menu</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add</SPAN> ("&amp;File")<br />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">mi_file</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add_menu_item</SPAN> (<SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">WINFORMS_MENU_ITEM</SPAN>}.<SPAN CLASS="efeature">make</SPAN> ("&amp;Open..."))<br />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">mi_file</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add</SPAN> ("-") <SPAN CLASS="ecomment">-- Gives us a seperator</SPAN><br />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">mi_file</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add_menu_item</SPAN> (<SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">WINFORMS_MENU_ITEM</SPAN>}.<SPAN CLASS="efeature">make</SPAN> ("E&amp;xit"))<br />
					</CODE>

					<p>The following code demonstrates how to handle the <b>Click</b> event for both
					the <b>Open</b> and <b>Exit</b> menu items created in the previous code example.</p>
					
					<CODE>
						<SPAN CLASS="elocal">mi_file</SPAN> := <SPAN CLASS="efeature">main_menu</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add</SPAN> ("&amp;File")<br />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">mi_file</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add_menu_item</SPAN> (<SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">WINFORMS_MENU_ITEM</SPAN>}.<SPAN CLASS="efeature">make</SPAN> ("&amp;Open...", <SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">file_open_clicked</SPAN>), feature {<SPAN CLASS="eclass">WINFORMS_SHORTCUT</SPAN>}.ctrl_O))<br />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">mi_file</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add</SPAN> ("-") <SPAN CLASS="ecomment">-- Gives us a seperator</SPAN><br />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">mi_file</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add_menu_item</SPAN> (<SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">WINFORMS_MENU_ITEM</SPAN>}.<SPAN CLASS="efeature">make</SPAN> ("E&amp;xit", <SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">file_exit_clicked</SPAN>), feature {<SPAN CLASS="eclass">WINFORMS_SHORTCUT</SPAN>}.ctrl_X))
					</CODE>

					<p>The following example demonstrates how to define shortcut keys for the menu
					items created in the previous example.</p>
					
					<CODE>
						<SPAN CLASS="elocal">mi_file</SPAN> := <SPAN CLASS="efeature">main_menu</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add</SPAN> ("&amp;File")<br />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">mi_file</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add_menu_item</SPAN> (<SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">WINFORMS_MENU_ITEM</SPAN>}.<SPAN CLASS="efeature">make</SPAN> ("&amp;Open...", <SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">file_open_clicked</SPAN>), feature {<SPAN CLASS="eclass">WINFORMS_SHORTCUT</SPAN>}.ctrl_O))<br />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">mi_file</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add</SPAN> (("-").<SPAN CLASS="efeature">to_cil</SPAN>) <SPAN CLASS="ecomment">-- Gives us a seperator</SPAN><br />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">mi_file</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add_menu_item</SPAN> (<SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">WINFORMS_MENU_ITEM</SPAN>}.<SPAN CLASS="efeature">make</SPAN> ("E&amp;xit", <SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">file_exit_clicked</SPAN>), feature {<SPAN CLASS="eclass">WINFORMS_SHORTCUT</SPAN>}.ctrl_X))
					</CODE>
					
					<h2>Adding Submenus</h2>
					
					<p>The following example demonstrates how to create submenus.</p>
					
					<CODE>
						<SPAN CLASS="elocal">mi_format</SPAN>: <SPAN CLASS="eclass">WINFORMS_MAIN_MENU</SPAN>
					</CODE>
					
					<CODE>
						<SPAN CLASS="ecomment">-- Add Format Menu</SPAN><br />
						<SPAN CLASS="elocal">mi_format</SPAN> := <SPAN CLASS="efeature">main_menu</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add</SPAN> ("F&amp;ormat")<br />
						<br />
						<SPAN CLASS="ecomment">-- Font Face sub-menu</SPAN><br />
						<SPAN CLASS="ekeyword">create</SPAN> <SPAN CLASS="elocal">mmi_sans_serif</SPAN>.<SPAN CLASS="efeature">make</SPAN> ("&amp;1. ", <SPAN CLASS="efeature">sans_serif_font_family</SPAN>.<SPAN CLASS="efeature">get_name</SPAN>), <SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">format_font_clicked</SPAN>))<br />
						<SPAN CLASS="elocal">mmi_sans_serif</SPAN>.<SPAN CLASS="efeature">set_checked</SPAN> (<SPAN CLASS="ekeyword">True</SPAN>)<br />
						<SPAN CLASS="elocal">mmi_sans_serif</SPAN>.<SPAN CLASS="efeature">set_default_item</SPAN> (<SPAN CLASS="ekeyword">True</SPAN>)<br />
						<SPAN CLASS="ekeyword">create</SPAN> <SPAN CLASS="elocal">mmi_serif</SPAN>.<SPAN CLASS="efeature">make</SPAN> ("&amp;2. ", <SPAN CLASS="efeature">serif_font_family</SPAN>.<SPAN CLASS="efeature">get_name</SPAN>), <SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">format_font_clicked</SPAN>))<br />
						<SPAN CLASS="ekeyword">create</SPAN> <SPAN CLASS="elocal">mmi_mono_space</SPAN>.<SPAN CLASS="efeature">make</SPAN> ("&amp;3. ", <SPAN CLASS="efeature">mono_space_font_family</SPAN>.<SPAN CLASS="efeature">get_name</SPAN>), <SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">format_font_clicked</SPAN>))<br />
						<SPAN CLASS="ekeyword">create</SPAN> <SPAN CLASS="elocal">l_array_menu_item</SPAN>.<SPAN CLASS="efeature">make</SPAN> (3)<br />
						<SPAN CLASS="elocal">l_array_menu_item</SPAN>.<SPAN CLASS="efeature">put</SPAN> (0, <SPAN CLASS="elocal">mmi_sans_serif</SPAN>)<br />
						<SPAN CLASS="elocal">l_array_menu_item</SPAN>.<SPAN CLASS="efeature">put</SPAN> (1, <SPAN CLASS="elocal">mmi_serif</SPAN>)<br />
						<SPAN CLASS="elocal">l_array_menu_item</SPAN>.<SPAN CLASS="efeature">put</SPAN> (2, <SPAN CLASS="elocal">mmi_mono_space</SPAN>)<br />
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="efeature">mi_format</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add_string</SPAN> ("Font &amp;Face", <SPAN CLASS="elocal">l_array_menu_item</SPAN>)
					</CODE>
					
					<h2>Adding Default Menu Items</h2>
					
					<p>The following example demonstrates how to specify a default menu item.</p>
					
					<CODE>
						<SPAN CLASS="elocal">mmi_sans_serif</SPAN>: <SPAN CLASS="eclass">WINFORMS_MAIN_MENU</SPAN>
					</CODE>
					
					<CODE>
						<SPAN CLASS="ekeyword">create</SPAN> <SPAN CLASS="elocal">mmi_sans_serif</SPAN>.<SPAN CLASS="efeature">make</SPAN> ("&amp;1. ", <SPAN CLASS="efeature">sans_serif_font_family</SPAN>.<SPAN CLASS="efeature">get_name</SPAN>), <SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">format_font_clicked</SPAN>))<br />
						<SPAN CLASS="elocal">mmi_sans_serif</SPAN>.<SPAN CLASS="efeature">set_checked</SPAN> (<SPAN CLASS="ekeyword">True</SPAN>)
					</CODE>

					<h2>Adding Check Marks to Menu Items</h2>

					<p>The following example demonstrates how to display a check mark next to a menu
					item. The code also demonstrates how to track which item is checked.</p>

					<CODE>
						<SPAN CLASS="elocal">mi_medium</SPAN>: <SPAN CLASS="eclass">WINFORMS_MAIN_MENU</SPAN>
					</CODE>
					
					<CODE>
						<SPAN CLASS="ekeyword">create</SPAN> <SPAN CLASS="elocal">mi_medium</SPAN>.<SPAN CLASS="efeature">make</SPAN> ("&amp;Medium", <SPAN CLASS="ekeyword">create</SPAN> {<SPAN CLASS="eclass">EVENT_HANDLER</SPAN>}.<SPAN CLASS="efeature">make</SPAN> (<SPAN CLASS="ekeyword">Current</SPAN>, $<SPAN CLASS="efeature">format_size_clicked</SPAN>))<br />
						<SPAN CLASS="elocal">mi_medium</SPAN>.<SPAN CLASS="efeature">set_checked</SPAN> (<SPAN CLASS="ekeyword">True</SPAN>)
					</CODE>

					<h2>Cloning Menus</h2>

					<p>In many cases, the context menu for a control is a subset of the main menu. You
					cannot add the same menu items to multiple menus, but you can clone a menu item
					or set of menu items. The following code demonstrates how to clone the <b>Format</b>
					menu created previously and add it to the context menu of a <SPAN CLASS="eclass">LABEL</SPAN>.</p>
					
					<CODE>
						<SPAN CLASS="elocal">res</SPAN> := <SPAN CLASS="elocal">label_1_context_menu</SPAN>.<SPAN CLASS="efeature">menu_items</SPAN>.<SPAN CLASS="efeature">add_menu_item</SPAN> (mi_format.clone_menu)
					</CODE>
				</TD>
			</TR>
		</TABLE>
		<TABLE CLASS="FOOTER" ID="Table3">
			<TR>
				<TD>© 2003-2004 Eiffel Software. All rights reserved.</TD>
			</TR>
		</TABLE>
	</BODY>
</HTML>