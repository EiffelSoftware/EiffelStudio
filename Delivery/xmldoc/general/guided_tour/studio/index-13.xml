<document title="12 HANDLING SYNTAX AND VALIDITY ERRORS" output="studio">
	<meta_data></meta_data>
	<paragraph>
		<paragraph>
			<link>
				<url>tour-help.xml</url>
				<label>Help reading this manual</label>
			</link>
		</paragraph>
		<paragraph>So far we have tried to make sure that everything went smoothly. But in actual software development you may encounter error situations, and it is useful to know what can happen then.</paragraph>
		<div>
			<heading>
				<size>2</size>
				<content>Levels of language description</content>
			</heading>
			<paragraph>Let's remind ourselves first of how the language is specified. The book 
				<span>
					<link>
						<url>http://www.eiffel.com/doc/</url><anchor_name>etl</anchor_name>
						<label>Eiffel: The Language</label>
					</link>
				</span>, the language reference, carefully distinguishes between three levels of description: 
				<bold>syntax</bold>, 
				<bold>validity</bold> and 
				<bold>semantics</bold>. Their roles are clearly distinct:
			</paragraph>
			<list ordered="false">
				<item>
					<span>Syntax</span> defines the structure of software texts. A typical syntax rule states that an assignment starts with a 
					<code>
						<syntax>Writable</syntax>
					</code> entity, continues with the symbol 
					<code>
						<keyword>:=</keyword>
					</code>, and ends with an 
					<code>
						<syntax>Expression</syntax>
					</code>. This is a purely structural specification, saying nothing for example about the types of the 
					<code>
						<syntax>Writable</syntax>
					</code> and the 
					<code>
						<syntax>Expression</syntax>
					</code>.
				</item>
				<item>
					<span>Validity</span>, applicable only to syntactically legal texts, defines required consistency conditions. A typical validity rule states that in an assignment the right-hand-side 
					<code>
						<syntax>Expression</syntax>
					</code> must 
					<span>conform</span> -- a property of its type, defined rigorously on the basis of inheritance -- to the left-hand-side 
					<code>
						<syntax>Writable</syntax>
					</code>. Eiffel has about 75 validity rules; part of the language's originality is that these rules are of the " 
					<span>if and only if</span> " form, not only telling you individual error cases ("this is valid 
					<span>only if</span>
					<span>...</span> ") but also reassuring you that your text will in fact be valid 
					<span>if</span> it satisfies the conditions listed exhaustively.
				</item>
				<item>Semantics, applicable only to valid texts, defines the software's expected run-time behavior. A typical semantic rule states that an assignment replaces the value of its left-hand-side 
					<code>
						<syntax>Writable</syntax>
					</code> by the value of the right-hand-side 
					<code>
						<syntax>Expression</syntax>
					</code> at the time the assignment is executed, with precise rules on the different possible cases involving references, objects and simple values.
				</item>
			</list>
			<paragraph>You may make an error at any of these levels:</paragraph>
			<list ordered="false">
				<item>Writing 
					<code>
						<keyword>=</keyword>
					</code> instead of 
					<code>
						<keyword>:=</keyword>
					</code> for the assignment symbol is a syntax error.
				</item>
				<item>Writing 
					<code>
						<string>your_integer</string>
					</code> 
					<code>
						<keyword>:=</keyword>
					</code>
					<code> 
						<string>your_real</string>
					</code>, with the types suggested by the names, is a validity error.
				</item>
				<item>Calling a feature on a void target, violating a precondition, causing a division by zero, are semantic errors. </item>
			</list>
			<paragraph>Syntax and validity errors will be detected by the compilation process. For semantic errors, you will rely on contract checking and on the debugging tools described later. Let's look now at examples of the first two cases. </paragraph>
		</div>
		<div>
			<heading>
				<size>2</size>
				<content>A syntax error</content>
			</heading>
			<paragraph>To see what happens for a syntax error, replace the keyword 
				<code>
					<keyword>is</keyword>
				</code> by 
				<code>
					<keyword>ist</keyword>
				</code> in the first line of routine 
				<code>
					<keyword>display</keyword>
				</code> of class 
				<code>
					<keyword>PARENT</keyword>
				</code> (click the position immediately after the 
				<code>
					<keyword>s</keyword>
				</code> and type a 
				<code>
					<keyword>t</keyword>
				</code>.). Save the file by clicking the Save button or using CTRL- 
				<code>
					<keyword>S</keyword>
				</code>. EiffelStudio parses the class as it is saving it, and finds the error: The position of the error is highlighted in the class text.
			</paragraph>
			<div>
				<image_link>
					<url>index-75.png</url>
					<target>screenshots</target>
					<image>
						<url>index-75.png</url>
						<width>100</width>
					</image>
				</image_link>
			</div>
			<paragraph>To correct the error, just bring the mouse back to its location, remove the spurious 
				<code>
					<keyword>t</keyword>
				</code>, and click Save again; also click Compile to make sure that the project is recompiled up-to-date.
			</paragraph>
			<paragraph>You may wonder why the syntax error messages are not a little more verbose than just 
				<code>
					<keyword>Syntax error</keyword>
				</code>. The reason is merely that Eiffel's syntax, being simple and regular, does not require sophisticated error messages; syntax errors usually result from trivial oversights. If you make a syntax error and the reason is not immediately clear, check the syntax summary in the appendix of 
				<span>
					<link>
						<url>http://www.eiffel.com/doc/</url><anchor_name>etl</anchor_name>
						<label>Eiffel: The Language</label>
					</link>
				</span>.
			</paragraph>
		</div>
		<div>
			<heading>
				<size>2</size>
				<content>A validity error</content>
			</heading>
			<paragraph>A validity error is a violation of one of the validity constraints given in 
				<span>
					<link>
						<url>http://www.eiffel.com/doc/</url><anchor_name>etl</anchor_name>
						<label>Eiffel: The Language</label>
					</link>
				</span>. Every such constraint is identified by a four-letter code of the form 
				<code>
					<keyword>V</keyword>
				</code>
				<code>
					<string>XXX</string>
				</code> (the first letter is always 
				<code>
					<keyword>V</keyword>
				</code>).
			</paragraph>
			<paragraph>A validity error will produce a precise error message, which includes the validity code. Although short, the error message is usually sufficient to find out what the error is. If not, you can get the complete rule, straight from the book.</paragraph>
			<paragraph>To see this mechanism at work, let us introduce a validity error. There is in fact one ready for you in class 
				<code>
					<keyword>TESTROOT</keyword>
				</code>. Target a Development Window to this class; at the end of its text, just before the final 
				<code>
					<keyword>end</keyword>
				</code>, you will find the following comment line:
			</paragraph>
			<code_block>
<keyword>-- inv: INVALID</keyword></code_block>
			<paragraph>If uncommented, this is a declaration of a feature of type 
				<code>
					<keyword>INVALID</keyword>
				</code>. A class called 
				<code>
					<keyword>INVALID</keyword>
				</code> indeed exists in file 
				<code>
					<keyword>invalid.e</keyword>
				</code> of the root cluster, but it contains a validity error. To see what it is, remove the initial double-dash 
				<code>
					<keyword>--</keyword>
				</code> in the above line from class 
				<code>
					<keyword>TESTROOT</keyword>
				</code> so that it is not a comment any more.
			</paragraph>
			<div>
				<image_link>
					<url>index-76.png</url>
					<target>screenshots</target>
					<image>
						<url>index-76.png</url>
						<width>100</width>
					</image>
				</image_link>
			</div>
			<paragraph>Click 
				<code>
					<keyword>Save</keyword>
				</code>, then 
				<code>
					<keyword>Compile</keyword>
				</code>. Compilation starts but after a few degrees it stops with an error message that appears in the bottom Context Tool (you may have to do some resizing to see it in its entirety):
			</paragraph>
			<div>
				<image_link>
					<url>index-77.png</url>
					<target>screenshots</target>
					<image>
						<url>index-77.png</url>
						<width>100</width>
					</image>
				</image_link>
			</div>
			<paragraph>As the error message indicates, you have (shame on you) violated the validity rule 
				<code>
					<keyword>VUAR</keyword>
				</code>, which requires the number and types of actual arguments in a routine call to match the number and types of formal arguments declared in the routine.
			</paragraph>
			<paragraph>One of the interesting properties of the error message is that everything in color is 
				<bold>clickable</bold> : class name, feature name, but also the error code. This means that you can start a Pick-and-Drop on any of these elements to find out more.
			</paragraph>
			<paragraph>For example, to see the exact context of the error, pick-and-drop the name of the affected feature, 
				<code>
					<string>display</string>
				</code> -- appearing on the fifth non-blank line, after 
				<code>
					<keyword>Feature:</keyword>
				</code> -- and pick-and-drop it to the top Text window. (As you remember this means: right-click on it and release; move the mouse to the text window, without clicking any button; right-click again. During the move the cursor shows a cross, the symbol for features.) This displays the erroneous feature:
			</paragraph>
			<div>
				<image_link>
					<url>index-78.png</url>
					<target>screenshots</target>
					<image>
						<url>index-78.png</url>
						<width>100</width>
					</image>
				</image_link>
			</div>
			<paragraph>Note on this display a special property of Pick-and-Drop when its source is a feature name appearing in a validity error message: the instruction that causes the error is highlighted.</paragraph>
			<paragraph>In the error message in the Context Tool, the error code itself, 
				<code>
					<keyword>VUAR</keyword>
				</code>, is also clickable. Assuming the message was not sufficient to understand the error, you can use it to start a Pick-and-Drop. Do this now, by picking that code and starting to move the mouse, but not dropping yet:
			</paragraph>
			<div>
				<image_link>
					<url>index-79.png</url>
					<target>screenshots</target>
					<image>
						<url>index-79.png</url>
						<width>100</width>
					</image>
				</image_link>
			</div>
			<paragraph>The icon shape for such information elements is a question mark 
				<code>
					<keyword>?</keyword>
				</code>. If it is not on a droppable target, as in the bottom Context Tool, that icon will be crossed. In principle the place to drop is the Explanation hole in the Project toolbar, the only one that remains highlighted during the Move step of Pick-and-Drop:
			</paragraph>
			<div>
				<image_link>
					<url>index-80.png</url>
					<target>screenshots</target>
					<image>
						<url>index-80.png</url>
						<width>100</width>
					</image>
				</image_link>
			</div>
			<paragraph>As is often the case when dropping into a specific hole, you don't need to shoot straight; dropping the pebble anywhere in the Editing Tool has the same effect as dropping it into the Explanation hole:</paragraph>
			<div>
				<image_link>
					<url>index-81.png</url>
					<target>screenshots</target>
					<image>
						<url>index-81.png</url>
						<width>100</width>
					</image>
				</image_link>
			</div>
			<paragraph>The result is to display the complete text of the violated rule, straight from the pages of 
				<span>
					<link>
						<url>http://www.eiffel.com/doc/</url><anchor_name>etl</anchor_name>
						<label>Eiffel: The Language</label>
					</link>
				</span>.
			</paragraph>
			<paragraph>The rule has several clauses, numbered. Since the error message showed the error code as 
				<code>
					<keyword>VUAR(1)</keyword>
				</code>, the violated clause is the first; this convention of showing the clause number in parentheses applies to all multi-clause validity constraints.
			</paragraph>
			<paragraph>To correct the error the easiest is to go back to class 
				<code>
					<string>TESTROOT</string>
				</code> and reinstate the comment symbol 
				<code>
					<comment>--</comment>
				</code> (two consecutive dashes) on the erroneous line. Save and compile to continue with a valid system.
			</paragraph>
		</div>
		<paragraph>
			<link>
				<url>index-12.xml</url>
				<label>&lt;&lt; Previous</label>
			</link> 
			<link>
				<url>index-14.xml</url>
				<label>Next &gt;&gt;</label>
			</link>
</paragraph>
	</paragraph></document>
