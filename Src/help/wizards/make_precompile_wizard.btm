@echo off
echo -----------------------------------------------------------------
echo ----------------- Preparing Temporary directory -----------------
echo -----------------------------------------------------------------
pushd
mkdir %DELIVERY%\bench\wizards\precompile\spec
mkdir %DELIVERY%\bench\wizards\precompile\spec\windows
mkdir %DELIVERY%\bench\wizards\precompile\spec\windows\bin
echo Y > y.txt
rd /S %TEMP%\precomp_wizard < y.txt
del y.txt
mkdir %TEMP%\precomp_wizard
echo -----------------------------------------------------------------
echo ----------------- Retrieving last sources -----------------------
echo -----------------------------------------------------------------
cdd %EIFFEL_SRC%\help\wizards
call cvs up -Pd
echo -----------------------------------------------------------------
echo ----------------- Compilation -----------------------------------
echo -----------------------------------------------------------------
%ISE_EIFFEL%\bench\spec\windows\bin\ec -finalize -ace %EIFFEL_SRC%\help\wizards\precompile_wizard.ace -project_path %TEMP%\precomp_wizard
cdd %TEMP%\precomp_wizard
copy %EIFFEL_SRC%\help\wizards\wizard.ico .
copy %EIFFEL_SRC%\help\wizards\wizard.rc .
cdd %TEMP%\precomp_wizard\EIFGEN\F_Code
%ISE_EIFFEL%\bench\spec\windows\bin\finish_freezing -silent
echo -----------------------------------------------------------------
echo ------- Compress generated executable file ----------------------
echo -----------------------------------------------------------------
upx wizard.exe
echo -----------------------------------------------------------------
echo ------- Copying generated executable file into Delivery ---------
echo -----------------------------------------------------------------
copy wizard.exe %DELIVERY%\bench\wizards\precompile\spec\windows\bin
cd %TEMP%
popd
echo -----------------------------------------------------------------
echo ------- Deleting temporary files --------------------------------
echo -----------------------------------------------------------------
echo Y > y.txt
rd /S %TEMP%\precomp_wizard < y.txt
del y.txt
