@echo off
echo -----------------------------------------------------------------
echo ----------------- Preparing Temporary directory -----------------
echo -----------------------------------------------------------------
pushd
mkdir %DELIVERY%\studio\wizards\new_projects\dotnet\spec
mkdir %DELIVERY%\studio\wizards\new_projects\dotnet\spec\windows
echo Y > y.txt
rd /S %TEMP%\dotnet_wizard < y.txt
del y.txt
mkdir %TEMP%\dotnet_wizard
echo -----------------------------------------------------------------
echo ----------------- Retrieving last sources -----------------------
echo -----------------------------------------------------------------
cdd %EIFFEL_SRC%\help\wizards
call cvs up -Pd
echo -----------------------------------------------------------------
echo ----------------- Compilation -----------------------------------
echo -----------------------------------------------------------------
%ISE_EIFFEL%\studio\spec\windows\bin\ec -finalize -ace %EIFFEL_SRC%\help\wizards\dotnet_wizard.ace -project_path %TEMP%\dotnet_wizard
cdd %TEMP%\dotnet_wizard
copy %EIFFEL_SRC%\help\wizards\wizard.ico .
copy %EIFFEL_SRC%\help\wizards\wizard.rc .
cdd %TEMP%\dotnet_wizard\EIFGEN\F_Code
%ISE_EIFFEL%\studio\spec\windows\bin\finish_freezing -silent
echo -----------------------------------------------------------------
echo ------- Compress generated executable file ----------------------
echo -----------------------------------------------------------------
iff not defined WIN64
	upx wizard.exe
endiff
echo -----------------------------------------------------------------
echo ------- Copying generated executable file into Delivery ---------
echo -----------------------------------------------------------------
copy wizard.exe %DELIVERY%\studio\wizards\new_projects\dotnet\spec\windows
cd %TEMP%
popd
echo -----------------------------------------------------------------
echo ------- Deleting temporary files --------------------------------
echo -----------------------------------------------------------------
echo Y > y.txt
rd /S %TEMP%\dotnet_wizard < y.txt
del y.txt
