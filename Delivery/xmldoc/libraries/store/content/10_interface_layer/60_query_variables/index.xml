<document output="studio" title="Query variables">
	<meta_data/>
	<paragraph>
		<paragraph>If you have to execute database queries which only differ in the expression values, you can create a template query and then bind variables into this template for each execution.</paragraph>
		<paragraph>This mechanism can be applied for requests with a result (<link><url>/libraries/store/reference/interface/DB_SELECTION_chart.xml</url><label>DB_SELECTION</label></link>) or without (<link><url>/libraries/store/reference/interface/DB_CHANGE_chart.xml</url><label>DB_CHANGE</label></link>). Hence both classes inherits from STRING_HDL that actually handle variable binding.</paragraph>
		<paragraph>To use variable binding:</paragraph>
		<list ordered="false">
			<item>
				<link>
					<url>#create</url>
					<label>Create</label>
				</link> a template query.
			</item>
			<item>
				<link>
					<url>#bind</url>
					<label>Bind</label>
				</link> variables to the query. 
			</item>
		</list>
		<heading>
			<size>2</size>Creating a template query
		</heading>
		<paragraph>Template queries are parsed to replace each variable by its bound value. To create a template query, you have hence to put directly variables where the values would take place.</paragraph>
		<paragraph>Variables syntax is simple: the ':' special character followed by the variable name.</paragraph>
<code_block>
	<feature_name>selection</feature_name><symbol>:</symbol> <class_name>DB_SELECTION</class_name>
	<feature_name>Bind_var</feature_name><symbol>:</symbol> <class_name>STRING</class_name> <keyword>is</keyword> <string>"firstname"</string>
	...
	<keyword>create</keyword> <feature_name>selection</feature_name>.<feature_name>make</feature_name>
	<feature_name>selection</feature_name>.<feature_name>set_query</feature_name> <symbol>(</symbol><string>"Select * from CONTACTS where Firstname = ':"</string> + <feature_name>Bind_var</feature_name> + <string>"'"</string><symbol>)</symbol>
</code_block>
		<note>
			<bold>Note</bold>: The code example shows how to bind variables to a <link><url>/libraries/store/reference/interface/DB_SELECTION_chart.xml</url><label>DB_SELECTION</label></link> object but the mechanism is exactly the same for <link><url>/libraries/store/reference/interface/DB_CHANGE_chart.xml</url><label>DB_CHANGE</label></link> objects.
		</note>
		<heading>
			<size>2</size>Binding variables to a query
		</heading>
		<paragraph>Once you have created your query, you can map variable names to values and execute the query:</paragraph>
<code_block>
	<feature_name>selection</feature_name><symbol>:</symbol> <class_name>DB_SELECTION</class_name>
	<feature_name>Bind_var</feature_name><symbol>:</symbol> <class_name>STRING</class_name> <keyword>is</keyword> <string>"firstname"</string>
	...
	<keyword>loop</keyword>
		<feature_name>io</feature_name>.<feature_name>read_line</feature_name>
		<feature_name>selection</feature_name>.<feature_name>set_map_name</feature_name> <symbol>(</symbol><feature_name>io</feature_name>.<feature_name>laststring</feature_name>, <feature_name>Bind_var</feature_name><symbol>)</symbol>
		<feature_name>selection</feature_name>.<feature_name>execute_query</feature_name>
		...
		<feature_name>selection</feature_name>.<feature_name>unset_map_name</feature_name> <symbol>(</symbol><feature_name>Bind_var</feature_name><symbol>)</symbol>
	<keyword>end</keyword>
</code_block>
		<seealso>
			<bold>See Also</bold>
			<line_break/>
			<link>
				<url>../30_database_selection/index.xml</url>
				<label>Performing a database selection.</label>
			</link>
			<line_break/>
			<link>
				<url>../20_data_modification/index.xml</url>
				<label>Modifying database content.</label>
			</link>
			<line_break/>
		</seealso>
	</paragraph></document>
