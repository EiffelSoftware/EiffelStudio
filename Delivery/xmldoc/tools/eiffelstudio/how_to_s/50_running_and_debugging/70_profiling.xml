<document title="Profiling" output="studio">
	<meta_data>
		<help>
			<meta>
				<meta_content>profiling</meta_content>
				<name>MS-HKWD</name>
			</meta>
			<meta>
				<meta_content>using the profiler</meta_content>
				<name>MS-HKWD</name>
			</meta>
		</help>
	</meta_data>
	<paragraph>
		<paragraph>The profiler is a tool that gives dynamic execution time information. It is very useful to detect which parts of a program need to be optimized most.</paragraph>
		<paragraph>To use the profiler, the first thing to do is to enable it.</paragraph>
		<paragraph>To enable the profiler:</paragraph>
		<list ordered="false">
			<item>Open the 
				<link>
					<url>/tools/eiffelstudio/reference/25_project_settings/020_target_general.xml</url>
					<label>Project Settings</label>
				</link> dialog.
			</item>
			<item>In the 
				<bold>Target</bold> section, enable
				<bold>Profile</bold>.
			</item>
			<item>Click 
				<bold>OK</bold>.
			</item>
			<item>You must 
				<link>
					<url>../40_compiling/10_generating_executables.xml</url>
					<label>recompile</label>
				</link> your project for the changes to take effect.
			</item>
		</list>
		<paragraph>By default the profiler will profile the entire program. However it is possible to enable or disable the profiler on certain clusters only. To do this:</paragraph>
		<list ordered="false">
			<item>Open the 
				<link>
					<url>../../reference/25_project_settings/040_target_groups.xml</url>
					<label>Project Settings</label>
				</link> dialog.
			</item>
			<item>In the 
				<bold>Clusters</bold> property, check the 
				<bold>Profile</bold> boolean value in the clusters where you want the profiler to be enabled.
			</item>
			<item>Click 
				<bold>Apply</bold> or 
				<bold>OK</bold>.
			</item>
			<item>You must 
				<link>
					<url>../40_compiling/10_generating_executables.xml</url>
					<label>recompile</label>
				</link> your project for the changes to take effect.
			</item>
		</list>
		<paragraph>It is also possible to dynamically start and stop the profiler in a program. To do this:</paragraph>
		<list ordered="false">
			<item>Create an object of type 
				<link>
					<url>/libraries/base/reference/profiling_setting_chart.xml</url>
					<label>PROFILING_SETTING</label>
				</link>.
			</item>
			<item>Call 
				<link>
					<url>../../../../libraries/base/reference/profiling_setting_flatshort.xml</url>
					<anchor_name>f_start_profiling</anchor_name>
					<label>start_profiling</label>
				</link> on this object to start the profiler.
			</item>
			<item>Call 
				<link>
					<url>../../../../libraries/base/reference/profiling_setting_flatshort.xml</url>
					<anchor_name>f_stop_profiling</anchor_name>
					<label>stop_profiling</label>
				</link> on this object to stop the profiler.
			</item>
		</list>
		<tip>
			<bold>Tip</bold>: To profile only part of a program, turn off the profiler at the very beginning of the program, turn it on just before the part of the code that should be profiled, and turn it back off after this section. Typically, it results in the following code:
		</tip>
		<paragraph>In the root feature:</paragraph>
		<paragraph>
			<code_block>
	<keyword>local</keyword>
		ps: <class_name>PROFILING_SETTING</class_name>
			<comment>-- Other local variables if necessary.</comment>
	<keyword>do</keyword>
		<keyword>create</keyword> ps.<feature_name>make</feature_name>
		ps.<feature_name>stop_profiling</feature_name>
			<comment>-- Real program execution.</comment>
		ps.<feature_name>start_profiling</feature_name>
	<keyword>end</keyword></code_block>
		</paragraph>
		<paragraph>And in the feature(s) that needs to be profiled:</paragraph>
		<code/>
		<paragraph>
			<code_block>
	<keyword>local</keyword>
		ps: <class_name>PROFILING_SETTING</class_name>
			<comment>-- Other local variables if necessary.</comment>
	<keyword>do</keyword>
		<keyword>create</keyword> ps.<feature_name>make</feature_name>
		ps.<feature_name>start_profiling</feature_name>
			<comment>-- What needs to be profiled.</comment>
		ps.<feature_name>stop_profiling</feature_name>
	<keyword>end</keyword></code_block>
		</paragraph>
		<note>
			<bold>Note</bold>: Even if the profiler should only work in certain sections of code, the 
			<bold>Profiling</bold> check box of the 
			<link>
				<url>../../reference/25_project_settings/020_target_general.xml</url>
				<label>Projects Settings</label>
			</link> dialog must be checked or the 
			<bold>profile</bold> option must be set on certain clusters.
		</note>
		<paragraph>Once the profiler has been enabled and the program has been recompiled, it is necessary to launch the program.</paragraph>
		<tip>
			<bold>Tip</bold>: It is possible to profile debuggable(frozen/melted) executables as well as finalized ones. It is more interesting to profile finalized executables, though, since the execution speed is more representative of what will be obtained by your end users.
		</tip>
		<paragraph>When the program exits, a file named 'profinfo' should be generated next to it.</paragraph>
		<paragraph>All that's left to do is launch the 
			<link>
				<url>/tools/eiffelstudio/reference/70_wizards_and_dialogs/10_profiler_wizard/00_introduction.xml</url>
				<label>Profiler wizard</label>
			</link> and follow the instructions.
		</paragraph>
		<seealso>
			<bold>See Also</bold>
			<line_break/>
			<link>
				<url>../40_compiling/10_generating_executables.xml</url>
				<label>Generating executables</label>
			</link>
			<line_break/>
			<link>
				<url>10_running_an_application.xml</url>
				<label>Running a program</label>
			</link>
			<line_break/>
			<link>
				<url>../40_compiling/50_tuning_a_program.xml</url>
				<label>Tuning a program</label>
			</link>
		</seealso>
	</paragraph></document>
